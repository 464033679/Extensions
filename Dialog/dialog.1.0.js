var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},DIALOG;!function(t){var e=function(e){function n(s,o,r,a,l,h,c,u){if(void 0===r&&(r=null),void 0===h&&(h=i.LAYOUT_HORIZONTAL),e.call(this,s,o,r,a,l),this._layoutDir=h,this._button=c,this._topLevel=u,this.horizontalMargin=.1,this.verticalMargin=.1,this.horizontalAlignment=i.ALIGN_LEFT,this.verticalAlignment=i.ALIGN_TOP,this.borderInsideVert=.05,this.borderDepth=t.DialogSys.DEPTH_SCALING_3D,this.stretchHorizontal=!1,this.stretchVertical=!1,this._bold=!1,this.maxViewportWidth=1,this.maxViewportHeight=1,this._fitToWindow=!1,this._maxAboveOrigin=BABYLON.Vector3.Zero(),this._minBelowOrigin=BABYLON.Vector3.Zero(),this._nStretchers=[0,0],this._xyScale=1,this._dirty=!0,this._visibleBorder=!1,this._panelEnabled=!0,this._selected=!1,this._subs=new Array,!i.BORDER_MAT){i.BORDER_MAT=t.DialogSys.GOLD[1];var d=new BABYLON.MultiMaterial("Top Level mat",t.DialogSys._scene);d.subMaterials.push(t.DialogSys.GOLD[1]);var _=t.DialogSys.BLACK[0].clone("transBlack");_.alpha=.3,d.subMaterials.push(_),i.TOP_LEVEL_BORDER_MAT=d}if(this.useGeometryForBorder()){var p=this._topLevel||this._button;this.setVerticesData(BABYLON.VertexBuffer.PositionKind,this._computePositionsData(1,1),!0),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,p?n._TOP_LEVEL_NORMALS:n._NORMALS,!1),this.setIndices(p?n._TOP_LEVEL_INDICES:n._INDICES),this.subMeshes=[],new BABYLON.SubMesh(0,0,40,0,168,this),p?(new BABYLON.SubMesh(1,40,4,168,6,this),this.material=i.TOP_LEVEL_BORDER_MAT):this.material=i.BORDER_MAT,this.setBorderVisible(this._topLevel)}this._topLevel&&e.prototype.registerBeforeRender.call(this,n._beforeRender),this.placeHolderWidth=this.getFullScalePlaceholderWidth(),this.placeHolderHeight=this.getFullScalePlaceholderHeight()}return __extends(n,e),n.prototype._computePositionsData=function(t,e){var i=this.borderInsideVert,n=t/2,s=-n,o=n-i,r=s+i,a=e/2,l=-a,h=a-i,c=l+i,u=this.borderDepth,d=[o,h,0,o,c,0,n,c,0,n,h,u,n,h,0,o,h,u,n,c,u,s,h,0,s,h,u,s,c,u,r,c,u,r,h,0,s,c,0,r,l,0,r,c,0,r,a,u,r,h,u,s,h,0,s,a,0,s,a,u,n,h,u,n,a,u,n,a,0,s,c,u,s,l,u,s,l,0,r,l,u,n,c,0,n,l,0,n,l,u,r,a,0,o,a,0,o,c,u,o,l,0,s,c,0,o,a,u,s,h,u,n,h,0,o,l,u,n,c,u];if(this._topLevel||this._button){this._button&&(u*=.1);var _=[o,c,u,o,h,u,r,h,u,r,c,u];d.push.apply(d,_)}return d},n._beforeRender=function(e){var i=e;i._dirty&&(i.layout(),t.DialogSys._adjustCameraForPanel())},n.prototype.setBorderVisible=function(t){this._visibleBorder=t,this.useGeometryForBorder&&(this.visibility=t?1:0)},n.prototype.isBorderVisible=function(){return this._visibleBorder},n.prototype.registerPickAction=function(e){this._pickFunc=e,this.actionManager=new BABYLON.ActionManager(t.DialogSys._scene);var i=this;this.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,function(){i._pickFunc()}))},n.prototype.assignCallback=function(t){this._callback=t},n.prototype.isSelected=function(){return this._selected},n.prototype.isPanelEnabled=function(){return this._panelEnabled},Object.defineProperty(n.prototype,"fitToWindow",{get:function(){return this._fitToWindow},set:function(e){this._topLevel&&(this._fitToWindow=e,this._originalReqdWidth||(this._originalReqdWidth=this.getReqdWidth(),this._originalReqdHeight=this.getReqdHeight()),e||this.layout(),t.DialogSys._adjustCameraForPanel())},enumerable:!0,configurable:!0}),n.prototype.invalidateLayout=function(){this._dirty=!0;var t=this.parent;t&&"function"==typeof t.invalidateLayout&&t.invalidateLayout()},n.prototype.layout=function(){this._calcRequiredSize(),this._layout(this.getReqdWidth(),this.getReqdHeight()),this.freezeWorldMatrix(),this._dirty=!1},n.prototype._layout=function(t,e){this._validateAlignmnent(this._layoutDir===i.LAYOUT_HORIZONTAL)&&(t=this.stretchHorizontal?t:this.getReqdWidth(),e=this.stretchVertical?e:this.getReqdHeight(),this.useGeometryForBorder()&&this.updateVerticesData(BABYLON.VertexBuffer.PositionKind,this._computePositionsData(t,e),!0),this._layoutDir===i.LAYOUT_HORIZONTAL?this._horizontalLayout(t,e):this._verticalLayout(t,e),this._actualAboveOriginX=t/2,this._actualAboveOriginY=e/2,this._actualBelowOriginX=-t/2,this._actualBelowOriginY=-e/2,this._adjustLayoutForOrigin())},n.prototype._horizontalLayout=function(t,e){for(var n,s,o=this._nStretchers[0]>0?(t-this.getReqdWidth())/this._nStretchers[0]:0,r=e-2*this.verticalMargin,a=0;a<this._subs.length;a++)n=this._subs[a],n&&null!==n&&(s=n.getReqdWidth()+(n.stretchHorizontal?o:0),n._layout(s,r),n.position.y=n.verticalAlignment===i.ALIGN_BOTTOM?this.verticalMargin-n._actualBelowOriginY:n.verticalAlignment===i.ALIGN_VCENTER?(e-n.getReqdHeight())/2-n._actualBelowOriginY:e-(this.verticalMargin+n._actualAboveOriginY));for(var l=this.horizontalMargin,a=0;a<this._subs.length;a++)if(n=this._subs[a],n&&null!==n){if(n.horizontalAlignment===i.ALIGN_RIGHT)break;if(s=n.getReqdWidth()+(n.stretchHorizontal?o:0),n.horizontalAlignment!==i.ALIGN_LEFT){n.position.x=(t-s)/2-n._actualBelowOriginX;break}n.position.x=l-n._actualBelowOriginX,l+=s}else l+=this.placeHolderWidth;for(var h=t-this.horizontalMargin,a=this._subs.length-1;a>=0;a--)if(n=this._subs[a],n&&null!==n){if(n.horizontalAlignment!==i.ALIGN_RIGHT)break;s=n.getReqdWidth()+(n.stretchHorizontal?o:0),n.position.x=h-n._actualAboveOriginX,h-=s}else h-=this.placeHolderWidth},n.prototype._verticalLayout=function(t,e){for(var n,s,o=this._nStretchers[1]>0?(e-this.getReqdHeight())/this._nStretchers[1]:0,r=t-2*this.horizontalMargin,a=0;a<this._subs.length;a++)n=this._subs[a],n&&null!==n&&(s=n.getReqdHeight()+(n.stretchVertical?o:0),n._layout(r,s),n.position.x=n.stretchHorizontal?this.horizontalMargin-n._actualBelowOriginX:n.horizontalAlignment===i.ALIGN_LEFT?this.horizontalMargin-n._actualBelowOriginX:n.horizontalAlignment===i.ALIGN_HCENTER?(t-n.getReqdWidth())/2-n._actualBelowOriginX:t-(this.horizontalMargin+n._actualAboveOriginX));for(var l=e-this.verticalMargin,a=0;a<this._subs.length;a++)if(n=this._subs[a],n&&null!==n){if(n.verticalAlignment===i.ALIGN_BOTTOM)break;if(s=n.getReqdHeight()+(n.stretchVertical?o:0),n.verticalAlignment!==i.ALIGN_TOP){n.position.y=(e-s)/2-n._actualBelowOriginY;break}n.position.y=l-n._actualAboveOriginY,l-=s}else l-=this.placeHolderHeight;for(var h=this.verticalMargin,a=this._subs.length-1;a>=0;a--)if(n=this._subs[a],n&&null!==n){if(n.verticalAlignment!==i.ALIGN_BOTTOM)break;s=n.getReqdHeight()+(n.stretchVertical?o:0),n.position.y=h-n._actualBelowOriginY,h+=s}else h+=this.placeHolderHeight},n.prototype._adjustLayoutForOrigin=function(){for(var t,e=0;e<this._subs.length;e++)t=this._subs[e],t&&null!==t&&(t.position.x+=this._actualBelowOriginX,t.position.y+=this._actualBelowOriginY)},n.prototype._validateAlignmnent=function(t){for(var e,n,s,o=t?i.ALIGN_HCENTER:i.ALIGN_VCENTER,r=this._nStretchers[t?0:1]>0,a=0,l=-4,h=0;h<this._subs.length;h++)if(this._subs[h]&&null!==this._subs[h]){if(this._subs[h]._topLevel)return BABYLON.Tools.Error("Cannot embed top level panel in others.  Found in: "+this.name),!1;if(n=this._subs[h].horizontalAlignment,n<i.ALIGN_LEFT||n>i.ALIGN_RIGHT)return BABYLON.Tools.Error("Horizontal Layout value invalid for "+this._subs[h].name),!1;if(s=this._subs[h].verticalAlignment,s<i.ALIGN_TOP||s>i.ALIGN_BOTTOM)return BABYLON.Tools.Error("Vertical Layout value invalid for "+this._subs[h].name),!1;var e=t?n:s;if(!(e>=l))return BABYLON.Tools.Error("Must be in "+(t?"Lefts, up to 1 center, rights":"tops, up to 1 center, bottoms")+" order for: "+this.name),!1;if(l=e,e===o){if(r)return BABYLON.Tools.Error("Stretch & center alignments not compatible.  found amoung sub-panels of: "+this.name),!1;a++}}return a>1?(BABYLON.Tools.Error("Multiple center alignments not valid for: "+this.name),!1):!0},n.prototype._calcRequiredSize=function(){var t,e,n,s,o,r=[0,0,0],a=[0,0,0],l=0,h=0,c=0;this._nStretchers[0]=0,this._nStretchers[1]=0;for(var u,d=0;d<this._subs.length;d++)u=this._subs[d],u&&null!==u?(u.stretchHorizontal&&this._nStretchers[0]++,u.stretchVertical&&this._nStretchers[1]++,u._calcRequiredSize(),t=u.getReqdWidth(),e=u.getReqdHeight(),n=u.getReqdDepth(),u.horizontalAlignment===i.ALIGN_LEFT&&(s=0),u.horizontalAlignment===i.ALIGN_HCENTER&&(s=1),u.horizontalAlignment===i.ALIGN_RIGHT&&(s=2),u.verticalAlignment===i.ALIGN_TOP&&(o=0),u.verticalAlignment===i.ALIGN_HCENTER&&(o=1),u.verticalAlignment===i.ALIGN_BOTTOM&&(o=2),n>l&&(l=n),this._layoutDir===i.LAYOUT_HORIZONTAL?(e>c&&(c=e),r[s]+=t):(t>h&&(h=t),a[o]+=e)):this._layoutDir===i.LAYOUT_HORIZONTAL?r[s]+=this.placeHolderWidth:a[o]+=this.placeHolderHeight;this._layoutDir===i.LAYOUT_HORIZONTAL?(h=r[1],r[1]>0&&(r[0]<r[2]?r[0]=r[2]:r[2]=r[0]),h+=r[0]+r[2]):(c=a[1],a[1]>0&&(a[0]<a[2]?a[0]=a[2]:a[2]=a[0]),c+=a[0]+a[2]),this._maxAboveOrigin.z=l/2,this._minBelowOrigin.z=-this._maxAboveOrigin.z,this._assignRequirements(h,c,l)},n.prototype.getReqdWidth=function(){return this._maxAboveOrigin.x-(this._minBelowOrigin.x<0?this._minBelowOrigin.x:0)},n.prototype.getReqdHeight=function(){return this._maxAboveOrigin.y-(this._minBelowOrigin.y<0?this._minBelowOrigin.y:0)},n.prototype._assignRequirements=function(t,e,i){this._maxAboveOrigin.x=this.horizontalMargin+t/2,this._minBelowOrigin.x=-this._maxAboveOrigin.x,this._maxAboveOrigin.y=this.verticalMargin+e/2,this._minBelowOrigin.y=-this._maxAboveOrigin.y,(!i||i<this.borderDepth)&&(i=this.borderDepth),this._maxAboveOrigin.z=i/2,this._minBelowOrigin.z=-this._maxAboveOrigin.z},n.prototype.getReqdDepth=function(){return this._maxAboveOrigin.z-(this._minBelowOrigin.z<0?this._minBelowOrigin.z:0)},n.prototype.setLayerMask=function(e){for(var i=this._subs.length-1;i>=0;i--)null!==this._subs[i]&&(this._subs[i].setLayerMask(e),this._subs[i].setEnabled(e!==t.DialogSys.SUSPENDED_DIALOG_LAYER));this.layerMask=e,this.setEnabled(e!==t.DialogSys.SUSPENDED_DIALOG_LAYER)},n.prototype.getSubPanels=function(){return this._subs},n.prototype.addSubPanel=function(t,e){void 0!==e?this._subs.splice(e,0,t):this._subs.push(t),t&&null!==t&&(t.parent=this,this.setLayerMask(this.layerMask)),this.invalidateLayout()},n.prototype.removeAt=function(t,e){!e&&this._subs[t]&&this._subs[t]&&this._subs[t].dispose(),this._subs.splice(t,1),this.invalidateLayout()},n.prototype.removeAll=function(t){if(!t)for(var e=this._subs.length-1;e>=0;e--)this._subs[e]&&this._subs[e]&&this._subs[e].dispose();this._subs=new Array,this.invalidateLayout()},n.prototype.useGeometryForBorder=function(){return!0},n.prototype.getFullScalePlaceholderWidth=function(){return.3},n.prototype.getFullScalePlaceholderHeight=function(){return.2},n.prototype.setUniformZ=function(t){for(var e,i=this._subs.length-1;i>=0;i--)e=this._subs[i],e&&null!==e&&(e.position.z=t+this._minBelowOrigin.z);this.invalidateLayout()},n.prototype.setSubsFaceSize=function(e,i){i?this._xyScale*=e:this._xyScale=e;for(var s,o=this._subs.length-1;o>=0;o--)s=this._subs[o],s&&null!==s&&(s instanceof t.Letter?s.setFaceSize(e,i):s.setSubsFaceSize(e,i));var r=this._bold?this._xyScale*n.BOLD_MULT:this._xyScale;return this.placeHolderWidth=this.getFullScalePlaceholderWidth()*r,this.placeHolderHeight=this.getFullScalePlaceholderHeight()*this._xyScale,this},n.prototype.setFaceSize=function(t,e){return e?this._xyScale*=t:this._xyScale=t,this._scaleXY(),this},n.prototype.setBold=function(t){return this._bold=t,this._scaleXY(),this},n.prototype._scaleXY=function(){var t=this._bold?this._xyScale*n.BOLD_MULT:this._xyScale;this.scaling.x=t,this.scaling.y=this._xyScale,this.invalidateLayout()},n.prototype.scaleZ=function(t){for(var e,i=this._subs.length-1;i>=0;i--)e=this._subs[i],e&&null!==e&&(e.scaling.z=t);return this},n.prototype.stretch=function(t,e){return this.stretchVertical=t,this.stretchHorizontal=e,this.invalidateLayout(),this},n.prototype.vertAlign=function(t){return this.verticalAlignment=t,this.invalidateLayout(),this},n.prototype.horizontalAlign=function(t){return this.horizontalAlignment=t,this.invalidateLayout(),this},n.prototype.margin=function(t,e){return this.verticalMargin=t,this.horizontalMargin=e,this.invalidateLayout(),this},n.prototype.dispose=function(){this.unregisterBeforeRender(n._beforeRender),e.prototype.dispose.call(this,!1)},n.prototype.freezeWorldMatrix=function(){e.prototype.freezeWorldMatrix.call(this);for(var t,i=this._subs.length-1;i>=0;i--)t=this._subs[i],t&&null!==t&&t.freezeWorldMatrix()},n.prototype.unfreezeWorldMatrix=function(){e.prototype.unfreezeWorldMatrix.call(this);for(var t,i=this._subs.length-1;i>=0;i--)t=this._subs[i],t&&null!==t&&t.unfreezeWorldMatrix()},n.BOLD_MULT=1.4,n._NORMALS=[0,0,-1,0,0,-1,.7071,0,-.7071,.7071,0,.7071,.7071,0,-.7071,0,0,1,.7071,0,.7071,-.7071,0,-.7071,-.7071,0,.7071,-.7071,0,.7071,0,0,1,0,0,-1,-.7071,0,-.7071,0,-.7071,-.7071,0,0,-1,0,.7071,.7071,0,0,1,-.7071,0,-.7071,-.5773,.5773,-.5773,-.5773,.5773,.5773,.7071,0,.7071,.5773,.5773,.5773,.5773,.5773,-.5773,-.7071,0,.7071,-.5773,-.5773,.5773,-.5773,-.5773,-.5773,0,-.7071,.7071,.7071,0,-.7071,.5773,-.5773,-.5773,.5773,-.5773,.5773,0,.7071,-.7071,0,.7071,-.7071,0,0,1,0,-.7071,-.7071,-.7071,0,-.7071,0,.7071,.7071,-.7071,0,.7071,.7071,0,-.7071,0,-.7071,.7071,.7071,0,.7071],n._TOP_LEVEL_NORMALS=[0,0,-1,0,0,-1,.7071,0,-.7071,.7071,0,.7071,.7071,0,-.7071,0,0,1,.7071,0,.7071,-.7071,0,-.7071,-.7071,0,.7071,-.7071,0,.7071,0,0,1,0,0,-1,-.7071,0,-.7071,0,-.7071,-.7071,0,0,-1,0,.7071,.7071,0,0,1,-.7071,0,-.7071,-.5773,.5773,-.5773,-.5773,.5773,.5773,.7071,0,.7071,.5773,.5773,.5773,.5773,.5773,-.5773,-.7071,0,.7071,-.5773,-.5773,.5773,-.5773,-.5773,-.5773,0,-.7071,.7071,.7071,0,-.7071,.5773,-.5773,-.5773,.5773,-.5773,.5773,0,.7071,-.7071,0,.7071,-.7071,0,0,1,0,-.7071,-.7071,-.7071,0,-.7071,0,.7071,.7071,-.7071,0,.7071,.7071,0,-.7071,0,-.7071,.7071,.7071,0,.7071,0,0,-1,0,0,-1,0,0,-1,0,0,-1],n._INDICES=[0,1,2,3,4,2,5,3,6,7,8,9,10,9,8,11,7,12,13,1,14,15,5,16,17,18,19,20,21,22,23,24,25,26,24,23,27,28,29,30,18,17,15,30,31,13,25,24,4,0,2,6,3,2,32,5,6,12,7,9,16,10,8,14,11,12,28,27,1,28,1,33,34,25,13,34,13,14,21,5,35,1,13,33,21,20,5,36,19,15,36,15,16,36,17,19,37,20,22,5,15,35,34,23,25,26,32,38,32,39,29,32,26,10,39,27,29,30,0,31,32,29,38,26,23,10,0,37,22,0,30,11,22,21,35,30,17,11,22,35,31,0,22,31,19,18,30,19,30,15,29,28,33,35,15,31,38,29,33,13,26,33,26,38,33,13,24,26],n._TOP_LEVEL_INDICES=[0,1,2,3,4,2,5,3,6,7,8,9,10,9,8,11,7,12,13,1,14,15,5,16,17,18,19,20,21,22,23,24,25,26,24,23,27,28,29,30,18,17,15,30,31,13,25,24,4,0,2,6,3,2,32,5,6,12,7,9,16,10,8,14,11,12,28,27,1,28,1,33,34,25,13,34,13,14,21,5,35,1,13,33,21,20,5,36,19,15,36,15,16,36,17,19,37,20,22,5,15,35,34,23,25,26,32,38,32,39,29,32,26,10,39,27,29,30,0,31,32,29,38,26,23,10,0,37,22,0,30,11,22,21,35,30,17,11,22,35,31,0,22,31,19,18,30,19,30,15,29,28,33,35,15,31,38,29,33,13,26,33,26,38,33,13,24,26,40,41,42,43,40,42],n}(BABYLON.Mesh);t.BasePanel=e;var i=function(e){function i(i,n,s){e.call(this,i,t.DialogSys._scene,null,null,!1,n,!1,s)}return __extends(i,e),i.makeList=function(e,n,s,o,r,a){void 0===s&&(s=i.LAYOUT_VERTICAL),void 0===o&&(o=1);var l=new i("list-"+e,i.LAYOUT_VERTICAL,a);l.setBorderVisible(!0);var h=e&&null!=e&&e.replace(" ","").length>0;if(h){var c=new t.Label(e);c.horizontalAlignment=i.ALIGN_HCENTER,r&&null!==r&&c.setLetterMaterial(r),l.addSubPanel(c)}var u=new i("listKids-"+e,s);u.setBorderVisible(h),s===i.LAYOUT_VERTICAL?u.stretchHorizontal=!0:u.stretchVertical=!0;for(var d=0;d<n.length;d++){var _=new t.Label(n[d]);_.setFontSize(o),s===i.LAYOUT_VERTICAL?_.stretchHorizontal=!0:_.stretchVertical=!0,u.addSubPanel(_)}return l.addSubPanel(u),l},i.nestPanels=function(e,n,s,o,r,a){void 0===s&&(s=i.LAYOUT_VERTICAL),void 0===o&&(o=!1);var l=new i("nest-"+e,i.LAYOUT_VERTICAL,a);if(l.setBorderVisible(o),e&&null!=e&&e.replace(" ","").length>0){var h=new t.Label(e);h.horizontalAlignment=i.ALIGN_HCENTER,r&&null!==r&&h.setLetterMaterial(r),l.addSubPanel(h)}var c=new i("nestKids-"+e,s);c.setBorderVisible(o),s===i.LAYOUT_VERTICAL?c.stretchHorizontal=!0:c.stretchVertical=!0;for(var u=0;u<n.length;u++)s===i.LAYOUT_VERTICAL?n[u].stretchHorizontal=!0:n[u].stretchVertical=!0,c.addSubPanel(n[u]);return l.addSubPanel(c),l},i.ExtractMax=function(t){for(var e=t.getVerticesData(BABYLON.VertexBuffer.PositionKind),i=new BABYLON.Vector3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),n=t.getTotalVertices(),s=0;n>s;s++){var o=new BABYLON.Vector3(e[3*s],e[3*s+1],e[3*s+2]);i=BABYLON.Vector3.Maximize(o,i)}return i},Object.defineProperty(i,"LAYOUT_HORIZONTAL",{get:function(){return i._LAYOUT_HORIZONTAL},enumerable:!0,configurable:!0}),Object.defineProperty(i,"LAYOUT_VERTICAL",{get:function(){return i._LAYOUT_VERTICAL},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_LEFT",{get:function(){return i._ALIGN_LEFT},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_HCENTER",{get:function(){return i._ALIGN_HCENTER},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_RIGHT",{get:function(){return i._ALIGN_RIGHT},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_TOP",{get:function(){return i._ALIGN_TOP},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_VCENTER",{get:function(){return i._ALIGN_VCENTER},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_BOTTOM",{get:function(){return i._ALIGN_BOTTOM},enumerable:!0,configurable:!0}),i._LAYOUT_HORIZONTAL=0,i._LAYOUT_VERTICAL=1,i._ALIGN_LEFT=-3,i._ALIGN_HCENTER=-2,i._ALIGN_RIGHT=-1,i._ALIGN_TOP=1,i._ALIGN_VCENTER=2,i._ALIGN_BOTTOM=3,i}(e);t.Panel=i}(DIALOG||(DIALOG={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},DIALOG;!function(t){var e=function(t){function e(e,i,n,s,o){void 0===n&&(n=null),t.call(this,e,i,n,s,o),this.maxAboveY=.682,this.minBelowY=-.23,this._consolidated=!1,this.horizontalMargin=0,this.verticalMargin=0,this.visibility=0}return __extends(e,t),e.prototype.useGeometryForBorder=function(){return!1},e.prototype._layout=function(){this._actualAboveOriginX||(this.visibility=1),this._actualAboveOriginX=this._maxAboveOrigin.x,this._actualAboveOriginY=this._maxAboveOrigin.y,this._actualBelowOriginX=this._minBelowOrigin.x,this._actualBelowOriginY=this._minBelowOrigin.y},e.prototype._calcRequiredSize=function(){if(!this._minWorld){var t=BABYLON.Tools.ExtractMinAndMax(this.getVerticesData(BABYLON.VertexBuffer.PositionKind),0,this.getTotalVertices());this._minWorld=t.minimum,this._maxWorld=t.maximum}this._maxAboveOrigin.x=this._maxWorld.x*(this._consolidated?1:this.scaling.x),this._maxAboveOrigin.y=this.maxAboveY*(this._consolidated?this._xyScale:this.scaling.y),this._maxAboveOrigin.z=this._maxWorld.z*this.scaling.z,this._minBelowOrigin.x=this._minWorld.x*(this._consolidated?1:this.scaling.x),this._minBelowOrigin.y=this.minBelowY*(this._consolidated?this._xyScale:this.scaling.y),this._minBelowOrigin.z=this._minWorld.z*this.scaling.z},e.prototype.addSubPanel=function(){BABYLON.Tools.Error("Letters can have no sub-panels")},e.prototype.getSubPanel=function(){return null},e.prototype.removeAt=function(){},e.prototype.removeAll=function(){},e}(t.BasePanel);t.Letter=e}(DIALOG||(DIALOG={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},DIALOG;!function(t){var e=function(e){function i(t,i){e.call(this,t.name+"_wrapper",t.getScene()),this._inside=t,this._needBorders=i,t.parent=this}return __extends(i,e),i.prototype.setMaterial=function(t){this._inside.material=t},i.prototype.useGeometryForBorder=function(){return this._needBorders},i.prototype._layout=function(){this._actualAboveOriginX||(this.visibility=1),this._actualAboveOriginX=this._maxAboveOrigin.x,this._actualAboveOriginY=this._maxAboveOrigin.y,this._actualBelowOriginX=this._minBelowOrigin.x,this._actualBelowOriginY=this._minBelowOrigin.y},i.prototype._calcRequiredSize=function(){if(!this._minWorld){var t=BABYLON.Tools.ExtractMinAndMax(this._inside.getVerticesData(BABYLON.VertexBuffer.PositionKind),0,this._inside.getTotalVertices());this._minWorld=t.minimum,this._maxWorld=t.maximum}this._maxAboveOrigin.x=this._maxWorld.x*this._inside.scaling.x,this._maxAboveOrigin.y=this._maxWorld.y*this._inside.scaling.y,this._maxAboveOrigin.z=this._maxWorld.z*this._inside.scaling.z,this._needBorders&&(this._maxAboveOrigin.x+=this.horizontalMargin,this._maxAboveOrigin.y+=this.verticalMargin),this._minBelowOrigin.x=this._minWorld.x*this._inside.scaling.x,this._minBelowOrigin.y=this._minWorld.y*this._inside.scaling.y,this._minBelowOrigin.z=this._minWorld.z*this._inside.scaling.z,this._needBorders&&(this._minBelowOrigin.x-=this.horizontalMargin,this._minBelowOrigin.y-=this.verticalMargin)},i.prototype.setLayerMask=function(e){for(var i=this._inside.getChildren(),n=i.length-1;n>=0;n--)i[n].layerMask=e,i[n].setEnabled(e!==t.DialogSys.SUSPENDED_DIALOG_LAYER);this._inside.layerMask=e,this._inside.setEnabled(e!==t.DialogSys.SUSPENDED_DIALOG_LAYER),this.layerMask=e,this.setEnabled(e!==t.DialogSys.SUSPENDED_DIALOG_LAYER)},i.prototype.addSubPanel=function(){BABYLON.Tools.Error("wrappers can have no sub-panels")},i.prototype.getSubPanel=function(){return null},i.prototype.removeAt=function(){},i.prototype.removeAll=function(){},i.prototype.setSubsFaceSize=function(t,e){return e?this._xyScale*=t:this._xyScale=t,this._inside.scaling.x=this._xyScale,this._inside.scaling.y=this._xyScale,this.invalidateLayout(),this},i}(t.BasePanel);t.MeshWrapperPanel=e}(DIALOG||(DIALOG={}));var DIALOG;!function(t){var e=function(){function e(){}return e.initialize=function(i){if(e._scene=i,!e._camera){e._camera=new BABYLON.FreeCamera("DialogSysCamera",new BABYLON.Vector3(0,0,-2e3),i),e._camera.mode=BABYLON.Camera.ORTHOGRAPHIC_CAMERA,e._camera.layerMask=e.ACTIVE_DIALOG_LAYER,i.removeCamera(e._camera);var n=new BABYLON.Vector3(-20,50,-100);e._light=new BABYLON.PointLight("DialogSysLamp",n,i),e._light.intensity=1,e._light.includeOnlyWithLayerMask=e.ACTIVE_DIALOG_LAYER,window.addEventListener("resize",function(){t.DialogSys._adjustCameraForPanel()}),BABYLON.Tools.Log("Dialog system ("+e.Version+") initialized")}e.WHITE=e.buildFontMaterials("DialogSys.WHITE",new BABYLON.Color3(1,1,1)),e.BLACK=e.buildFontMaterials("DialogSys.BLACK",new BABYLON.Color3(0,0,0)),e.BLUE=e.buildFontMaterials("DialogSys.BLUE",new BABYLON.Color3(.0815,.162,.8),.8),e.GOLD=e.buildFontMaterials("DialogSys.GOLD",new BABYLON.Color3(1,.8136,.2218)),e.RED=e.buildFontMaterials("DialogSys.RED",new BABYLON.Color3(1,.0046,.0286)),e.GREY=e.buildFontMaterials("DialogSys.GREY",new BABYLON.Color3(.5,.5,.5)),e.LT_GREY=e.buildFontMaterials("DialogSys.LT_GREY",new BABYLON.Color3(.6,.6,.6)),e.ORANGE=e.buildFontMaterials("DialogSys.ORANGE",new BABYLON.Color3(1,.5,0)),e.GREEN=e.buildFontMaterials("DialogSys.GREEN",new BABYLON.Color3(.004,.319,.002)),t.FontFactory.loadStockTypefaces(i),e.CURRENT_FONT_MAT_ARRAY=e.WHITE;for(var s=i.lights.length-1;s>=0;s--)i.lights[s]!==e._light&&(i.lights[s].excludeWithLayerMask=e.ACTIVE_DIALOG_LAYER);i.onNewLightAdded=e.onNewLight},e.onNewLight=function(t,i,n){n===e._scene&&(t.excludeWithLayerMask=e.ACTIVE_DIALOG_LAYER)},e.dispose=function(){e._camera.dispose(),e._light.dispose(),e.WHITE[0].dispose(),e.WHITE[1].dispose(),e.BLACK[0].dispose(),e.BLACK[1].dispose(),e.BLUE[0].dispose(),e.BLUE[1].dispose(),e.GOLD[0].dispose(),e.GOLD[1].dispose(),e.RED[0].dispose(),e.RED[1].dispose(),e.GREY[0].dispose(),e.GREY[1].dispose(),e.LT_GREY[0].dispose(),e.LT_GREY[1].dispose(),e.ORANGE[0].dispose(),e.ORANGE[1].dispose(),e.GREEN[0].dispose(),e.GREEN[1].dispose(),e._scene.onNewLightAdded=null,e._scene=null},e.buildFontMaterials=function(t,i,n,s){void 0===n&&(n=1),void 0===s&&(s=1);var o=new Array(2),r=new BABYLON.StandardMaterial(t+"-3D",e._scene);return r.ambientColor=i,r.diffuseColor=1===n?i:new BABYLON.Color3(i.r*n,i.g*n,i.b*n),r.specularColor=new BABYLON.Color3(.5,.5,.5),r.specularPower=80,r.alpha=s,o[0]=r,r=r.clone(t+"-2D"),r.backFaceCulling=!1,o[1]=r,o},e.pushPanel=function(t){t._topLevel||BABYLON.Tools.Error("Only top Level panels can be used in displayPanel()"),0===t.getReqdWidth()&&t.layout(),e._dialogStack.length>0?e._dialogStack[e._dialogStack.length-1].setLayerMask(e.SUSPENDED_DIALOG_LAYER):(e._scene.addCamera(e._camera),0===e._scene.activeCameras.length&&e._scene.activeCameras.push(e._scene.activeCamera),e._scene.activeCameras.push(e._camera)),e._scene.activeCameras[0].layerMask=e.DEFAULT_LAYERMASK,e._dialogStack.push(t),e._adjustCameraForPanel(),t.setLayerMask(e.ACTIVE_DIALOG_LAYER)},e.popPanel=function(t){var i=e._dialogStack.pop(),n=i.modalReturnedValue;if(t?i.setLayerMask(e.DEFAULT_LAYERMASK):i.dispose(),e._dialogStack.length>0){var s=e._dialogStack[e._dialogStack.length-1];s.setLayerMask(e.ACTIVE_DIALOG_LAYER),e._adjustCameraForPanel(),s.modalReturnedValue=n,s.modalReturnCallBack&&s.modalReturnCallBack()}else e._scene.activeCameras.pop(),e._scene.removeCamera(e._camera);return n},e._adjustCameraForPanel=function(){if(e._dialogStack&&0!==e._dialogStack.length){var i=e._dialogStack[e._dialogStack.length-1];if(i.fitToWindow){var n=e._getScalingToWindow(i._originalReqdWidth,i._originalReqdHeight),s=i._originalReqdWidth*(n.y<n.x?n.x/n.y:1),o=i._originalReqdHeight*(n.y>n.x?n.y/n.x:1);i._assignRequirements(s,o),i._layout(i.getReqdWidth(),i.getReqdHeight()),i.freezeWorldMatrix()}var r=i.getReqdWidth()/2,a=i.getReqdHeight()/2;e._camera.orthoTop=a,e._camera.orthoBottom=-a,e._camera.orthoLeft=-r,e._camera.orthoRight=r,e._camera.getProjectionMatrix();var l,n=e._getScalingToWindow(r,a),s=window.innerWidth*(n.y<n.x?n.y/n.x:1),o=window.innerHeight*(n.y>n.x?n.x/n.y:1),h=i.maxViewportWidth*s/window.innerWidth,c=i.maxViewportHeight*o/window.innerHeight;switch(i.fitToWindow?t.Panel.ALIGN_HCENTER:i.horizontalAlignment){case t.Panel.ALIGN_LEFT:l=0;break;case t.Panel.ALIGN_HCENTER:l=(1-h)/2;break;case t.Panel.ALIGN_RIGHT:l=1-h}var u;switch(i.fitToWindow?t.Panel.ALIGN_VCENTER:i.verticalAlignment){case t.Panel.ALIGN_TOP:u=1-c;break;case t.Panel.ALIGN_VCENTER:u=(1-c)/2;break;case t.Panel.ALIGN_BOTTOM:u=0}e._camera.viewport=new BABYLON.Viewport(l,u,h,c)}},e._getScalingToWindow=function(t,e){return new BABYLON.Vector2(window.innerWidth/t,window.innerHeight/e)},Object.defineProperty(e,"Version",{get:function(){return"1.0.0"},enumerable:!0,configurable:!0}),e.ACTIVE_DIALOG_LAYER=268435456,e.SUSPENDED_DIALOG_LAYER=0,e.DEFAULT_LAYERMASK=268435455,e._dialogStack=new Array,e.USE_CULLING_MAT_FOR_2D=!0,e.DEPTH_SCALING_3D=.05,e}();t.DialogSys=e}(DIALOG||(DIALOG={}));var DIALOG;!function(t){var e=function(){function e(){}return e.loadStockTypefaces=function(e){"undefined"!=typeof Font3D&&(TOWER_OF_BABEL.MeshFactory.MODULES.push(new Font3D.MeshFactory(e)),t.Label.DEFAULT_FONT_MODULE="Font3D",BABYLON.Tools.Log("Font3D loaded")),"undefined"!=typeof Font2D&&(TOWER_OF_BABEL.MeshFactory.MODULES.push(new Font2D.MeshFactory(e)),t.Label.DEFAULT_FONT_MODULE="Font2D",BABYLON.Tools.Log("Font2D loaded")),"undefined"!=typeof Font3D_EXT&&(TOWER_OF_BABEL.MeshFactory.MODULES.push(new Font3D_EXT.MeshFactory(e)),BABYLON.Tools.Log("Font3D_EXT loaded")),"undefined"!=typeof Font2D_EXT&&(TOWER_OF_BABEL.MeshFactory.MODULES.push(new Font2D_EXT.MeshFactory(e)),BABYLON.Tools.Log("Font2D_EXT loaded"))},e.getLetters=function(e,i,n){for(var s,o=new Array(e.length),r=i.indexOf("3D")>-1,a=e.length-1;a>=0;a--){s=i+(e[a].charCodeAt(0)>128?"_EXT":"");var l=" "!==e[a]?TOWER_OF_BABEL.MeshFactory.instance(s,e[a]):null;l?null!==l&&(l.material=n?n:t.DialogSys.CURRENT_FONT_MAT_ARRAY[r||t.DialogSys.USE_CULLING_MAT_FOR_2D?0:1],r&&(l.scaling.z=t.DialogSys.DEPTH_SCALING_3D)):l=null,o[a]=l}return o},e}();t.FontFactory=e}(DIALOG||(DIALOG={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},DIALOG;!function(t){var e=function(e){function i(n,s,o,r,a){void 0===s&&(s=i.DEFAULT_FONT_MODULE),e.call(this,n,t.DialogSys._scene,null,null,!1,t.Panel.LAYOUT_HORIZONTAL,r),this._prohibitMerging=a,this._merged=!1,this._isTypeface3D=s.indexOf("3D")>-1;for(var l=t.FontFactory.getLetters(n,s,o),h=0;h<l.length;h++)this.addSubPanel(l[h]);this.setUniformZ(0),r||(this.material=t.DialogSys.ORANGE[1],this.verticalMargin=.02)}return __extends(i,e),i.prototype.setFontSize=function(t,e){return this.setSubsFaceSize(t,e)},i.prototype.setLetterMaterial=function(e,i){var n,s=e[this._isTypeface3D||t.DialogSys.USE_CULLING_MAT_FOR_2D?0:1],o=this.getSubPanels(),r=-1;i&&(r=this.name.indexOf(i),n=r+i.length-1),-1===r&&(r=0,n=o.length-1);for(var a=r;n>=a;a++)null!==o[a]&&(o[a].material=s);return this},i.prototype.getFullScalePlaceholderWidth=function(){return.15},i.prototype.addSubPanel=function(i,n){return!i||i instanceof t.Letter?(e.prototype.addSubPanel.call(this,i,n),void 0):(BABYLON.Tools.Error("Labels can contain only letters"),void 0)},i.prototype._calcRequiredSize=function(){e.prototype._calcRequiredSize.call(this),!i.NO_MERGING&&!this._prohibitMerging&&this.getSubPanels().length>1&&!this._merged&&(this._mergeMeshes(),e.prototype._calcRequiredSize.call(this))},i.prototype._mergeMeshes=function(){for(var e,i,n,s,o,r=this.getSubPanels(),a=r.length,l=0,h=0,c=0,u=new Array,d=t.DialogSys._scene.getEngine().getCaps().uintIndices?1e6:65536,_=0;a>_;_++)e=r[_],e&&null!==e?(e.parent=null,n=e.getReqdWidth(),l+=e.getTotalVertices(),s&&(e.material!==i||l>d?(u.push(this._bigLetter(i,s)),s=void 0,l=0,h=0):(o=this._extractVertexData(e,h+c*this.placeHolderWidth),s.merge(o))),s||(i=e.material,s=this._extractVertexData(e,c*this.placeHolderWidth)),h+=n+c*this.placeHolderWidth,c=0):c++;u.push(this._bigLetter(i,s)),this.removeAll();for(var p=0;p<u.length;p++)this.addSubPanel(u[p]);this._merged=!0},i.prototype._extractVertexData=function(t,e){var i=BABYLON.VertexData.ExtractFromMesh(t,!0);return t.position.x=e,t.computeWorldMatrix(!0),i.transform(t.worldMatrixFromCache),t.dispose(),i},i.prototype._bigLetter=function(e,i){var n=new t.Letter(this.name+"-merged",t.DialogSys._scene);return i.applyToMesh(n),n.material=e,n._xyScale=this._xyScale,n._consolidated=!0,n._calcRequiredSize(),n},i.NO_MERGING=!1,i}(t.BasePanel);t.Label=e}(DIALOG||(DIALOG={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},DIALOG;!function(t){var e=function(e){function i(n,s,o){void 0===s&&(s=t.Label.DEFAULT_FONT_MODULE),e.call(this,n,s,null,!0,o),i.factory||(i.factory=new CheckBoxFont.MeshFactory(t.DialogSys._scene));var r=this;this.registerPickAction(function(){r._panelEnabled&&r.setSelected(!this._selected)})}return __extends(i,e),i.prototype._assignCheckMesh=function(){var e,n=this.getSubPanels();null!==n[0]&&(e=n[0].position,n[0].dispose()),this._isTypeface3D?(n[0]=i.factory.instance(this._selected?"checked3D":"unchecked3D"),n[0].scaling.z=t.DialogSys.DEPTH_SCALING_3D):n[0]=i.factory.instance(this._selected?"checked2D":"unchecked2D");for(var s=n.length-1;null===n[s];)s--;n[0].material=n[s].material,n[0].scaling.x=n[s]._xyScale,n[0].scaling.y=n[s]._xyScale,n[0].layerMask=n[s].layerMask,n[0].parent=this,n[0]._calcRequiredSize(),n[0].visibility=1,e&&(n[0].position=e)},i.prototype.setSelected=function(t){this._selected=t,this._assignCheckMesh(),this._callback&&this._callback(this)},i.prototype.enableButton=function(e){this._panelEnabled=e,this.setLetterMaterial(e?t.DialogSys.CURRENT_FONT_MAT_ARRAY:t.DialogSys.LT_GREY)},i.prototype._calcRequiredSize=function(){e.prototype._calcRequiredSize.call(this);var t=this.getSubPanels();t[0]instanceof CheckBoxFont.unchecked2D||t[0]instanceof CheckBoxFont.checked2D||t[0]instanceof CheckBoxFont.unchecked3D||t[0]instanceof CheckBoxFont.checked3D||(this.addSubPanel(null,0),this.addSubPanel(null,0),this._assignCheckMesh(),e.prototype._calcRequiredSize.call(this))},i}(t.Label);t.CheckBox=e}(DIALOG||(DIALOG={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t
}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},CheckBoxFont;!function(t){function e(t,e){var i=o[t];if(!i||null===i)return i||(o[t]=new Array),null;for(var n=i.length-1;n>=0;n--)if(i[n].geometry||e)return i[n];return null}function i(t){var e=o[t];if(e&&null!==e){for(var i=!1,n=e.length-1;n>=0;n--)e[n].geometry?i=!0:e[n]=null;i||(o[t]=null)}}function n(){return[r,a,l]}function s(t,e){if(void 0===e&&(e="./"),!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";if(!c){e.lastIndexOf("/")+1!==e.length&&(e+="/");c=!0}}var o=new Array(4),r=1,a=0,l=0,h=function(){function i(e,i){void 0===i&&(i="./"),this._scene=e,t.defineMaterials(e,i)}return i.prototype.getModuleName=function(){return"CheckBoxFont"},i.prototype.instance=function(t,i){var n,s=null;switch(t){case"unchecked2D":n=e(0),null===n?(s=new u("unchecked2D",this._scene),a+=s.getTotalVertices(),o[0].push(s)):(s=new u("unchecked2D_"+r++,this._scene,null,n),l+=s.getTotalVertices());break;case"checked2D":n=e(1),null===n?(s=new d("checked2D",this._scene),a+=s.getTotalVertices(),o[1].push(s)):(s=new d("checked2D_"+r++,this._scene,null,n),l+=s.getTotalVertices());break;case"checked3D":n=e(2),null===n?(s=new _("checked3D",this._scene),a+=s.getTotalVertices(),o[2].push(s)):(s=new _("checked3D_"+r++,this._scene,null,n),l+=s.getTotalVertices());break;case"unchecked3D":n=e(3),null===n?(s=new p("unchecked3D",this._scene),a+=s.getTotalVertices(),o[3].push(s)):(s=new p("unchecked3D_"+r++,this._scene,null,n),l+=s.getTotalVertices())}if(null!==s){if(i&&n&&n.skeleton){var h=n.skeleton.name+r;s.skeleton=n.skeleton.clone(h,h)}}else BABYLON.Tools.Error("Mesh not found: "+t);return s},i}();t.MeshFactory=h,t.getStats=n;var c=!1;t.defineMaterials=s;var u=function(e){function n(i,n,s,o){void 0===s&&(s="./"),e.call(this,i,n,null,o,!0),t.defineMaterials(n,s);var r=o&&null!==o;this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=1,this.scaling.z=1,this.isVisible=!0,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1,r||(this.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.6,0,0,-.05,0,0,-.05,.05,0,-.6,0,0,-.6,.65,0,-.65,.65,0,-.6,.6,0,-.05,.6,0,-.05,.65,0,0,0,0,0,.65,0,-.05,.65,0,-.6,.05,0,-.65,0,0,-.6,.65,0,-.05,0,0],!1),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),this.setIndices([0,1,2,3,4,5,6,7,8,9,10,11,12,0,2,13,3,5,14,6,8,15,9,11]),this.subMeshes=[],new BABYLON.SubMesh(0,0,16,0,24,this),this.computeWorldMatrix(!0))}return __extends(n,e),n.prototype.dispose=function(t){e.prototype.dispose.call(this,t),i(0)},n}(DIALOG.Letter);t.unchecked2D=u;var d=function(e){function n(i,n,s,o){void 0===s&&(s="./"),e.call(this,i,n,null,o,!0),t.defineMaterials(n,s);var r=o&&null!==o;this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=1,this.scaling.z=1,this.isVisible=!0,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1,r||(this.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.1305,.1659,0,-.4841,.5195,0,-.5195,.4841,0,-.4841,.1305,0,-.1305,.4841,0,-.1659,.5195,0,-.6,0,0,-.05,0,0,-.05,.05,0,-.6,0,0,-.6,.65,0,-.65,.65,0,-.6,.6,0,-.05,.6,0,-.05,.65,0,0,0,0,0,.65,0,-.05,.65,0,-.1659,.1305,0,-.5195,.1659,0,-.6,.05,0,-.65,0,0,-.6,.65,0,-.05,0,0],!1),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),this.setIndices([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,0,2,19,3,5,20,6,8,21,9,11,22,12,14,23,15,17]),this.subMeshes=[],new BABYLON.SubMesh(0,0,24,0,36,this),this.computeWorldMatrix(!0))}return __extends(n,e),n.prototype.dispose=function(t){e.prototype.dispose.call(this,t),i(1)},n}(DIALOG.Letter);t.checked2D=d;var _=function(e){function n(i,n,s,o){void 0===s&&(s="./"),e.call(this,i,n,null,o,!0),t.defineMaterials(n,s);var r=o&&null!==o;this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=1,this.scaling.z=1,this.isVisible=!0,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1,r||(this.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.1305,.1659,0,-.4841,.5195,0,-.5195,.4841,0,-.1659,.1305,0,-.1659,.1305,1,-.4841,.5195,1,-.5195,.4841,1,-.4841,.1305,0,-.1305,.4841,0,-.1659,.5195,0,-.5195,.1659,0,-.5195,.1659,1,-.4841,.1305,1,-.1305,.4841,1,-.1659,.5195,1,-.6,0,0,-.05,0,0,-.05,.05,0,-.6,.05,0,-.6,.05,1,-.6,0,1,-.05,0,1,-.05,.05,1,-.6,0,0,-.6,.65,0,-.65,.65,0,-.6,0,1,-.65,0,0,-.6,.65,1,-.65,.65,1,-.6,.6,0,-.05,.6,0,-.05,.65,0,-.6,.6,1,-.6,.65,0,-.05,.65,1,0,0,0,0,.65,0,-.05,.65,0,0,0,1,-.05,0,0,0,.65,1,-.05,.65,1,-.1305,.1659,1,-.65,0,1,-.6,.65,1,-.05,.6,1,-.05,0,1],!1),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,[.8165,0,-.5773,0,.8165,-.5773,-.8165,0,-.5773,0,-.8165,-.5773,0,-1,0,0,1,0,-1,0,0,0,-.8165,-.5773,.8165,0,-.5773,0,.8165,-.5773,-.8165,0,-.5773,-1,0,0,0,-1,0,1,0,0,0,1,0,-.5773,-.5773,-.5773,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,-.7071,.7071,0,-.7071,-.7071,0,.7071,-.7071,0,.7071,.7071,0,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,.7071,-.7071,0,-.5773,-.5773,-.5773,.7071,.7071,0,-.7071,.7071,0,-.5773,-.5773,-.5773,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.7071,-.7071,0,-.5773,.5773,-.5773,.7071,.7071,0,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,.7071,-.7071,0,-.5773,-.5773,-.5773,.7071,.7071,0,-.7071,.7071,0,1,0,0,-.7071,-.7071,0,-.7071,.7071,0,.7071,-.7071,0,-.7071,-.7071,0],!1),this.setIndices([0,1,2,0,3,4,5,1,0,2,1,5,3,2,6,7,8,9,7,10,11,8,7,12,9,8,13,10,9,14,15,16,17,15,18,19,16,15,20,17,16,21,18,17,22,23,24,25,26,23,27,28,24,23,29,25,24,27,25,29,30,31,32,33,30,34,31,30,33,35,32,31,34,32,35,36,37,38,39,36,40,41,37,36,42,38,37,40,38,42,3,0,2,43,0,4,43,5,0,6,2,5,4,3,6,10,7,9,12,7,11,13,8,12,14,9,13,11,10,14,18,15,17,20,15,19,21,16,20,22,17,21,19,18,22,27,23,25,44,26,27,26,28,23,28,29,24,44,27,29,34,30,32,45,33,34,46,31,33,46,35,31,45,34,35,40,36,38,47,39,40,39,41,36,41,42,37,47,40,42]),this.subMeshes=[],new BABYLON.SubMesh(0,0,48,0,180,this),this.computeWorldMatrix(!0))}return __extends(n,e),n.prototype.dispose=function(t){e.prototype.dispose.call(this,t),i(2)},n}(DIALOG.Letter);t.checked3D=_;var p=function(e){function n(i,n,s,o){void 0===s&&(s="./"),e.call(this,i,n,null,o,!0),t.defineMaterials(n,s);var r=o&&null!==o;this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=1,this.scaling.z=1,this.isVisible=!0,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1,r||(this.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.6,0,0,-.05,0,0,-.05,.05,0,-.6,.05,0,-.6,.05,1,-.6,0,1,-.05,0,1,-.05,.05,1,-.6,0,0,-.6,.65,0,-.65,.65,0,-.6,0,1,-.65,0,0,-.6,.65,1,-.65,.65,1,-.6,.6,0,-.05,.6,0,-.05,.65,0,-.6,.6,1,-.6,.65,0,-.05,.65,1,0,0,0,0,.65,0,-.05,.65,0,0,0,1,-.05,0,0,0,.65,1,-.05,.65,1,-.65,0,1,-.6,.65,1,-.05,.6,1,-.05,0,1],!1),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,[-.5773,-.5773,-.5773,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,-.7071,.7071,0,-.7071,-.7071,0,.7071,-.7071,0,.7071,.7071,0,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,.7071,-.7071,0,-.5773,-.5773,-.5773,.7071,.7071,0,-.7071,.7071,0,-.5773,-.5773,-.5773,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.7071,-.7071,0,-.5773,.5773,-.5773,.7071,.7071,0,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,.7071,-.7071,0,-.5773,-.5773,-.5773,.7071,.7071,0,-.7071,.7071,0,-.7071,-.7071,0,-.7071,.7071,0,.7071,-.7071,0,-.7071,-.7071,0],!1),this.setIndices([0,1,2,0,3,4,1,0,5,2,1,6,3,2,7,8,9,10,11,8,12,13,9,8,14,10,9,12,10,14,15,16,17,18,15,19,16,15,18,20,17,16,19,17,20,21,22,23,24,21,25,26,22,21,27,23,22,25,23,27,3,0,2,5,0,4,6,1,5,7,2,6,4,3,7,12,8,10,28,11,12,11,13,8,13,14,9,28,12,14,19,15,17,29,18,19,30,16,18,30,20,16,29,19,20,25,21,23,31,24,25,24,26,21,26,27,22,31,25,27]),this.subMeshes=[],new BABYLON.SubMesh(0,0,32,0,120,this),this.computeWorldMatrix(!0))}return __extends(n,e),n.prototype.dispose=function(t){e.prototype.dispose.call(this,t),i(3)},n}(DIALOG.Letter);t.unchecked3D=p}(CheckBoxFont||(CheckBoxFont={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},DIALOG;!function(t){var e=function(e){function i(n,s,o){if(void 0===s&&(s=i.ACTION_BUTTON),e.call(this,n,o,null,!0),this._button_type=s,this._chngInProgress=!1,!i.MAT){var r=new BABYLON.MultiMaterial("button",t.DialogSys._scene);r.subMaterials.push(t.DialogSys.GREY[1]),r.subMaterials.push(t.DialogSys.GREY[0]),i.MAT=r,r=new BABYLON.MultiMaterial("button selected",t.DialogSys._scene),r.subMaterials.push(t.DialogSys.ORANGE[1]),r.subMaterials.push(t.DialogSys.GREY[0]),i.SELECTED_MAT=r}this.setBorderVisible(!0),this.borderInsideVert*=1.5,this.horizontalMargin*=1.5,this.verticalMargin*=1.5,this.setFontSize(.65),this.setSelected(!1),this.enableButton(!0);var a=this;this.registerPickAction(function(){a._panelEnabled&&a.setSelected(!0)}),this._button_type===i.ACTION_BUTTON&&e.prototype.registerAfterRender.call(this,i._delayedStart)}return __extends(i,e),i._delayedStart=function(t){var e=t;e._chngInProgress?(e._chngInProgress=!1,e.setSelected(!1),e._callback&&e._callback(e)):e.material!==i.MAT&&(e._chngInProgress=!0)},i.prototype.setSelected=function(t,e){this._selected=t,this.material=t?i.SELECTED_MAT:i.MAT,e||this._group&&this._group.reportSelected(this)},i.prototype.enableButton=function(e){this._panelEnabled=e,this.setLetterMaterial(e?t.DialogSys.BLACK:t.DialogSys.LT_GREY)},Object.defineProperty(i.prototype,"radioGroup",{set:function(t){this._button_type===i.RADIO_BUTTON?this._group=t:BABYLON.Tools.Error("Button not radio type")},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){e.prototype.dispose.call(this,!1),this.unregisterAfterRender(i._delayedStart)},Object.defineProperty(i,"ACTION_BUTTON",{get:function(){return i._ACTION_BUTTON},enumerable:!0,configurable:!0}),Object.defineProperty(i,"RADIO_BUTTON",{get:function(){return i._RADIO_BUTTON},enumerable:!0,configurable:!0}),i._ACTION_BUTTON=0,i._RADIO_BUTTON=2,i}(t.Label);t.Button=e}(DIALOG||(DIALOG={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},DIALOG;!function(t){var e=function(e){function i(i,n,s,o){if(void 0===s&&(s=t.Panel.LAYOUT_VERTICAL),e.call(this,i,t.DialogSys._scene,null,null,!1,t.Panel.LAYOUT_VERTICAL,o),this._callbacks=new Array,this.setBorderVisible(!0),i&&null!=i&&i.replace(" ","").length>0){var r=new t.Label(i);r.horizontalAlignment=t.Panel.ALIGN_HCENTER,e.prototype.addSubPanel.call(this,r)}this._menu=new t.BasePanel("menu-"+i,t.DialogSys._scene,null,null,!1,s);for(var a=0;a<n.length;a++){var l=new t.Button(n[a],t.Button.RADIO_BUTTON);l.stretchHorizontal=s===t.Panel.LAYOUT_VERTICAL,l.radioGroup=this,this._menu.addSubPanel(l)}e.prototype.addSubPanel.call(this,this._menu)}return __extends(i,e),i.prototype.assignMenuCallback=function(t,e){this._callbacks[t]=e},i.prototype.reportSelected=function(t){for(var e=this._menu.getSubPanels(),i=0;i<e.length;i++){var n=e[i];n!=t?n.setSelected(!1,!0):(this._selectedIndex=i,this._callbacks[i]&&null!==this._callbacks[i]&&this._callbacks[i](n))}},Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(t){this._menu.getSubPanels()[t].setSelected(!0)},enumerable:!0,configurable:!0}),i.prototype.addSubPanel=function(e,i){return!e||e instanceof t.Button?(this._menu.addSubPanel(e,i),i?this._callbacks.splice(i,0,null):this._callbacks.push(null),void 0):(BABYLON.Tools.Error("Labels can contain only Buttons"),void 0)},i.prototype.removeAt=function(t){e.prototype.removeAt.call(this,t),this._callbacks.splice(t,1)},i.prototype.removeAll=function(){e.prototype.removeAll.call(this),this._callbacks=new Array},i}(t.BasePanel);t.Menu=e}(DIALOG||(DIALOG={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},DigitParts;!function(t){function e(t,e){var i=p[t];if(!i||null===i)return i||(p[t]=new Array),null;for(var n=i.length-1;n>=0;n--)if(i[n].geometry||e)return i[n];return null}function i(t){var e=p[t];if(e&&null!==e){for(var i=!1,n=e.length-1;n>=0;n--)e[n].geometry?i=!0:e[n]=null;i||(p[t]=null)}}function n(){return[g,f,B]}function s(t,e){if(void 0===e&&(e="./"),!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";if(!L){e.lastIndexOf("/")+1!==e.length&&(e+="/");var i;i=new BABYLON.StandardMaterial("DigitParts.border",t),i.ambientColor=new BABYLON.Color3(.0574,.8,.0876),i.diffuseColor=new BABYLON.Color3(.0459,.64,.0701),i.specularColor=new BABYLON.Color3(.5,.5,.5),i.emissiveColor=new BABYLON.Color3(0,0,0),i.specularPower=50,i.alpha=1,i.backFaceCulling=!0,i=new BABYLON.StandardMaterial("DigitParts.border.001",t),i.ambientColor=new BABYLON.Color3(.0574,.8,.0876),i.diffuseColor=new BABYLON.Color3(.0459,.64,.0701),i.specularColor=new BABYLON.Color3(.5,.5,.5),i.emissiveColor=new BABYLON.Color3(0,0,0),i.specularPower=50,i.alpha=1,i.backFaceCulling=!0,i=new BABYLON.StandardMaterial("DigitParts.face",t),i.ambientColor=new BABYLON.Color3(.8,.1603,.7314),i.diffuseColor=new BABYLON.Color3(.64,.1283,.5851),i.specularColor=new BABYLON.Color3(.5,.5,.5),i.emissiveColor=new BABYLON.Color3(0,0,0),i.specularPower=50,i.alpha=1,i.backFaceCulling=!0,i=new BABYLON.StandardMaterial("DigitParts.face.001",t),i.ambientColor=new BABYLON.Color3(.8,.1603,.7314),i.diffuseColor=new BABYLON.Color3(.64,.1283,.5851),i.specularColor=new BABYLON.Color3(.5,.5,.5),i.emissiveColor=new BABYLON.Color3(0,0,0),i.specularPower=50,i.alpha=1,i.backFaceCulling=!0,o(t),L=!0}}function o(t){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var e;e=new BABYLON.MultiMaterial("DigitParts.Multimaterial#0",t),e.id="DigitParts.Multimaterial#0",e.subMaterials.push(t.getMaterialByID("DigitParts.border")),e.subMaterials.push(t.getMaterialByID("DigitParts.face")),e=new BABYLON.MultiMaterial("DigitParts.Multimaterial#1",t),e.id="DigitParts.Multimaterial#1",e.subMaterials.push(t.getMaterialByID("DigitParts.border.001")),e.subMaterials.push(t.getMaterialByID("DigitParts.face.001"))}function r(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var n=new BABYLON.Mesh(e.name+".botLeft",t,e,i),s=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=0,n.position.y=0,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,s||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[.12,.12,0,.12,.46,0,0,.46,0,0,.12,0,0,0,0,.12,.12,0,0,.5196,0,0,.46,0,.1198,.46,0,0,.12,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,n),n.computeWorldMatrix(!0)),n}function a(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var n=new BABYLON.Mesh(e.name+".topLeft",t,e,i),s=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=0,n.position.y=.5396,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,s||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[0,.0596,0,.12,.0596,0,.12,.3996,0,0,.3996,0,.12,.3996,0,0,.5196,0,0,0,0,.1198,.0596,0,0,.0596,0,0,.3996,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,n),n.computeWorldMatrix(!0)),n}function l(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var n=new BABYLON.Mesh(e.name+".top",t,e,i),s=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=.03,n.position.y=1.0579,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,s||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[.42,0,0,.12,0,0,.12,-.12,0,.42,0,0,.42,-.12,0,.54,0,0,.12,0,0,0,0,0,.12,-.12,0,.42,-.12,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,n),n.computeWorldMatrix(!0)),n}function h(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var n=new BABYLON.Mesh(e.name+".topRite",t,e,i),s=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=.6,n.position.y=.5396,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,s||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.12,.3996,0,-.12,.0596,0,0,.0596,0,0,.3996,0,0,.5196,0,-.12,.3996,0,0,0,0,0,.0596,0,-.1198,.0596,0,0,.3996,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,n),n.computeWorldMatrix(!0)),n}function c(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var n=new BABYLON.Mesh(e.name+".botRite",t,e,i),s=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=.6,n.position.y=.5196,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,s||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[0,-.0596,0,-.12,-.0596,0,-.12,-.3996,0,0,-.3996,0,-.12,-.3996,0,0,-.5196,0,0,0,0,-.1198,-.0596,0,0,-.0596,0,0,-.3996,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,n),n.computeWorldMatrix(!0)),n}function u(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var n=new BABYLON.Mesh(e.name+".bottom",t,e,i),s=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=.03,n.position.y=-4e-4,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,s||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[.12,0,0,.42,0,0,.42,.12,0,.12,0,0,.12,.12,0,0,0,0,.42,0,0,.54,0,0,.42,.12,0,.12,.12,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,n),n.computeWorldMatrix(!0)),n}function d(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var n=new BABYLON.Mesh(e.name+".dot",t,e,i),s=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=.64,n.position.y=-4e-4,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,s||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[.12,0,0,.12,.12,0,0,.12,0,0,0,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,4,0,6,n),n.computeWorldMatrix(!0)),n}function _(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var n=new BABYLON.Mesh(e.name+".center",t,e,i),s=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=.3,n.position.y=.5296,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,s||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.1451,-.06,0,-.1451,.06,0,-.27,-4e-4,0,.1449,-.06,0,.1449,.06,0,-.0289,.06,0,.27,0,0,-.0289,-.06,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,4,3,6,1,0,7,5,1,7,7,3,5]),n.subMeshes=[],new BABYLON.SubMesh(0,0,8,0,18,n),n.computeWorldMatrix(!0)),n}var p=new Array(3),g=1,f=0,B=0,A=function(){function i(e,i){void 0===i&&(i="./"),this._scene=e,t.defineMaterials(e,i)}return i.prototype.getModuleName=function(){return"DigitParts"},i.prototype.instance=function(t,i){var n,s=null;switch(t){case"Geometry":n=e(0,!0),null===n?(s=new y("Geometry",this._scene),f+=s.getTotalVertices(),p[0].push(s)):(s=new y("Geometry_"+g++,this._scene,null,n),B+=s.getTotalVertices());break;case"Down":n=e(1),null===n?(s=new O("Down",this._scene),f+=s.getTotalVertices(),p[1].push(s)):(s=new O("Down_"+g++,this._scene,null,n),B+=s.getTotalVertices());break;case"Up":n=e(2),null===n?(s=new b("Up",this._scene),f+=s.getTotalVertices(),p[2].push(s)):(s=new b("Up_"+g++,this._scene,null,n),B+=s.getTotalVertices())}if(null!==s){if(i&&n&&n.skeleton){var o=n.skeleton.name+g;s.skeleton=n.skeleton.clone(o,o)}}else BABYLON.Tools.Error("Mesh not found: "+t);return s},i}();t.MeshFactory=A,t.getStats=n;var L=!1;t.defineMaterials=s,t.defineMultiMaterials=o;var y=function(e){function i(i,n,s,o){void 0===s&&(s="./"),e.call(this,i,n,null,o,!0),t.defineMaterials(n,s);var p=o&&null!==o;this.botLeft=p?r(n,this,o.botLeft):r(n,this),this.topLeft=p?a(n,this,o.topLeft):a(n,this),this.top=p?l(n,this,o.top):l(n,this),this.topRite=p?h(n,this,o.topRite):h(n,this),this.botRite=p?c(n,this,o.botRite):c(n,this),this.bottom=p?u(n,this,o.bottom):u(n,this),this.dot=p?d(n,this,o.dot):d(n,this),this.center=p?_(n,this,o.center):_(n,this),this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=1,this.scaling.z=1,this.isVisible=!1,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1}return __extends(i,e),i.prototype.dispose=function(){this.setEnabled(!1)},i}(BABYLON.Mesh);t.Geometry=y;var O=function(e){function n(i,n,s,o){void 0===s&&(s="./"),e.call(this,i,n,null,o,!0),t.defineMaterials(n,s);var r=o&&null!==o;this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=1,this.scaling.z=1,this.isVisible=!0,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1,r||(this.setVerticesData(BABYLON.VertexBuffer.PositionKind,[0,-.0034,0,.0024,-.0017,0,0,0,0,.8105,-.6441,.02,.8105,.6359,.02,-.0866,-.0021,.02,-.0895,-.0041,.02,-.0895,0,.02,.75,-.5368,0,.75,.5299,0,.0024,-.0017,0],!1),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),this.setIndices([0,1,2,3,4,5,6,5,7,8,9,10]),this.setMaterialByID("DigitParts.Multimaterial#0"),this.subMeshes=[],new BABYLON.SubMesh(0,0,8,0,9,this),new BABYLON.SubMesh(1,8,3,9,3,this),this.computeWorldMatrix(!0))}return __extends(n,e),n.prototype.dispose=function(t){e.prototype.dispose.call(this,t),i(1)},n}(DIALOG.Letter);t.Down=O;var b=function(e){function n(i,n,s,o){void 0===s&&(s="./"),e.call(this,i,n,null,o,!0),t.defineMaterials(n,s);var r=o&&null!==o;this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=1,this.scaling.z=1,this.isVisible=!0,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1,r||(this.setVerticesData(BABYLON.VertexBuffer.PositionKind,[0,.0034,0,-.0024,.0017,0,0,0,0,-.8105,.6441,.02,-.8105,-.6359,.02,.0866,.0021,.02,.0895,.0041,.02,.0895,0,.02,-.75,.5368,0,-.75,-.5299,0,-.0024,.0017,0],!1),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),this.setIndices([0,1,2,3,4,5,6,5,7,8,9,10]),this.setMaterialByID("DigitParts.Multimaterial#1"),this.subMeshes=[],new BABYLON.SubMesh(0,0,8,0,9,this),new BABYLON.SubMesh(1,8,3,9,3,this),this.computeWorldMatrix(!0))}return __extends(n,e),n.prototype.dispose=function(t){e.prototype.dispose.call(this,t),i(2)},n}(DIALOG.Letter);t.Up=b}(DigitParts||(DigitParts={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},DIALOG;!function(t){var e,i=function(i){function s(){if(!e){e=new DigitParts.MeshFactory(t.DialogSys._scene);var o=e.instance("Geometry"),r=t.Panel.ExtractMax(o.dot).x+o.dot.position.x+.05,a=t.Panel.ExtractMax(o.top).y+o.top.position.y;s._maxWorld=new BABYLON.Vector3(r,a,0),o.dispose(!1)}i.call(this,e.instance("Geometry")),this.setMaterial(n.MAT),this._minWorld=BABYLON.Vector3.Zero(),this._maxWorld=s._maxWorld,this.setDigit("0",!1)}return __extends(s,i),s.prototype.setDigit=function(t,e,i){var n=this._inside;if(-1==="E0123456789-".indexOf(t)||1!==t.length)return BABYLON.Tools.Error(t+" is not a valid setting for Digit"),void 0;var o=e&&-1!=="0".indexOf(t);n.botLeft.visibility=-1!=="E268".indexOf(t)||o?1:s._minVisibility,n.topLeft.visibility=-1!=="E45689".indexOf(t)||o?1:s._minVisibility,n.top.visibility=-1!=="E2356789".indexOf(t)||o?1:s._minVisibility,n.bottom.visibility=-1!=="E235689".indexOf(t)||o?1:s._minVisibility,n.botRite.visibility=-1!=="13456789".indexOf(t)||o?1:s._minVisibility,n.topRite.visibility=-1!=="1234789".indexOf(t)||o?1:s._minVisibility,n.center.visibility=-1!=="E2345689-".indexOf(t)?1:s._minVisibility,n.dot.visibility=i?1:s._minVisibility},s.prototype.setMaterial=function(t){var e=this._inside;e.botLeft.material=t,e.topLeft.material=t,e.top.material=t,e.bottom.material=t,e.botRite.material=t,e.topRite.material=t,e.center.material=t,e.dot.material=t},s.prototype.dispose=function(){i.prototype.dispose.call(this)},s._minVisibility=0,s}(t.MeshWrapperPanel),n=function(e){function n(s,o,r,a){e.call(this,s,t.DialogSys._scene),this._nDigits=o,this._alwaysDot=r,this._fixed=a,this.name=s,n.MAT||(n.MAT=t.DialogSys.BLACK[t.DialogSys.USE_CULLING_MAT_FOR_2D?0:1]),this.material=n.MAT;for(var l=0;o>l;l++)this.addSubPanel(new i);this._value=0}return __extends(n,e),Object.defineProperty(n.prototype,"value",{get:function(){return this._value},set:function(t){this._value=t;var e=this._fixed?t.toFixed(this._fixed):t.toString(),i=e.length;-1!==e.indexOf(".")?i--:this._alwaysDot&&(e+=".");var n=this.getSubPanels();if(i>this._nDigits){n[0].setDigit("E");for(var s=1;s<this._nDigits;s++)n[s].setDigit("0",!1)}else{for(var o=this._nDigits-i,s=0;o>s;s++)n[s].setDigit("0",!1);for(var r=0,s=o;s<this._nDigits;s++){var a="."===e.charAt(r+1);n[s].setDigit(e.charAt(r++),!0,a),a&&r++}}},enumerable:!0,configurable:!0}),n}(t.BasePanel);t.LCD=n;var s=function(i){function s(e,o,r,a,l,h){if(void 0===h&&(h=1),i.call(this,e,t.DialogSys._scene),this.minValue=r,this.maxValue=a,this.increment=h,this._chngInProgress=!1,!s.MAT){var c=new BABYLON.MultiMaterial("button",t.DialogSys._scene);c.subMaterials.push(t.DialogSys.BLACK[0]),c.subMaterials.push(t.DialogSys.BLACK[0]),s.MAT=c,c=new BABYLON.MultiMaterial("button selected",t.DialogSys._scene),c.subMaterials.push(t.DialogSys.BLACK[0]),c.subMaterials.push(t.DialogSys.ORANGE[0]),s.SELECTED_MAT=c}if(0>=h)return BABYLON.Tools.Error("increment must positive"),void 0;if(this.minValue+h>this.maxValue)return BABYLON.Tools.Error("min value + increment must be <= max value"),void 0;if(l<this.minValue||l>this.maxValue)return BABYLON.Tools.Error("initialValue not within min & max values"),void 0;var u=Math.floor(this.minValue)!==this.minValue||Math.floor(this.maxValue)!==this.maxValue||Math.floor(this.increment)!==this.increment;if(!u&&Math.floor(l)!==l)return BABYLON.Tools.Error("initialValue must be integer minValue, maxValue, & increment are"),void 0;if(this._display=new n(name+"-lcd",o,u),this._display.setBorderVisible(!0),this._display.verticalAlignment=t.Panel.ALIGN_VCENTER,this.value=l,this._display._calcRequiredSize(),e&&null!=e&&e.replace(" ","").length>0){var d=new t.Label(e);d.verticalAlignment=t.Panel.ALIGN_BOTTOM,this.addSubPanel(d)}this.addSubPanel(this._downButton=this._getButton("Down")),this.addSubPanel(this._display),this.addSubPanel(this._upButton=this._getButton("Up")),i.prototype.registerAfterRender.call(this,s._normalMaterials),this.setBorderVisible(!0)}return __extends(s,i),s.prototype.dispose=function(){i.prototype.dispose.call(this,!1),this.unregisterAfterRender(s._normalMaterials)},s.prototype._getButton=function(i){var n=e.instance(i),o=t.Panel.ExtractMax(n).y;n.verticalAlignment=t.Panel.ALIGN_VCENTER,n.maxAboveY=o,n.minBelowY=-o,n.material=s.MAT;var r=this;return n.registerPickAction(function(){n._panelEnabled&&(n.material=s.SELECTED_MAT,"Down"===i?r._decrement():r._increment())}),n},s._normalMaterials=function(t){var e=t;e._chngInProgress?(e._chngInProgress=!1,e._downButton.material=s.MAT,e._upButton.material=s.MAT):(e._downButton.material!==s.MAT||e._upButton.material!==s.MAT)&&(e._chngInProgress=!0)},s.prototype._increment=function(){this.value+this.increment<=this.maxValue&&(this.value+=this.increment)},s.prototype._decrement=function(){this.value-this.increment>=this.minValue&&(this.value-=this.increment)},Object.defineProperty(s.prototype,"value",{get:function(){return this._display.value},set:function(t){this._display.value=t},enumerable:!0,configurable:!0}),s}(t.BasePanel);t.NumberScroller=s}(DIALOG||(DIALOG={}));