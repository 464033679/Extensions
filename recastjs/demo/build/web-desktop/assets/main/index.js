System.register("chunks:///_virtual/recastJsPlugin.ts",["cc"],(function(e){"use strict";var t,n,i,s,r,a,o,h;return{setters:[function(e){t=e.cclegacy,n=e.math,i=e.v3,s=e.Vec3,r=e.Node,a=e.utils,o=e.MeshRenderer,h=e.error}],execute:function(){function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t._RF.push({},"0b50frk54dKy4k6XWhHNS1a","recastJsPlugin",void 0);var g=e("RecastConfig",{RATIO:1}),c=(e("RecastJSPlugin",function(){function e(e){void 0===e&&(e=Recast),u(this,"bjsRECAST",{}),u(this,"name","RecastJSPlugin"),u(this,"navMesh",void 0),u(this,"_maximumSubStepCount",10),u(this,"_timeStep",1/60),"function"==typeof e?e(this.bjsRECAST):this.bjsRECAST=e,this.isSupported()?this.setTimeStep():h("RecastJS is not available. Please make sure you included the js file.")}var t=e.prototype;return t.setTimeStep=function(e){void 0===e&&(e=1/60),this._timeStep=e},t.getTimeStep=function(){return this._timeStep},t.setMaximumSubStepCount=function(e){void 0===e&&(e=10),this._maximumSubStepCount=e},t.getMaximumSubStepCount=function(){return this._maximumSubStepCount},t.createNavMesh=function(t,n){var i=new this.bjsRECAST.rcConfig;i.cs=n.cs,i.ch=n.ch,i.borderSize=n.borderSize?n.borderSize:0,i.tileSize=n.tileSize?n.tileSize:0,i.walkableSlopeAngle=n.walkableSlopeAngle,i.walkableHeight=n.walkableHeight,i.walkableClimb=n.walkableClimb,i.walkableRadius=n.walkableRadius,i.maxEdgeLen=n.maxEdgeLen,i.maxSimplificationError=n.maxSimplificationError,i.minRegionArea=n.minRegionArea,i.mergeRegionArea=n.mergeRegionArea,i.maxVertsPerPoly=n.maxVertsPerPoly,i.detailSampleDist=n.detailSampleDist,i.detailSampleMaxError=n.detailSampleMaxError;var s=null;if(n.offMeshLinkConfig){var r=n.offMeshLinkConfig;s=this.bjsRECAST.OffMeshLinkConfig.prototype.GetInstance(r.offMeshConVerts,r.offMeshConRad,r.offMeshConFlags,r.offMeshConAreas,r.offMeshConDir,r.offMeshConUserID,r.offMeshConCount)}this.navMesh=new this.bjsRECAST.NavMesh;var a=e.getMeshData(t),o=a.vertexTypeArray,h=a.startId,u=a.facesTypeArray;this.navMesh.build(o,h,u,u.length,i,s)},e.getMeshData=function(e){for(var t=e,r=[],a=[],o=0,h=0,u=new n.Mat4,c=i(),f=[],l=0,d=0;d<t.length;++d){var v=t[d].model;if(v){t[d].node.getWorldMatrix(u);for(var A=v.subModels,C=1/g.RATIO,y=0;y<A.length;y++){f.push(l);var p=A[y].subMesh.geometricInfo;if(p&&p.positions&&p.indices){for(var m=[],S=p.positions.length/3,x=0;x<S;++x)s.transformMat4(c,i(p.positions[3*x],p.positions[3*x+1],p.positions[3*x+2]),u),m.push(c.x*C,c.y*C,c.z*C);r.push(m),l+=m.length/3,a.push(p.indices),o+=p.positions.length,h+=p.indices.length}}}}var b=new Float32Array(new ArrayBuffer(4*o)),R=new Uint16Array(new ArrayBuffer(2*h));l=0;for(var w=0,T=0;T<r.length;++T){b.set(r[T],3*l);for(var E=a[T],M=0;M<E.length;++M)R[w++]=l+E[M];l+=r[T].length/3}return{vertexTypeArray:b,startId:l,facesTypeArray:R,group:f}},e.exportObj=function(e){for(var t=[],n=this.getMeshData(e),i=n.vertexTypeArray,s=n.facesTypeArray,r=n.group,a=0;a<i.length;a+=3)t.push("v "+i[a]+" "+i[a+1]+" "+i[a+2]);for(var o=0;o<s.length;o+=3)-1!==r.indexOf(o/3)&&t.push("g Cube"+r.indexOf(o/2)),t.push("f "+(s[o]+1)+" "+(s[o+1]+1)+" "+(s[o+2]+1));return t.join("\n")},t.createDebugNavMesh=function(t){var n,i,s=this.navMesh.getDebugNavMesh(),r=s.getTriangleCount(),a=[],o=[];for(n=0;n<3*r;n++)a.push(n);for(n=0;n<r;n++)for(i=0;i<3;i++){var h=s.getTriangle(n).getPoint(i);o.push(h.x,h.y,h.z)}return e.createMeshRenderer(t,o,a)},e.createMeshRenderer=function(e,t,h){var u=new r;e.addChild(u);var g=new n.Mat4;n.Mat4.invert(g,u.getWorldMatrix(g));for(var c=i(),f=0;f<t.length;f+=3)c.x=t[f],c.y=t[f+1],c.z=t[f+2],s.transformMat4(c,c,g),t[f]=c.x,t[f+1]=c.y,t[f+2]=c.z;var l=a.createMesh({positions:t,indices:h,doubleSided:!0});return u.addComponent(o).mesh=l,u},t.getClosestPoint=function(e){var t=new this.bjsRECAST.Vec3(e.x,e.y,e.z),n=this.navMesh.getClosestPoint(t);return e.x=n.x,e.y=n.y,e.z=n.z,e},t.getClosestPointToRef=function(e,t){var n=new this.bjsRECAST.Vec3(e.x,e.y,e.z),i=this.navMesh.getClosestPoint(n);t.set(i.x,i.y,i.z)},t.getRandomPointAround=function(e,t){var n=new this.bjsRECAST.Vec3(e.x,e.y,e.z),i=this.navMesh.getRandomPointAround(n,t);return new s(i.x,i.y,i.z)},t.getRandomPointAroundToRef=function(e,t,n){var i=new this.bjsRECAST.Vec3(e.x,e.y,e.z),s=this.navMesh.getRandomPointAround(i,t);n.set(s.x,s.y,s.z)},t.moveAlong=function(e,t){var n=new this.bjsRECAST.Vec3(e.x,e.y,e.z),i=new this.bjsRECAST.Vec3(t.x,t.y,t.z),r=this.navMesh.moveAlong(n,i);return new s(r.x,r.y,r.z)},t.moveAlongToRef=function(e,t,n){var i=new this.bjsRECAST.Vec3(e.x,e.y,e.z),s=new this.bjsRECAST.Vec3(t.x,t.y,t.z),r=this.navMesh.moveAlong(i,s);n.set(r.x,r.y,r.z)},t.computePath=function(e,t){var n,i=new this.bjsRECAST.Vec3(e.x,e.y,e.z),r=new this.bjsRECAST.Vec3(t.x,t.y,t.z),a=this.navMesh.computePath(i,r),o=a.getPointCount(),h=[];for(n=0;n<o;n++){var u=a.getPoint(n);h.push(new s(u.x,u.y,u.z))}return h},t.createCrowd=function(e,t,n){return new c(this,e,t,n)},t.setDefaultQueryExtent=function(e){var t=new this.bjsRECAST.Vec3(e.x,e.y,e.z);this.navMesh.setDefaultQueryExtent(t)},t.getDefaultQueryExtent=function(){var e=this.navMesh.getDefaultQueryExtent();return new s(e.x,e.y,e.z)},t.buildFromNavmeshData=function(e){var t=e.length*e.BYTES_PER_ELEMENT,n=this.bjsRECAST._malloc(t),i=new Uint8Array(this.bjsRECAST.HEAPU8.buffer,n,t);i.set(e);var s=new this.bjsRECAST.NavmeshData;s.dataPointer=i.byteOffset,s.size=e.length,this.navMesh=new this.bjsRECAST.NavMesh,this.navMesh.buildFromNavmeshData(s),this.bjsRECAST._free(i.byteOffset)},t.getNavmeshData=function(){var e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.bjsRECAST.HEAPU8.buffer,e.dataPointer,e.size),n=new Uint8Array(e.size);return n.set(t),this.navMesh.freeNavmeshData(e),n},t.getDefaultQueryExtentToRef=function(e){var t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)},t.dispose=function(){},t.addCylinderObstacle=function(e,t,n){return this.navMesh.addCylinderObstacle(new this.bjsRECAST.Vec3(e.x,e.y,e.z),t,n)},t.addBoxObstacle=function(e,t,n){return this.navMesh.addBoxObstacle(new this.bjsRECAST.Vec3(e.x,e.y,e.z),new this.bjsRECAST.Vec3(t.x,t.y,t.z),n)},t.removeObstacle=function(e){this.navMesh.removeObstacle(e)},t.isSupported=function(){return void 0!==this.bjsRECAST},e}()),e("RecastJSCrowd",function(){function e(e,t,n,i){u(this,"bjsRECASTPlugin",void 0),u(this,"recastCrowd",{}),u(this,"transforms",new Array),u(this,"agents",new Array),u(this,"_scene",void 0),this.bjsRECASTPlugin=e,this.recastCrowd=new this.bjsRECASTPlugin.bjsRECAST.Crowd(t,n,this.bjsRECASTPlugin.navMesh.getNavMesh()),this._scene=i}var t=e.prototype;return t.addAgent=function(e,t,n){var i=new this.bjsRECASTPlugin.bjsRECAST.dtCrowdAgentParams;i.radius=t.radius,i.height=t.height,i.maxAcceleration=t.maxAcceleration,i.maxSpeed=t.maxSpeed,i.collisionQueryRange=t.collisionQueryRange,i.pathOptimizationRange=t.pathOptimizationRange,i.separationWeight=t.separationWeight,i.updateFlags=7,i.obstacleAvoidanceType=0,i.queryFilterType=0,i.userData=0;var s=this.recastCrowd.addAgent(new this.bjsRECASTPlugin.bjsRECAST.Vec3(e.x,e.y,e.z),i);return this.transforms.push(n),this.agents.push(s),s},t.getAgentPosition=function(t){var n=this.recastCrowd.getAgentPosition(t);return e.getWorldPosition(n)},e.getWorldPosition=function(e){return new s(e.x*g.RATIO,e.y*g.RATIO,e.z*g.RATIO)},t.getAgentPositionToRef=function(e,t){var n=this.recastCrowd.getAgentPosition(e);t.set(n.x,n.y,n.z)},t.getAgentVelocity=function(e){var t=this.recastCrowd.getAgentVelocity(e);return new s(t.x,t.y,t.z)},t.getAgentVelocityToRef=function(e,t){var n=this.recastCrowd.getAgentVelocity(e);t.set(n.x,n.y,n.z)},t.getAgentNextTargetPath=function(e){var t=this.recastCrowd.getAgentNextTargetPath(e);return new s(t.x,t.y,t.z)},t.getAgentNextTargetPathToRef=function(e,t){var n=this.recastCrowd.getAgentNextTargetPath(e);t.set(n.x,n.y,n.z)},t.getAgentState=function(e){return this.recastCrowd.getAgentState(e)},t.overOffmeshConnection=function(e){return this.recastCrowd.overOffmeshConnection(e)},t.agentGoto=function(e,t){this.recastCrowd.agentGoto(e,new this.bjsRECASTPlugin.bjsRECAST.Vec3(t.x,t.y,t.z))},t.agentTeleport=function(e,t){this.recastCrowd.agentTeleport(e,new this.bjsRECASTPlugin.bjsRECAST.Vec3(t.x,t.y,t.z))},t.updateAgentParameters=function(e,t){var n=this.recastCrowd.getAgentParameters(e);void 0!==t.radius&&(n.radius=t.radius),void 0!==t.height&&(n.height=t.height),void 0!==t.maxAcceleration&&(n.maxAcceleration=t.maxAcceleration),void 0!==t.maxSpeed&&(n.maxSpeed=t.maxSpeed),void 0!==t.collisionQueryRange&&(n.collisionQueryRange=t.collisionQueryRange),void 0!==t.pathOptimizationRange&&(n.pathOptimizationRange=t.pathOptimizationRange),void 0!==t.separationWeight&&(n.separationWeight=t.separationWeight),this.recastCrowd.setAgentParameters(e,n)},t.removeAgent=function(e){this.recastCrowd.removeAgent(e);var t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1)[0].destroy())},t.getAgents=function(){return this.agents},t.update=function(e){this.bjsRECASTPlugin.navMesh.update();var t=this.bjsRECASTPlugin.getTimeStep(),n=this.bjsRECASTPlugin.getMaximumSubStepCount();if(t<=.1)this.recastCrowd.update(e);else{var i=Math.floor(e/t);n&&i>n&&(i=n),i<1&&(i=1);for(var s=e/i,r=0;r<i;r++)this.recastCrowd.update(s)}for(var a=0;a<this.agents.length;a++)this.transforms[a].worldPosition=this.getAgentPosition(this.agents[a])},t.setDefaultQueryExtent=function(e){var t=new this.bjsRECASTPlugin.bjsRECAST.Vec3(e.x,e.y,e.z);this.recastCrowd.setDefaultQueryExtent(t)},t.getDefaultQueryExtent=function(){var e=this.recastCrowd.getDefaultQueryExtent();return new s(e.x,e.y,e.z)},t.getDefaultQueryExtentToRef=function(e){var t=this.recastCrowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)},t.getCorners=function(e){var t,n=this.recastCrowd.getPath(e),i=n.getPointCount(),r=[];for(t=0;t<i;t++){var a=n.getPoint(t);r.push(new s(a.x,a.y,a.z))}return r},t.dispose=function(){this.recastCrowd.destroy()},e}()));t._RF.pop()}}}));

System.register("chunks:///_virtual/RecastDetourManager.ts",["cc","./recastJsPlugin.ts"],(function(t){"use strict";var e,i,n,s,o,a,r,l,h,u,c,g;return{setters:[function(t){e=t.cclegacy,i=t._decorator,n=t.Node,s=t.Line,o=t.Color,a=t.director,r=t.isValid,l=t.MeshRenderer,h=t.UIMeshRenderer,u=t.v3},function(t){c=t.RecastConfig,g=t.RecastJSPlugin}],execute:function(){var d,f,v;function m(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}e._RF.push({},"549afRrwgxKSoezdljXnHlA","RecastDetourManager",void 0);var p=i,b=p.ccclass,C=(p.property,1e3);t("default",b("RecastDetourManager")((v=f=function(){function t(){m(this,"currentMillisecond",0),m(this,"millisecondsBetweenFrames",40),m(this,"currentTick",0),m(this,"crowd",void 0),m(this,"dt",0),m(this,"debugLayer",1),m(this,"obstacleList",[]),this.linkList={offMeshConVerts:[],offMeshConRad:[],offMeshConFlags:[],offMeshConAreas:[],offMeshConDir:[],offMeshConUserID:[],offMeshConCount:0}}var e=t.prototype;return e.addLink=function(t,e,i,r,l,h){void 0===i&&(i=.6),void 0===r&&(r=1),void 0===l&&(l=5),void 0===h&&(h=1),t.multiplyScalar(1/c.RATIO),e.multiplyScalar(1/c.RATIO),this.navigationPlugin.getClosestPoint(t),this.navigationPlugin.getClosestPoint(e),this.linkList.offMeshConVerts.push(t.x,t.y,t.z,e.x,e.y,e.z),this.linkList.offMeshConRad.push(i),this.linkList.offMeshConFlags.push(r),this.linkList.offMeshConAreas.push(l),this.linkList.offMeshConDir.push(h),this.linkList.offMeshConCount++;var u=C++;this.linkList.offMeshConUserID.push(u),this.reBuild();var g=new n,d=g.addComponent(s);return d.worldSpace=!0,d.width.constant=.1,d.color.color=o.BLUE,d.positions.push(t,e),a.getScene().addChild(g),u},e.removeAllLink=function(){for(var t=0;t<this.linkList.node.length;++t)this.linkList.node[t].destroy();this.linkList={offMeshConVerts:[],offMeshConRad:[],offMeshConFlags:[],offMeshConAreas:[],offMeshConDir:[],offMeshConUserID:[],offMeshConCount:0}},e.reBuild=function(){this.config.offMeshLinkConfig=this.linkList,this.navigationPlugin.createNavMesh(this.meshes,this.config),this.init()},t.getInstanceByNode=function(t,e,i){var n=t.getComponentsInChildren(l),s=this.getInstance(e,i),o={cs:.2,ch:.2,walkableSlopeAngle:45,walkableHeight:15,walkableClimb:2,walkableRadius:.6,maxEdgeLen:12,maxSimplificationError:.5,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1,offMeshLinkConfig:s.linkList,tileSize:24};return s.config=o,s.meshes=n,s.navigationPlugin.createNavMesh(n,o),s.init(),s},t.getInstance=function(e,i){if(this.instance)return this.instance;var n=new t;this.instance=n,n.debugMaterial=e,n.debugLayer=i;var s=new g;return n.navigationPlugin=s,n},t.getInstanceByBin=function(t,e,i){var n=this.getInstance(e,i);return n.navigationPlugin.buildFromNavmeshData(new Uint8Array(t)),n.init(),n},e.init=function(){this.crowd&&this.removeAllAgents();var t=a.getScene(),e=this.navigationPlugin.createCrowd(10,.1,t);this.crowd=e,this.updateNavMeshDebug()},e.updateNavMeshDebug=function(){r(this.navmeshdebug)&&this.navmeshdebug.destroy();var t=a.getScene();this.navmeshdebug=this.navigationPlugin.createDebugNavMesh(t),this.navmeshdebug.getComponent(l).setMaterial(this.debugMaterial,0),this.navmeshdebug.layer=this.debugLayer,this.navmeshdebug.addComponent(h)},e.agentGoto=function(t){var e=t.multiplyScalar(1/c.RATIO);e=this.navigationPlugin.getClosestPoint(e),console.log("goto",e);for(var i=this.crowd.getAgents(),n=0;n<i.length;++n)this.crowd.agentGoto(i[n],e)},e.addAgents=function(t,e){t.multiplyScalar(1/c.RATIO),this.navigationPlugin.getClosestPoint(t);this.crowd.addAgent(t,{radius:.5,height:2,maxAcceleration:20,maxSpeed:6,collisionQueryRange:0,pathOptimizationRange:0,separationWeight:1},e)},e.removeAllAgents=function(){for(;this.crowd.agents.length;)this.crowd.removeAgent(0)},e.addCylinderObstacle=function(t,e,i,n){var s=this;t.worldPosition=e,e.multiplyScalar(1/c.RATIO),setTimeout((function(){s.updateNavMeshDebug()}),100);var o=this.navigationPlugin.addCylinderObstacle(e,i,n);return this.obstacleList.push({node:t,obstacle:o}),o},e.addBoxObstacle=function(t,e,i,n){var s=this;t.worldPosition=e,e.multiplyScalar(1/c.RATIO),setTimeout((function(){s.updateNavMeshDebug()}),100);var o=this.navigationPlugin.addBoxObstacle(e,i,n);return this.obstacleList.push({node:t,obstacle:o}),o},e.removeAllObstacle=function(){for(var t=this,e=0;e<this.obstacleList.length;++e)this.obstacleList[e].node.destroy(),this.navigationPlugin.removeObstacle(this.obstacleList[e].obstacle);setTimeout((function(){t.updateNavMeshDebug()}),100),this.obstacleList=[]},e.addRandomAgents=function(t){var e=this.navigationPlugin.getRandomPointAround(u(0,0,0),2);console.log(e),this.addAgents(e,t)},e.update=function(t){this.crowd&&this.crowd.update(t)},t}(),m(f,"instance",void 0),d=v))||d);e._RF.pop()}}}));

System.register("chunks:///_virtual/test.ts",["cc","./recastJsPlugin.ts","./RecastDetourManager.ts"],(function(e){"use strict";var t,i,o,n,a,r,s,l,c,u,d,h,b,y,v,m,f,p,g,O;return{setters:[function(e){t=e.cclegacy,i=e._decorator,o=e.Node,n=e.Camera,a=e.Material,r=e.NodePool,s=e.systemEvent,l=e.SystemEventType,c=e.macro,u=e.resources,d=e.Asset,h=e.MeshRenderer,b=e.geometry,y=e.v3,v=e.instantiate,m=e.math,f=e.Vec3,p=e.Component},function(e){g=e.RecastJSPlugin},function(e){O=e.default}],execute:function(){var w,E,M,N,K,P,k,D,R,L,_,x,C;function A(e,t,i,o){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(o):void 0})}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function T(e,t,i,o,n){var a={};return Object.keys(o).forEach((function(e){a[e]=o[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,o){return o(e,t,i)||i}),a),n&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(n):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}t._RF.push({},"8d436e1KSFDvKG14XdvEUXo","test",void 0);var S=i.ccclass,U=i.property;e("Test",(w=S("Test"),E=U(o),M=U(o),N=U(o),K=U(n),P=U(a),w((R=T((D=function(e){var t,i;function n(){for(var t,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return A(z(t=e.call.apply(e,[this].concat(o))||this),"roleNode",R,z(t)),A(z(t),"cylinderObstacleNode",L,z(t)),A(z(t),"boxObstacleNode",_,z(t)),A(z(t),"camera",x,z(t)),A(z(t),"debugMaterial",C,z(t)),F(z(t),"type",1),F(z(t),"obstacleList",[]),F(z(t),"yKey",0),F(z(t),"xKey",0),F(z(t),"startLinkPos",void 0),t}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var a=n.prototype;return a.start=function(){this.pool=new r,this.roleNodeRoot=this.roleNode.parent,this.roleNode.removeFromParent(),this.cylinderObstacleNode.removeFromParent(),this.boxObstacleNode.removeFromParent(),this.moveDis=0,this.recastDetourManager=O.getInstanceByNode(this.node,this.debugMaterial,1),this.node.on(o.EventType.TOUCH_END,this.onTouch,this),this.node.on(o.EventType.TOUCH_MOVE,this.onMove,this),s.on(l.KEY_DOWN,this.onKeyDown,this),s.on(l.KEY_UP,this.onKeyUp,this),this.cylinderObstaclePool=new r,this.boxObstaclePool=new r},a.onKeyDown=function(e){switch(e.keyCode){case c.KEY.w:case c.KEY.s:this.yKey=e.keyCode;break;case c.KEY.a:case c.KEY.d:this.xKey=e.keyCode}},a.onKeyUp=function(e){e.keyCode!=this.yKey?e.keyCode==this.xKey&&(this.xKey=0):this.yKey=0},a.toggleClick=function(e){this.type=Number(e.node.name[e.node.name.length-1])},a.loadBin=function(){var e=this;u.load("solo_navmesh",d,(function(t,i){e.recastDetourManager=O.getInstanceByBin(i._file,e.debugMaterial,1)}))},a.saveBin=function(){this.saveFile("solo_navmesh.bin",this.recastDetourManager.navigationPlugin.getNavmeshData())},a.exportObj=function(){var e=this.node.getComponentsInChildren(h),t=g.exportObj(e);this.saveFile("scene.obj",t)},a.saveFile=function(e,t){var i=new Blob([t],{type:"application/octet-stream"}),o=document.createElement("a");o.href=window.URL.createObjectURL(i),o.download=e,document.body.appendChild(o),o.click()},a.onTouch=function(e){if(this.moveDis>50)this.moveDis=0;else{for(var t=this.camera.screenPointToRay(e.getLocationX(),e.getLocationY()),i=this.node.getComponentsInChildren(h),o=Number.MAX_VALUE,n=0;n<i.length;++n){var a=b.intersect.rayModel(t,i[n].model,{mode:b.ERaycastMode.CLOSEST,doubleSided:!1,distance:Number.MAX_SAFE_INTEGER});a&&a<o&&(o=a)}if(o!=Number.MIN_VALUE){var r=y();switch(t.computeHit(r,o),this.type){case 1:this.recastDetourManager.addAgents(r,this.get(this.pool,this.roleNode));break;case 2:this.recastDetourManager.agentGoto(r);break;case 3:var s=this.get(this.cylinderObstaclePool,this.cylinderObstacleNode);this.recastDetourManager.addCylinderObstacle(s,r,1,2);break;case 4:var l=this.get(this.boxObstaclePool,this.boxObstacleNode);this.recastDetourManager.addBoxObstacle(l,r,y(1,1,1),0);break;case 5:if(!this.startLinkPos){this.startLinkPos=r;break}this.recastDetourManager.addLink(this.startLinkPos,r),this.startLinkPos=void 0}5!=this.type&&(this.startLinkPos=void 0)}}},a.onMove=function(e){var t=e.getLocation().subtract(e.getPreviousLocation());this.moveDis+=t.length(),this.updateRotation(t)},a.updateRotation=function(e){var t=this.camera.node.eulerAngles,i=t.y+-e.x/5,o=t.x+e.y/5;this.camera.node.setRotationFromEuler(o,i,0)},a.removeAllObstacle=function(){this.recastDetourManager.removeAllObstacle()},a.removeAllLink=function(){this.recastDetourManager.removeAllLink()},a.onEnable=function(){},a.get=function(e,t){var i=e.get()||v(t);return i.parent=this.roleNodeRoot,i},a.put=function(e){this.pool.put(e)},a.update=function(e){this.recastDetourManager.update(e);var t=this.yKey?this.yKey==c.KEY.w?1:-1:0,i=this.xKey?this.xKey==c.KEY.d?1:-1:0;t&&i&&(i*=.7,t*=.7);var o=y();if(t&&o.add(this.camera.node.forward.multiplyScalar(t)),i){var n=this.camera.node.getWorldRotation();m.Quat.rotateY(n,n,Math.PI/2),o.add(f.transformQuat(new f,f.FORWARD,n).multiplyScalar(-i))}this.camera.node.getWorldRotation();var a=this.camera.node.getPosition();this.camera.node.setPosition(a.add(o))},n}(p)).prototype,"roleNode",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=T(D.prototype,"cylinderObstacleNode",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=T(D.prototype,"boxObstacleNode",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=T(D.prototype,"camera",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=T(D.prototype,"debugMaterial",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=D))||k));t._RF.pop()}}}));

System.register("chunks:///_virtual/INavigationEngine.ts",["cc"],(function(){"use strict";var t;return{setters:[function(i){t=i.cclegacy}],execute:function(){t._RF.push({},"da4c4z82jBOl6Bx9rziPsqP","INavigationEngine",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./recastJsPlugin.ts","./RecastDetourManager.ts","./test.ts","./INavigationEngine.ts"],(function(){"use strict";return{setters:[function(){},function(){},function(){},function(){}],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});