[{"Owner":"ozRocker","Date":"2016-05-18T15:12:12Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI sometimes get a javascript error on my site _lt_a href_eq__qt_http_dd_//www.punkoffice.com/webiverse_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.punkoffice.com/webiverse_lt_/a_gt_ while the skybox is loading at the first page.  It only happens on my iPhone_co_ but like 1 out of 7 times.  When the error happens the skybox fails to load and the sky is just black.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI_t_m loading my scene.  When it loads I_t_ll add a light_co_ camera_co_ ground then skybox_co_ one after the other.  Everything else comes out fine.  At this stage there_t_s no asynchronous calls going on so this shouldn_t_t be caused by a race condition in my code.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe error I get is_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_TypeError_dd_ undefined is not an object (evaluating _t_t[c].width_t_)\n(anonymous function) babylon.2.4.js_dd_3_dd_29698\na babylon.2.4.js_dd_2_dd_26402\nonload babylon.2.4.js_dd_2_dd_6865_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tMy skybox code is_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_    private static setupSkyBox() {\n        var skybox _eq_ BABYLON.Mesh.CreateBox(_qt_skyBox_qt__co_ 700.0_co_ this.scene)_sm_\n        var skyboxMaterial _eq_ new BABYLON.StandardMaterial(_qt_skyBox_qt__co_ this.scene)_sm_\n        skyboxMaterial.backFaceCulling _eq_ false_sm_\n        skyboxMaterial.reflectionTexture _eq_ new BABYLON.CubeTexture(_qt_images/skybox/plainsky_qt__co_ this.scene)_sm_\n        skyboxMaterial.reflectionTexture.coordinatesMode _eq_ BABYLON.Texture.SKYBOX_MODE_sm_\n        skyboxMaterial.diffuseColor _eq_ new BABYLON.Color3(0_co_ 0_co_ 0)_sm_\n        skyboxMaterial.specularColor _eq_ new BABYLON.Color3(0_co_ 0_co_ 0)_sm_\n        skybox.material _eq_ skyboxMaterial_sm_\n        Tools.debug(1_co__qt_Skybox_qt_)_sm_\n    }_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2016-05-18T17:00:06Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tdo you mind doing the same test with babylon.max.js?\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"ozRocker","Date":"2016-05-19T12:14:30Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_128931_qt_ data-ipsquote-contentid_eq__qt_22640_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1463590806_qt_ data-ipsquote-userid_eq__qt_4442_qt_ data-ipsquote-username_eq__qt_Deltakosh_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t19 hours ago_co_ Deltakosh said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tdo you mind doing the same test with babylon.max.js?\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tok_co_ here is the error in reference to the babylon.max.js file_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_TypeError_dd_ undefined is not an object (evaluating _t_imgs[index].width_t_)  babylon.2.4.max.js_dd_7063_dd_88\n(anonymous function) babylon.2.4.max.js_dd_7062_dd_87\nonload babylon.2.4.max.js_dd_5536\nonload babylon.2.4.max.js_dd_4491_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tpossibly a race condition in there which only gets triggered on mobile devices?  cos it looks like the imgs haven_t_t loaded yet.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2016-05-19T16:44:55Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tHard to debug _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_ do you mind sharing a page with .max.js so I can have a look?\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"ozRocker","Date":"2016-05-20T03:10:31Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tIts in Engine.prototype.createCubeTexture\n_lt_/p_gt_\n\n_lt_p_gt_\n\tthis code here_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_for (var index _eq_ 0_sm_ index &lt_sm_ faces.length_sm_ index++) {\n   _this._workingContext.drawImage(imgs[index]_co_ 0_co_ 0_co_ imgs[index].width_co_ imgs[index].height_co_ 0_co_ 0_co_ width_co_ height)_sm_\n   gl.texImage2D(faces[index]_co_ 0_co_ gl.RGBA_co_ gl.RGBA_co_ gl.UNSIGNED_BYTE_co_ _this._workingCanvas)_sm_\n}_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tThe error happens when it first tries to access imgs[index].width because imgs is undefined at that time.  Note that this problem doesn_t_t happen all the time.  Maybe 1 out of 10 times on mobile devices.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2016-05-20T15:28:52Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tThe thing is that this code is inside the img.onload _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"ozRocker","Date":"2016-05-20T15:44:08Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_129218_qt_ data-ipsquote-contentid_eq__qt_22640_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1463758132_qt_ data-ipsquote-userid_eq__qt_4442_qt_ data-ipsquote-username_eq__qt_Deltakosh_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t15 minutes ago_co_ Deltakosh said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tThe thing is that this code is inside the img.onload _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tDo you think its the mobile browser that_t_s causing the problem?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2016-05-20T21:38:57Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tI_t_m pretty sure it is...seems like Safari calls OnLoad before data is completely parsed\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]