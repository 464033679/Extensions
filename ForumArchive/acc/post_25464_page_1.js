[{"Owner":"royibernthal","Date":"2016-09-27T12:36:01Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI_t_d like to animate a rigged 3d model I_t_m loading from a .babylon file_co_ as concluded in the previous topic_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/topic/24180-3d-models-animations/_qt_ rel_eq__qt__qt__gt_http_dd_//www.html5gamedevs.com/topic/24180-3d-models-animations/_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI read the following according to _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/14282-johnk/?do_eq_hovercard_qt_ data-mentionid_eq__qt_14282_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/14282-johnk/_qt_ rel_eq__qt__qt__gt_@JohnK_lt_/a_gt__t_s suggestion_dd_\n_lt_/p_gt_\n\n_lt_p style_eq__qt_color_dd_rgb(39_co_42_co_52)_sm_font-family_dd__t_Helvetica Neue_t__co_ Helvetica_co_ Arial_co_ sans-serif_sm_font-size_dd_14px_sm_font-style_dd_normal_sm_font-weight_dd_normal_sm_letter-spacing_dd_normal_sm_text-indent_dd_0px_sm_text-transform_dd_none_sm_white-space_dd_normal_sm_word-spacing_dd_0px_sm_background-color_dd_rgb(255_co_255_co_255)_sm__qt__gt_\n\t_lt_a href_eq__qt_http_dd_//doc.babylonjs.com/tutorials/Animations_qt_ rel_eq__qt_external nofollow_qt_ style_eq__qt_color_dd_rgb(60_co_105_co_148)_sm_text-decoration_dd_underline_sm_background-color_dd_transparent_sm__qt__gt_http_dd_//doc.babylonjs.com/tutorials/Animations_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p style_eq__qt_margin-bottom_dd_0px_sm_color_dd_rgb(39_co_42_co_52)_sm_font-family_dd__t_Helvetica Neue_t__co_ Helvetica_co_ Arial_co_ sans-serif_sm_font-size_dd_14px_sm_font-style_dd_normal_sm_font-weight_dd_normal_sm_letter-spacing_dd_normal_sm_text-indent_dd_0px_sm_text-transform_dd_none_sm_white-space_dd_normal_sm_word-spacing_dd_0px_sm_background-color_dd_rgb(255_co_255_co_255)_sm__qt__gt_\n\t_lt_a href_eq__qt_http_dd_//doc.babylonjs.com/tutorials/How_to_use_Bones_and_Skeletons_qt_ rel_eq__qt_external nofollow_qt_ style_eq__qt_color_dd_rgb(60_co_105_co_148)_sm_text-decoration_dd_underline_sm_background-color_dd_transparent_sm__qt__gt_http_dd_//doc.babylonjs.com/tutorials/How_to_use_Bones_and_Skeletons_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tI_t_m using blender. Does _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/8492-jcpalmer/?do_eq_hovercard_qt_ data-mentionid_eq__qt_8492_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/8492-jcpalmer/_qt_ rel_eq__qt__qt__gt_@JCPalmer_lt_/a_gt__t_s Blender Exporter export skeletons with animations created in blender?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIn other words_co_ would I be able to simply animate a model in blender and then call scene.beginAnimation(skeleton...) to animate the loaded skeleton in bjs?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"gryff","Date":"2016-09-27T13:22:16Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tAnswer to both your questions is  - yes _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//dl.dropboxusercontent.com/u/70260871/webgl/anim_test3/index_anim1.html_qt_ rel_eq__qt_external nofollow_qt__gt_Simple Example_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tBut don_t_t use skeletons with a huge number of bones - limit of hardware not the exporter.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tcheers_co_ gryff _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"royibernthal","Date":"2016-09-27T15:10:16Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tSounds good_co_ thank you _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tUntil I figure out some problems with my rigging on the blender forums_co_ do you perhaps have a rigged model that I can play with?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAlso - what is the maximum number of bones per mesh (/per scene?) that you would recommend? I need this to work on mobile devices with high performance (hopefully 60 fps).\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"gryff","Date":"2016-09-27T16:06:30Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/8420-royibernthal/?do_eq_hovercard_qt_ data-mentionid_eq__qt_8420_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/8420-royibernthal/_qt_ rel_eq__qt__qt__gt_@royibernthal_lt_/a_gt_ _dd_ here you go_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//dl.dropboxusercontent.com/u/70260871/webgl/roy/base_model.zip_qt_ rel_eq__qt_external nofollow_qt__gt_base_model_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAs for the number of bones - depends on your hardware target.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t1.) Desktop - I have run 66 bones on my PC with a reasonable video graphics card.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t2.) If you are using  a laptop with no dedicated graphics card - &lt_sm_40\n_lt_/p_gt_\n\n_lt_p_gt_\n\t3. Mobile device - _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/8492-jcpalmer/?do_eq_hovercard_qt_ data-mentionid_eq__qt_8492_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/8492-jcpalmer/_qt_ rel_eq__qt__qt__gt_@JCPalmer_lt_/a_gt_ _dd_ recommends &lt_sm_30\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe base model that I provide above has 33. However_co_ it is possible to delete 8 thumb/finger bones_co_ the jaw bone_co_ the two eye bones and the two toe bones. Just depends on what type of animation you are looking at. So_co_ for example_co_ if there is no walking about you may not need the toe bones.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tJust remember_co_ if you delete bones to make sure the parts of the mesh they were associated with get re-weight painted.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tcheers_co_ gryff _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JCPalmer","Date":"2016-09-27T17:04:50Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tVertex shaders have a minimum requirement to support 128_co_ vector4_co_ uniforms.  Desktop implementations typically exceed the minimum_co_ iOS &amp_sm_ Android do not.  Each bone is a mat4_co_ which is 4 vector 4_t_s.  The theoretical max on mobile is therefore 128 / 4_co_ or 32.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tScanning _lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Shaders/default.vertex.fx_qt_ rel_eq__qt_external nofollow_qt__gt_default vertex shader_lt_/a_gt__co_ I see these uniform reservations_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_#include&lt_sm_bonesDeclaration&gt_sm_\n\n// Uniforms\n#include&lt_sm_instancesDeclaration&gt_sm_\n\nuniform mat4 view_sm_\nuniform mat4 viewProjection_sm_\n\n#ifdef DIFFUSE\nuniform mat4 diffuseMatrix_sm_\nuniform vec2 vDiffuseInfos_sm_\n#endif\n\n#ifdef AMBIENT\nuniform mat4 ambientMatrix_sm_\nuniform vec2 vAmbientInfos_sm_\n#endif\n\n#ifdef OPACITY\nuniform mat4 opacityMatrix_sm_\nuniform vec2 vOpacityInfos_sm_\n#endif\n\n#ifdef EMISSIVE\nuniform vec2 vEmissiveInfos_sm_\nuniform mat4 emissiveMatrix_sm_\n#endif\n\n#ifdef LIGHTMAP\nuniform vec2 vLightmapInfos_sm_\nuniform mat4 lightmapMatrix_sm_\n#endif\n\n#if defined(SPECULAR) &amp_sm_&amp_sm_ defined(SPECULARTERM)\nuniform vec2 vSpecularInfos_sm_\nuniform mat4 specularMatrix_sm_\n#endif\n\n#ifdef BUMP\nuniform vec3 vBumpInfos_sm_\nuniform mat4 bumpMatrix_sm_\n#endif\n\n#include&lt_sm_pointCloudVertexDeclaration&gt_sm_\n\n\n#include&lt_sm_clipPlaneVertexDeclaration&gt_sm_\n\n#include&lt_sm_fogVertexDeclaration&gt_sm_\n#include&lt_sm_shadowsVertexDeclaration&gt_sm_[0..maxSimultaneousLights]\n\n#include&lt_sm_logDepthDeclaration&gt_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tYou need to be extremely careful not include types of textures like AMBIENT_co_ OPACITY_co_ EMISSIVE_co_ LIGHTMAP_co_ or SPECULAR_co_ unless your bone count is low.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAssume you need DIFFUSE &amp_sm_ BUMP that is 16. World Matrix is 4.  Point cloud is 1 / 4 (round up to 1).   Clip plane is 1.  Fog is 0.  If you use need LOGARITHMICDEPTH that is 1 / 4 (round up to 1).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIf mesh receives shadows_co_ there is 4 per light.  Blender exporter allows you to reduce max lights.  Not sure I got it all.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"gryff","Date":"2016-09-27T17:47:22Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/8492-jcpalmer/?do_eq_hovercard_qt_ data-mentionid_eq__qt_8492_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/8492-jcpalmer/_qt_ rel_eq__qt__qt__gt_@JCPalmer_lt_/a_gt_ _dd_ TY for the explanation Jeff. Good to get a handle on WHY._lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tCurrently playing with the _qt_OpenSim_qt_ rig for MH1.1 - which has 26 bones  but two _qt_toe ends_qt_ can be deleted. It is a MH user contributed asset.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tcheers_co_ gryff _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"royibernthal","Date":"2016-09-27T21:01:13Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/7026-gryff/?do_eq_hovercard_qt_ data-mentionid_eq__qt_7026_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/7026-gryff/_qt_ rel_eq__qt__qt__gt_@gryff_lt_/a_gt_ Thank you _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_ I started to experiment on it. Animation is indeed simple to export and run_co_ amazing.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/8492-jcpalmer/?do_eq_hovercard_qt_ data-mentionid_eq__qt_8492_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/8492-jcpalmer/_qt_ rel_eq__qt__qt__gt_@JCPalmer_lt_/a_gt_ Thank you very much for the detailed explanation _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\t2 Questions_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t1) On mobile_co_ would the limit be 32 bones per scene or per mesh?\n_lt_/p_gt_\n\n_lt_p_gt_\n\t2) I_t_d just like to make sure I_t_m understanding what you wrote correctly - If the meshes receive shadows_co_ each mesh _qt_costs_qt_ 8 instead of 4 vector 4_t_s_co_ meaning the max bones drop to 16. Is that correct?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JCPalmer","Date":"2016-09-27T21:12:53Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t1) Nope_co_ depends on what else you do.  Subtract accordingly.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t2) Nope_co_ 4 vector 4_t_s per light.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAdd up all your extra stuff.   Subtract it from 128_co_ then divide by 4 to see max bones before forced to skin on the cpu_co_ which is not good.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"royibernthal","Date":"2016-09-27T22:14:06Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tSorry for being slow - \n_lt_/p_gt_\n\n_lt_p_gt_\n\t1) 128 vector 4_t_s limit refers to the whole scene and not to each mesh_co_ right?\n_lt_/p_gt_\n\n_lt_p_gt_\n\t2) Does vec2 count as half vec4? Is there a reason why you round up non-integer or is just to be on the safe side?\n_lt_/p_gt_\n\n_lt_p_gt_\n\t3) Assuming I have 1 mesh with a diffused texture and 1 light. Is the following correct?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tTotal vector 4_t_s limit_dd_ 128\n_lt_/p_gt_\n\n_lt_p_gt_\n\tview - 4_lt_br /_gt_\n\tviewProjection - 4_lt_br /_gt_\n\tdiffuseMatrix - 4_lt_br /_gt_\n\tvDiffuseInfos - 0.5_lt_br /_gt_\n\tvLightmapInfos - 0.5_lt_br /_gt_\n\tlightmapMatrix - 4\n_lt_/p_gt_\n\n_lt_p_gt_\n\tVector 4_t_s left before falling to CPU_dd_ 128-17_eq_111 (enough for around 27 bones)\n_lt_/p_gt_\n\n_lt_p_gt_\n\t4) Is the Vector 4_t_s minimum requirement to support going to increase on mobile in WebGL 2?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JCPalmer","Date":"2016-09-28T17:35:07Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t1) per shader_co_ in BJS terms a material\n_lt_/p_gt_\n\n_lt_p_gt_\n\t2) worst case.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t3) try it.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t4) No_co_ there is a way to pass uniforms via buffers though.  To take advantage_co_ vertex shaders would need recoding.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"royibernthal","Date":"2016-09-28T18:34:29Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t3) How can I try it and see how many vector 4_t_s are used?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAnyhow_co_ I just wanted to know if I got the logic right.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]