[{"Owner":"Bladetrick","Date":"2018-11-20T13:54:01Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHello!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI was noticing that .getClosestFacetAtCoordinates results in index _eq__eq_ null given the parameters below.Â  In what situation can this occur?Â  The nearestMesh is valid from what I can see.Â  It occurs fairly often in this set of data i_t_m using.\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_    nearestpoint _eq_ BABYLON.Vector3.Zero()_sm_\n    var index _eq_ nearestMesh.getClosestFacetAtCoordinates(-20.5_co_ 115_co_ 226_co_ nearestpoint)_sm_  // If i change the second parameter to 115 I get a facet index. \n\n    if (index !_eq_ null) {\n        worldPos _eq_ nearestMesh.getFacetPosition(index)_sm_\n    }_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tÂ \n_lt_/p_gt_\n\n_lt_p_gt_\n\tI noticed that if i switch the second paramter_t_s value by just 2_co_ I get an index back.Â  Does this mean that the distance between the given point and a mesh facet has a limit for it to work?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks for the help!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Sebavan","Date":"2018-11-20T15:14:43Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/30823-bladetrick/?do_eq_hovercard_qt_ data-mentionid_eq__qt_30823_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/30823-bladetrick/_qt_ rel_eq__qt__qt__gt_@Bladetrick_lt_/a_gt_Â it would be amazing to have a PG with a repro _lt_span_gt__lt_span class_eq__qt_ipsEmoji_qt__gt_ðŸ™‚_lt_/span_gt__lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span_gt_Pinging at _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/5453-jerome/?do_eq_hovercard_qt_ data-mentionid_eq__qt_5453_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/5453-jerome/_qt_ rel_eq__qt__qt__gt_@jerome_lt_/a_gt_Â the facet master._lt_/span_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Sebavan","Date":"2018-11-20T15:18:24Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tand _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/30823-bladetrick/?do_eq_hovercard_qt_ data-mentionid_eq__qt_30823_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/30823-bladetrick/_qt_ rel_eq__qt__qt__gt_@Bladetrick_lt_/a_gt_Â this could happen if your position is outside the block partitioning use for facet.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tFrom the doc_dd_Â \n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#000000_sm_font-size_dd_medium_sm__qt__gt_The method returns just the index of the closest facet_co_ if any._lt_/span_gt__lt_br style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#000000_sm_font-size_dd_medium_sm__qt_ /_gt_\n\t_lt_span style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#000000_sm_font-size_dd_medium_sm__qt__gt_Actually the world coordinates_lt_span_gt_Â _lt_/span_gt__lt_/span_gt__lt_em style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#000000_sm_font-size_dd_medium_sm__qt__gt_(x_co_ y_co_ z)_lt_/em_gt__lt_span style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#000000_sm_font-size_dd_medium_sm__qt__gt__lt_span_gt_Â _lt_/span_gt_are internally transformed to local coordinates in the mesh local system._lt_/span_gt__lt_br style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#000000_sm_font-size_dd_medium_sm__qt_ /_gt_\n\t_lt_span style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#000000_sm_font-size_dd_medium_sm__qt__gt_If these local coordinates aren_t_t in any block or if there_t_s no facet in this block_co_ it returns_lt_span_gt_Â _lt_/span_gt__lt_/span_gt__lt_code style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#000000_sm_font-size_dd_medium_sm__qt__gt_null_lt_/code_gt__lt_span style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#000000_sm_font-size_dd_medium_sm__qt__gt_._lt_/span_gt__lt_br style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#000000_sm_font-size_dd_medium_sm__qt_ /_gt_\n\t_lt_span style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#000000_sm_font-size_dd_medium_sm__qt__gt_This method can be called as many times you need_co_ even in the render loop._lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#000000_sm_font-size_dd_medium_sm__qt__gt_You might try to tweak the partitioning using _dd_Â _lt_a href_eq__qt_https_dd_//doc.babylonjs.com/how_to/how_to_use_facetdata#tweaking-the-partitioning_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//doc.babylonjs.com/how_to/how_to_use_facetdata#tweaking-the-partitioning_lt_/a_gt__lt_/span_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2018-11-20T15:21:49Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tof course_co_ there_t_s a limit for it to work_co_ in order to avoid to compute things when not necessary (too far from the mesh).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIt depends mainly on the size of the global box (bouding box) containing the partitioning _lt_span_gt__dd_ _lt_/span_gt__lt_a href_eq__qt_https_dd_//doc.babylonjs.com/how_to/how_to_use_facetdata#mesh-partitioning_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//doc.babylonjs.com/how_to/how_to_use_facetdata#mesh-partitioning_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tmaybe_co_ you could change the partiotining Bbox ratio\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code class_eq__qt_lang-javascript_qt__gt_mesh.partitioningBBoxRatio _eq_ _lt_span_gt_1.08_lt_/span_gt__sm_   // 8% bigger than the mesh_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tto get a bigger bbox\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2018-11-20T15:25:41Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_span_gt__lt_span_gt__lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/20193-sebavan/?do_eq_hovercard_qt_ data-mentionid_eq__qt_20193_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/20193-sebavan/_qt_ rel_eq__qt__qt__gt_@Sebavan_lt_/a_gt__lt_/span_gt__lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span_gt__lt_span_gt_it looks like something doesn_t_t work in the PG examples in the partitioning section _lt_/span_gt__lt_/span_gt_in the doc because we can_t_t see any longer the plane depicting the partitioning around the skull _lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#UZGNA%231_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#UZGNA#1_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tMaybe this has something to do with the modification of the BBox implementation in the last BJS version_co_ not sure ...\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Sebavan","Date":"2018-11-20T16:24:13Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tIT is because the private fields have been replaced by public properties_dd_Â _lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#UZGNA%236_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#UZGNA#6_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Sebavan","Date":"2018-11-20T16:29:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI have updated the doc.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Bladetrick","Date":"2018-11-20T18:45:24Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThanks_co_ that_t_s giving me a good starting point to work with.Â  I_t_m reading on partitioning more carefully and playing with the updated playground.Â  Â Question_co_ though_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWhen usingÂ \n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_var index _eq_ mesh.getClosestFacetAtCoordinates(dot.position.x_co_ dot.position.y_co_ dot.position.z_co_ nearestpoint)_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\ton the _lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#UZGNA%239_qt_ rel_eq__qt_external nofollow_qt__gt_playground_lt_/a_gt_ I get the following error_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_background-color_dd_#c73228_sm_color_dd_#ffffff_sm_font-size_dd_medium_sm__qt__gt_Line 38_dd_22 - Cannot read property _t_getClosestFacetAtCoordinates_t_ of undefined_lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\teven though the intellisense picked it up fine.Â  am I doing something wrong here?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks again.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2018-11-20T20:05:10Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tJust check your code _dd_ the mesh is probably not loaded yet when you call getClosestEtc()\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Bladetrick","Date":"2018-11-20T21:08:07Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tYou_t_re right_co_ Jerome.Â  I rearranged it and got it to load properly_sm_ however_co_ my point (a sphere) is close as heck and it still gives a value of null.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#UZGNA%2313_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#UZGNA#13_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tNot sure what I_t_m doing wrong.Â  I_t_m just trying to cast a ray to the closest facet/point\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Bladetrick","Date":"2018-11-20T21:56:24Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\ti used getClosestFaceAtLocalCoordinates and it works_co_ though the point it came up with is not the closest that I can see.Â  i don_t_t know.Â  I_t_ll do some more reading/testing and let you know my results.Â  Thanks all_co_ for the help/ideas!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Bladetrick","Date":"2018-11-21T18:44:31Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tFrom the links suggested I figured out how things worked_sm_ however_co_ I have another problem on my end.Â  I started a new topic here in case anyone wants to take a looksee_dd_\n_lt_/p_gt_\n_lt_iframe allowfullscreen_eq__qt__qt_ data-controller_eq__qt_core.front.core.autosizeiframe_qt_ data-embedcontent_eq__qt__qt_ data-embedid_eq__qt_embed995868729_qt_ scrolling_eq__qt_no_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/topic/41429-all-meshes-loaded-from-an-obj-file-have-a-position-of-000/?do_eq_embed_qt_ style_eq__qt_height_dd_219px_sm_max-width_dd_502px_sm__qt__gt__lt_/iframe_gt_\n\n_lt_p_gt_\n\tAgain thanks for all the advice up to this point\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]