[{"Owner":"mauri","Date":"2016-04-27T02:44:20Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI am new to this forum and I really love this. I have been playing with babylon.js now for a year and really enjoying the framework. Mostly I have found answers to my problems here or on the playground.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tNow I just can_t_t solve this issue. I have a model which you can upload new picture (.jpq) through web site. I upload the picture to server ( new picture replaces the old one e.g. table1.jpg)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWhat I have been doing is reloading the page after upload. But now I would like to do this without upload. I kind of managed to do this_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_var_lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_ scene _eq_ engine.scenes[0]_sm__lt_/font_gt__lt_/font_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_scene.materials.forEach(_lt_/font_gt__lt_/font_gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_function_lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_ (thematerial) {_lt_/font_gt__lt_/font_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_if_lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_ (_lt_/font_gt__lt_/font_gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_typeof_lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_ (thematerial.diffuseTexture) !_eq_ _lt_/font_gt__lt_/font_gt__lt_font color_eq__qt_#a31515_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#a31515_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#a31515_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__t_undefined_t__lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_) {_lt_/font_gt__lt_/font_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_var_lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_ newfilelocation _eq_ thematerial.diffuseTexture.url_sm__lt_/font_gt__lt_/font_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_thematerial.diffuseTexture.hasAlpha _eq_ _lt_/font_gt__lt_/font_gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_true_lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__sm__lt_/font_gt__lt_/font_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_thematerial.diffuseTexture _eq_ _lt_/font_gt__lt_/font_gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_new_lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_ BABYLON.Texture(newfilelocation_co_ scene_co_ _lt_/font_gt__lt_/font_gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_true_lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__co_ _lt_/font_gt__lt_/font_gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_true_lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__co_ 3_co_ _lt_/font_gt__lt_/font_gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_null_lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__co_ _lt_/font_gt__lt_/font_gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_null_lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__co_ _lt_/font_gt__lt_/font_gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_null_lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__co_ _lt_/font_gt__lt_/font_gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font color_eq__qt_#0000ff_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_true_lt_/font_gt__lt_/font_gt__lt_/font_gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_)_sm__lt_/font_gt__lt_/font_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_}_lt_/font_gt__lt_/font_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_})_sm__lt_/font_gt__lt_/font_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThis reloads materials and I can see result as I want to. But after this I also would like to take a snapshot and upload that picture to server.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_BABYLON.Tools.CreateScreenshot(engine_co_ _lt_/font_gt_scene._lt_font face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt_cameras[0]_co_ { width_dd_ cw_co_ height_dd_ ch })_sm__lt_/font_gt__lt_/font_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI have got this to work put after updating the mesh (materials) the picture materials are all black. Is there a way to avoid this?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI guess this is to do with the last buffer parameter _eq_ true_co_ but this is the only way I have managed to reload the mesh materials?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tScreenshot works fine if I hook it up to button and use it there right after upload and without loading the page...\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tI hope this makes sence _lt_img alt_eq__qt__dd_D_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ title_eq__qt__dd_D_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tMauri\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"RaananW","Date":"2016-04-27T07:48:14Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi Mauri_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tyou will need to wait at least one frame for the textures to actually load. this is why they are black. you could do that in a callback running after the rendering was done_co_ something like this_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_scene.registerAfterRender(function screenshot() {\n  //TAKE SCREENSHOT\n  scene.unregisterAfterRender(screenshot)_sm_\n})_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tSo it will be executed after the scene rendered_co_ and only one time.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAnd sorry_co_ just have to ask - why are you checking if the type of the diffuse texture is !_eq_ undefined? It will be enough to simply check if it exists_co_ using if(material.diffuseTexture) { //do something }\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAnd just a small note - you might want to dispose the old texture before creating a new one. before creating the new texture_co_ call thematerial.diffuseTexture.dispose() to clear up the resources.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"mauri","Date":"2016-04-27T10:04:07Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThanks RaananW !!!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tYou instructions were perfect and I got this to work really nice now. I have been trying this out a lot. I am very happy.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAnd you are also correct about _lt_font color_eq__qt_#a31515_qt_ face_eq__qt_Consolas_qt_ size_eq__qt_2_qt__gt__t_undefined_t_ _lt_/font_gt_It_t_s kind of copy paste / error from my submaterial / material examination.... my bad.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tMauri\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]