[{"Owner":"lesterhaus","Date":"2015-09-01T19:45:57Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hello everyone!_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_First time on the forums and I have a problem with soft/smooth shadows for my scene._lt_/p_gt__lt_p_gt_I have some experience with three.js and am trying out babylon.js for a project since I was not happy with the shadows I could create in three.js_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_In my scene I want to simulate the diurnal motion of the sun - having a few meshes with holes in them (it is a house) which should drop and receive shadows from one light source (the sun)_lt_/p_gt__lt_p_gt_I have all the vector hocus pocus for the sun motion figured out_co_ but up until now I was only able to get very low quality shadows._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Anyways_co_ here is my code and the result as attached screenshots._lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_if (BABYLON.Engine.isSupported()) {\tvar canvas _eq_ document.getElementById(_qt_renderCanvas_qt_)_sm_\tvar engine _eq_ new BABYLON.Engine(canvas_co_ true)_sm_\t\t\t\t\tBABYLON.SceneLoader.Load(_qt_babylonscenes/_qt__co_ _qt_model_001.babylon_qt__co_ engine_co_ function (scene) {\t\t// Wait for textures and shaders to be ready\t\tscene.executeWhenReady(function () {\t\t\t// Attach camera to canvas inputs\t\t\tscene.activeCamera.attachControl(canvas)_sm_\t\t\t\t\t\t\t\t\t\tvar light0 _eq_ new BABYLON.HemisphericLight(_qt_Hemi0_qt__co_ new BABYLON.Vector3(0_co_ 1_co_ 0)_co_ scene)_sm_\t\t\tlight0.intensity _eq_ 0.4_sm_\t\t\t\t\t\t\t\t\t\tvar light1 _eq_ new BABYLON.DirectionalLight(_qt_Dir0_qt__co_ new BABYLON.Vector3(-1_co_ -2_co_ -1)_co_ scene)_sm_\t\t\tlight1.intensity _eq_ 0.7_sm_\t\t\tlight1.position _eq_ new BABYLON.Vector3(0_co_50_co_0)_sm_\t\t\t\t\t\t\t\t\t\tvar shadowGenerator _eq_ new BABYLON.ShadowGenerator(1024_co_ light1)_sm_\t\t\tshadowGenerator.useBlurVarianceShadowMap _eq_ true_sm_\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar meshMaterial _eq_ new BABYLON.StandardMaterial(_qt_material1_qt__co_ scene)_sm_\t\t\tmeshMaterial.diffuseColor _eq_ new BABYLON.Color3(0.5_co_ 0.5_co_ 0.5)_sm_\t\t\t\t\t\tvar torus _eq_ BABYLON.Mesh.CreateTorus(_qt_torus_qt__co_ 5_co_ 1_co_ 10_co_ scene_co_ false)_sm_\t\t\ttorus.position _eq_ new BABYLON.Vector3(20_co_10_co_10)_sm_\t\t\ttorus.material _eq_ meshMaterial_sm_\t\t\ttorus.receiveShadows _eq_ true_sm_\t\t\tshadowGenerator.getShadowMap().renderList.push(torus)_sm_\t\t\t\t\t\tfor(var i _eq_ 0_sm_ i &lt_sm_ scene.meshes.length_sm_ i++){\t\t\t\tscene.meshes[i].receiveShadows _eq_ true_sm_\t\t\t\tshadowGenerator.getShadowMap().renderList.push(scene.meshes[i])_sm_\t\t\t\tscene.meshes[i].material _eq_ meshMaterial_sm_\t\t\t}\t\t\t\t\t\t\t\t\t\t// Once the scene is loaded_co_ just register a render loop to render it\t\t\tengine.runRenderLoop(function() {\t\t\t\tscene.render()_sm_\t\t\t})_sm_\t\t})_sm_\t}_co_ function (progress) {\t\t// To do_dd_ give progress feedback to user\t})_sm_}_lt_/pre_gt__lt_p_gt_The mesh is an Import from an DXF-File_co_ so it could be that the meshes are... not optimal. But even the poor torus I dragged into this doesn_t_t get it any better._lt_/p_gt__lt_p_gt_As far as I understood I cannot use _qt_useBlurVarianceShadowMap_qt_ in my case_co_ since I want to drop and receive shadows at the same time for all meshes._lt_/p_gt__lt_p_gt_Also_co_ for the diurnal motion I need to have the sun to go around my whole scene which gives me_co_ for this scene_co_ a minimum radius of 200. So moving closer with the light source isn_t_t the solution I_t_m looking for._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I_t_ve seen some posts with similar problems which didn_t_t help me to solve my problems_dd__lt_/p_gt__lt_p_gt__lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/topic/16723-soft-shadows/_qt__gt_http_dd_//www.html5gamedevs.com/topic/16723-soft-shadows/_lt_/a_gt_ -&gt_sm_ looks like the same problem_co_ sadly the original poster went off board when the discussion focused on lighting up the shadows._lt_/p_gt__lt_p_gt__lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/topic/9199-weird-shadows/_qt__gt_http_dd_//www.html5gamedevs.com/topic/9199-weird-shadows/_lt_/a_gt_ -&gt_sm_ again_co_ seems to be a similar problem_co_ but I don_t_t see any solution in it other then playing with the lights position_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I also read up on some recent updates for babylon.js which advertised an overworked shadow handling._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_This lead me to this example _lt_a href_eq__qt_http_dd_//www.babylonjs.com/?SOFTSHADOWS_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs.com/?SOFTSHADOWS_lt_/a_gt__lt_/p_gt__lt_p_gt_Maybe someone knows where I could see the source code for this example as I didn_t_t find it in the samples section on github._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Thanks in advance!_lt_/p_gt__lt_p_gt__lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_09_2015/post-16223-0-68932200-1441135939.jpg_qt_ rel_eq__qt_external nofollow_qt__gt__lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_09_2015/post-16223-0-68932200-1441135939_thumb.jpg_qt_ data-fileid_eq__qt_4996_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ alt_eq__qt_post-16223-0-68932200-1441135939_thumb.j_qt__gt__lt_/a_gt__lt_/p_gt__lt_p_gt__lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_09_2015/post-16223-0-20868200-1441135955.jpg_qt_ rel_eq__qt_external nofollow_qt__gt__lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_09_2015/post-16223-0-20868200-1441135955.jpg_qt_ data-fileid_eq__qt_4997_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ alt_eq__qt_post-16223-0-20868200-1441135955.jpg_qt__gt__lt_/a_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2015-09-01T22:17:33Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hello and welcome!_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_here is the source code for the softshadows example_dd__lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Samples/blob/master/Scenes/Customs/softShadows.js_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Samples/blob/master/Scenes/Customs/softShadows.js_lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_In your example_co_ it looks like the resolution of the shadowmap is too small. You can also think about tweking the blurBoxOffset value _lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"lesterhaus","Date":"2015-09-02T09:39:57Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi Deltakosh!_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Thank you for your advice. While increasing the size of the shadowmap might make the blocks at the edges smaller_co_ it only results in a chiseled hard edge for the shadow which still suffers from aliasing steps._lt_/p_gt__lt_p_gt_All this with a huge drop in performance of course. _lt_/p_gt__lt_p_gt_Regarding the blurBoxOffset_co_ I don_t_t think changing this has any effect while using poissonSampling - or does it?_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I have been playing around some more with _lt_span style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_blurVarianceShadowMap - which results in nice smooth shadows but can only be cast on my ground mesh. Is there any other way to achieve some self shadowing for meshes with holes in them?_lt_/span_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt__lt_span style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_In the Hillvalley example_co_ right at the front page of babylon.js_co_ there seem to be houses on the sides which receive and cast shadows at the same time. (for instance the Essex Cinema)_lt_/span_gt__lt_/p_gt__lt_p_gt__lt_span style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_The resulting shadows don_t_t look bad at all. Any idea how it is done in that case? Is there maybe some post processing that can be done to improve the shadows quality?_lt_/span_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2015-09-02T15:43:34Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_I mentioned blurBoxOffset because I saw _qt__lt_span style_eq__qt_color_dd_rgb(0_co_0_co_0)_sm_font-family_dd_monospace_sm_font-size_dd_13px_sm_background-color_dd_rgb(250_co_250_co_250)_sm__qt__gt_shadowGenerator_lt_/span_gt__lt_span style_eq__qt_color_dd_rgb(102_co_102_co_0)_sm_font-family_dd_monospace_sm_font-size_dd_13px_sm_background-color_dd_rgb(250_co_250_co_250)_sm__qt__gt_._lt_/span_gt__lt_span style_eq__qt_color_dd_rgb(0_co_0_co_0)_sm_font-family_dd_monospace_sm_font-size_dd_13px_sm_background-color_dd_rgb(250_co_250_co_250)_sm__qt__gt_useBlurVarianceShadowMap _lt_/span_gt__lt_span style_eq__qt_color_dd_rgb(102_co_102_co_0)_sm_font-family_dd_monospace_sm_font-size_dd_13px_sm_background-color_dd_rgb(250_co_250_co_250)_sm__qt__gt__eq__lt_/span_gt__lt_span style_eq__qt_color_dd_rgb(0_co_0_co_0)_sm_font-family_dd_monospace_sm_font-size_dd_13px_sm_background-color_dd_rgb(250_co_250_co_250)_sm__qt__gt_ _lt_/span_gt__lt_span style_eq__qt_color_dd_rgb(0_co_0_co_136)_sm_font-family_dd_monospace_sm_font-size_dd_13px_sm_background-color_dd_rgb(250_co_250_co_250)_sm__qt__gt_true_lt_/span_gt__lt_span style_eq__qt_color_dd_rgb(102_co_102_co_0)_sm_font-family_dd_monospace_sm_font-size_dd_13px_sm_background-color_dd_rgb(250_co_250_co_250)_sm__qt__gt__sm__qt_ in your code _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/span_gt__lt_/p_gt__lt_p_gt_VSM (variance shadow maps) are not usable if you want self shadowing_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_In Hillvalley_co_ all the shadows were produced offline (with blender_co_ unity or 3dsmax) and are used as regular textures_dd_ This is the best option for performance and quality but obviously the light cannot move or change_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"lesterhaus","Date":"2015-09-02T18:24:24Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_You are absolutely right.. that was a silly mistake by me when copy pasting the code_co_ sorry about that _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt__lt_p_gt_I_t_m going to toy around some more with this then._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Anyways_co_ thank you very much for your patience_co_ I know you have to answer a lot of these questions multiple times._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2015-09-02T19:57:26Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_My pleasure _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Vousk-prod.","Date":"2015-09-06T13:49:49Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi lesterhaus_co__lt_/p_gt__lt_p_gt_can you report here your results and failures/successes after playing with all that stuff. I_t_m sure this will be interesting and usefull for many people._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]