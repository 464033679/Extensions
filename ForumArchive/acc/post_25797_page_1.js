[{"Owner":"mazelpomme","Date":"2016-10-16T18:43:16Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi this topic is related to this one but it_t_s not necessary to read it. \n_lt_/p_gt_\n_lt_iframe data-embedcontent_eq__qt__qt_ frameborder_eq__qt_0_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/topic/25629-rotation-quaternion-mesh-tangent-to-a-sphere/?do_eq_embed_qt__gt__lt_/iframe_gt_\n\n_lt_p_gt_\n\tSo Théo Sabattié and I are trying to make a game in which the player controlls an airplane flying around a planet and is followed by an homing missile.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tTo make the missile chase the player_co_ we use plane _dd_The plane is attached to the missile and the plane normal is the right vector of the missile. If the player is on the right side of the plane the missile rotate to the right (but stays tangent to the sphere) and if the player is on the left side it rotate to the left. This works at the begening but eventually it fails. And we don_t_t get why. Does anyone know why ?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tHere is the playground version _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1XZ4XZ%2325_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1XZ4XZ#25_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2016-10-16T23:59:33Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/22056-mazelpomme/?do_eq_hovercard_qt_ data-mentionid_eq__qt_22056_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/22056-mazelpomme/_qt_ rel_eq__qt__qt__gt_@mazelpomme_lt_/a_gt_ and _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/22148-th%C3%A9o-sabatti%C3%A9/?do_eq_hovercard_qt_ data-mentionid_eq__qt_22148_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/22148-th%C3%A9o-sabatti%C3%A9/_qt_ rel_eq__qt__qt__gt_@Théo Sabattié_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/10310-raananw/?do_eq_hovercard_qt_ data-mentionid_eq__qt_10310_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/10310-raananw/_qt_ rel_eq__qt__qt__gt_@RaananW_lt_/a_gt_ once made... what I call... an orthogonalizer.  Maybe it should be called a perpendicularizer.  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tNot sure if would be of any use to you_co_ but here it is...\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#2C8LVE%2310_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#2C8LVE#10_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tOf course_co_ you would replace the monkey with an invisible cylinder/box... with a missile parented to the top of it.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/5453-jerome/?do_eq_hovercard_qt_ data-mentionid_eq__qt_5453_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/5453-jerome/_qt_ rel_eq__qt__qt__gt_@jerome_lt_/a_gt_ once helped someone make one_co_ too_co_ but I can_t_t find that one.  It was various cylinders placed around a sphere_co_ each perpendicular to the sphere surface.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAnyway_co_ here is _lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/topic/19731-new-getheightatcoordinates-and-getnormalatcoordinates-functions/_qt_ rel_eq__qt__qt__gt_another thread_lt_/a_gt_ with Jerome causing trouble... using ground-following.  Not sure if this helps with your challenge or not.  If you need terrain-following missiles_co_ it should work well.  The missiles should travel over the mountains and into the valleys of the planet_co_ staying beneath radar.  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tOne more Jerome perpendicularizer?  Okay.  _lt_a href_eq__qt_http_dd_//babylonjs-playground.com/#R7ZMI%2310_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//babylonjs-playground.com/#R7ZMI#10_lt_/a_gt_ \n_lt_/p_gt_\n\n_lt_p_gt_\n\tYou guys will still have the issue of _qt_homing_qt_... but these playgrounds and their funcs... might help keep your missiles parallel to the planet surface at all times.  But maybe you have that handled_co_ already.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"mazelpomme","Date":"2016-10-17T19:30:07Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_h3_gt_\n\t \n_lt_/h3_gt_\n\n_lt_p lang_eq__qt_en-us_qt_ style_eq__qt_margin-bottom_dd_0cm_sm__qt_ xml_dd_lang_eq__qt_en-us_qt__gt_\n\tThanks for the quick reply _lt_span_gt_@Wingnut. _lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p lang_eq__qt_en-us_qt_ style_eq__qt_margin-bottom_dd_0cm_sm__qt_ xml_dd_lang_eq__qt_en-us_qt__gt_\n\tYou guessed right the missile being parallel to the planet surface at all times part is already handled_dd_\n_lt_/p_gt_\n\n_lt_p lang_eq__qt_en-us_qt_ style_eq__qt_margin-bottom_dd_0cm_sm__qt_ xml_dd_lang_eq__qt_en-us_qt__gt_\n\tThe missile is parented to a pivot (empty mesh) which is positionned at the center of the sphere. To make the missile move we make the pivot rotate around the the missile right vector (which we get using calcMovePOV(1_co_0_co_0)) So the missile always move towards his nose cone.\n_lt_/p_gt_\n\n_lt_p lang_eq__qt_en-us_qt_ style_eq__qt_margin-bottom_dd_0cm_sm__qt_ xml_dd_lang_eq__qt_en-us_qt__gt_\n\tThe real problem here is to get the missile following the player. The method we used is the following _dd_ we calculate the dot product between the right vector of the missile and the vector between the player and the missile. If the dot product is positive the missile rotation.y is decremented if not it_t_s incremented. Here is the code sample (line 78 in the playground that I linked)_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_missilePivot.rotate(missileTransform.calcMovePOV(1_co_ 0_co_ 0)_co_ 0.01)_sm_\n\t\t\ndotProduct _eq_ BABYLON.Vector3.Dot(missileTransform.calcMovePOV(1_co_ 0_co_ 0)_co_ missileTransform.getAbsolutePosition().subtract(playerTransform.getAbsolutePosition()))_sm_\nif (dotProduct &gt_sm_ 0) {\n\tmissileTransform.rotation.y -_eq_ 0.05_sm_\n} else {\n\tmissileTransform.rotation.y +_eq_ 0.05_sm_\n}_lt_/code_gt__lt_/pre_gt_\n\n_lt_p lang_eq__qt_en-us_qt_ style_eq__qt_margin-bottom_dd_0cm_sm__qt_ xml_dd_lang_eq__qt_en-us_qt__gt_\n\tBut this only works at the begining and we don_t_t get why... Is the math method wrong ? Did we missunderstood the method calcMovePov ?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t\t\t\n\n_lt_span class_eq__t_ipsType_reset ipsType_medium ipsType_light_t_ data-excludequote_gt_\n\t_lt_strong_gt_Edited _lt_time datetime_eq__t_2016-10-17T21_dd_50_dd_05Z_t_ title_eq__t_10/17/2016 09_dd_50  PM_t_ data-short_eq__t_2 yr_t__gt_October 17_co_ 2016_lt_/time_gt_ by mazelpomme_lt_/strong_gt_\n\t\n\t\t_lt_br_gt_wrong statement\n\t\n\t\n_lt_/span_gt_\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"mazelpomme","Date":"2016-10-20T23:54:50Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_h3_gt_\n\t Problem solved ! \n_lt_/h3_gt_\n\n_lt_p_gt_\n\tSeems like _lt_span style_eq__qt_color_dd_rgb(248_co_248_co_242)_sm_font-family_dd_monospace_co_ monospace_sm_font-size_dd_14px_sm_font-style_dd_normal_sm_font-weight_dd_normal_sm_letter-spacing_dd_normal_sm_text-indent_dd_0px_sm_text-transform_dd_none_sm_white-space_dd_pre_sm_word-spacing_dd_0px_sm_background-color_dd_rgb(35_co_36_co_31)_sm_float_dd_none_sm__qt__gt_missileTransform.calcMovePOV(1_co_ 0_co_ 0)_lt_/span_gt_ didn_t_t give us the right right vector_co_ so the dot product was wrong. \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]