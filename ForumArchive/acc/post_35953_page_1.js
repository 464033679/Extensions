[{"Owner":"Snouto","Date":"2018-02-26T01:51:41Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\they internet dudes\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSo yeah_co_ still working on this scene_co_ although lately i_t_ve been on a different project so haven_t_t been look at my issues with babylon for a little while.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI_t_ve got this test scene set up here_sm_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//snou.to/tests/babylonjs/animation/test4/_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//snou.to/tests/babylonjs/animation/test4/_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tFrom inspecting the html you_t_ll see my super fantastic javascript code that is animating the helicopter (amongst other things).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSome questions for the experts out there_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t1) the helicopter has a brain fart at around 9 o_t_clock on the circular path it is following. Any idea why? It also has a very minor _qt_course correction_qt_ at 3 o_t_clock. No idea why_co_ is it my maths at fault here or something more fundamental?_lt_br /_gt_\n\t2) if you click on the helicopter it does a little animation. Intention here was to blend the animations so that the user can interact with the object in a simple manner. Fundamentally it_t_s working_co_ but you_t_ll notice the spin and bounce animations don_t_t end exactly where the circular path is_co_ and so often the helicopter _qt_snaps_qt_ back in to position of the initial animation. This is probably a stupid question given the specifics of what i_t_m trying to do here but is there some technique I can use to ensure the end frame of the blended animation always ends perfectly so that the motion blends in to the original animation without snapping? Right now I_t_m having to hard code specific frame lengths and speeds and it_t_s imprecise and a PITA_co_ so I feel like there_t_s got to be a better approach. My maths skills are awful though so if anyone can help that would be sweet.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tCheers!\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"FunFetched","Date":"2018-02-26T02:52:19Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tJust a guess after a quick look at the code_co_ but I_t_m guessing that the very last point on your path is missing proper tangent information_co_ since it would have no additional points from which to calculate a tangent. Have you tried playing only 29 frames of the animation instead of 30?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Snouto","Date":"2018-02-26T03:07:08Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\thi thanks for the reply. You suggestion would make sense if the quirk was happening at the start/end of the path but it appears to occur half a way around. Unless you_t_re referring to the _qt_course correction_qt_ issue_co_ which makes more sense?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Snouto","Date":"2018-02-26T03:48:22Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tOk I_t_ve put this in to a PG so peeps can take a look and better understand the dillio\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#RVA3F4%232_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#RVA3F4#2_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"FunFetched","Date":"2018-02-26T18:00:48Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tAh! The Playground does help. Check out _lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#RVA3F4%233_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#RVA3F4#3_lt_/a_gt_ . The issue with the glitch in the middle is that you were using Euler rotation instead of Quaternion. Euler sometimes doesn_t_t handle full rotations very gracefully_co_ flipping around madly when the sign of the angle flips_sm_ that is_co_ jumping from PI/2 to -PI/2 from one frame to the next as it passes the half way point. Quaternion_co_ on the other hand.... well.... it just does handle that situation_co_ but I couldn_t_t possibly explain why. _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAs for the spin_co_ you_t_re blending two animations together that share the same mesh. So_co_ say we_t_re at the halfway point again_co_ and you_t_re facing 180 degrees the opposite direction. You want the spin to end at 180 degrees_co_ but the spin animation wants to start and end at 0. These are two separate animations_co_ and the spin animation doesn_t_t inherit anything from the orbit animation.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWhat you_t_ll want to do here is actually create an empty AbstractMesh to contain the helicopter. Apply the orbit animation to this AbstractMesh_co_ and apply the spin animation to the helicopter mesh directly. That way_co_ your spin animation will affect the local coordinates and orientation of the helicopter mesh only_co_ while the global position and orientation will be controlled by the orbiting animation that controls its parent.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"FunFetched","Date":"2018-02-26T18:18:00Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tCheck out _lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#RVA3F4%234_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#RVA3F4#4_lt_/a_gt_. This mostly implements what I_t_m talking about in regard to the AbstractMesh. It_t_s mostly working at this point. The spin animation is off by 90 degrees_co_ but you_t_ll see that it now behaves in a consistent manner when you click on it. Note that I reset the position of the helicopter mesh itself to 0_co_ so that it would be positioned in the middle of the container.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Snouto","Date":"2018-02-26T23:47:49Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHey thanks for that _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/27284-funfetched/?do_eq_hovercard_qt_ data-mentionid_eq__qt_27284_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/27284-funfetched/_qt_ rel_eq__qt__qt__gt_@FunFetched_lt_/a_gt_I really appreciate the time you put in to helping me with my issue.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe rotation issue certainly appears to be much better now than it was before - there_t_s still a slight course correction going from the end to start frame_co_ but maybe i can do something there along the lines of the previous advice you_t_ve given.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe bump and spin issues makes sense as well_co_ although one of the challenges with this animation has been to ensure the helicopter is always facing the direction of travel. With this new scene of course the helicopter _container_ is always facing the right direction_co_ but as soon as the chopper spins - since that is inside the parent - there_t_s nothing to ensure it ends the animation pointing in the correct direction.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI_t_ll take a closer look at your PG and see if I can figure it out. Thanks again for your help _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"FunFetched","Date":"2018-02-26T23:59:28Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tNo problem! You_t_ll notice that every time you trigger the spin animation_co_ it always ends facing inward_co_ so it _lt_em_gt_is_lt_/em_gt_ actually following the direction of travel_co_ in a manner of speaking. It just needs to be turned 90 degrees.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Snouto","Date":"2018-02-27T00:10:59Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_206262_qt_ data-ipsquote-contentid_eq__qt_35953_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1519689568_qt_ data-ipsquote-userid_eq__qt_27284_qt_ data-ipsquote-username_eq__qt_FunFetched_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t12 minutes ago_co_ FunFetched said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tNo problem! You_t_ll notice that every time you trigger the spin animation_co_ it always ends facing inward_co_ so it _lt_em_gt_is_lt_/em_gt_ actually following the direction of travel_co_ in a manner of speaking. It just needs to be turned 90 degrees.\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tThe issue with that is the animation starts pointing in the correct direction_co_ but ends in the wrong direction_co_ which to my mind means I have to very carefully tweak the rotation logic (speed_co_ number frames etc) to ensure it always fires enough frames to ensure it ends where it starts. This is still a PITA for me_co_ assuming I_t_m thinking about this correctly.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tPerhaps I should reintroduce something like TweenMax to simply give it a start and end position and tell it to tween the animation for all frames in-between. That the helicopter is now parented means I probably just need to ensure the animation always starts and ends at local Z (0)_co_ and it_t_ll always be pointing in the correct direction thanks to that logic being in the parent mesh quaternion rotation logic.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"FunFetched","Date":"2018-02-27T00:17:22Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_206264_qt_ data-ipsquote-contentid_eq__qt_35953_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1519690259_qt_ data-ipsquote-userid_eq__qt_29888_qt_ data-ipsquote-username_eq__qt_Snouto_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t6 minutes ago_co_ Snouto said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tThat the helicopter is now parented means I probably just need to ensure the animation always starts and ends at local Z (0)_co_ and it_t_ll always be pointing in the correct direction thanks to that logic being in the parent mesh quaternion rotation logic.\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tYep_sm_ that!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Snouto","Date":"2018-03-02T08:13:44Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI haven_t_t yet figured this out as i_t_ve been focused on other areas_co_ but i_t_ll mark as solved because moving to quats solved the glitch issue. Thanks again _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/27284-funfetched/?do_eq_hovercard_qt_ data-mentionid_eq__qt_27284_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/27284-funfetched/_qt_ rel_eq__qt__qt__gt_@FunFetched_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]