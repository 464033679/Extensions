[{"Owner":"robhawkes","Date":"2018-10-04T18:57:38Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHello_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI_t_m trying to get my head around shadows in Babylon and need some help.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWhat I_t_m trying to achieve is something that gives me high quality shadows throughout an infinite world. Specifically_co_ I_t_m making a 3D geospatial visualisation using Babylon (think Google Maps but in Babylon) so the user can effectively scroll / move around forever. What I_t_m struggling with is getting a shadow system set up that can output nice crisp shadows regardless of where the user / camera moves to.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWhat I_t_m looking for_dd_\n_lt_/p_gt_\n\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\tSingle directional light that can dynamically change direction (replicating the sun -- I can solve this separate to this)\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tCrisp shadows on what could be thousands of objects in view (buildings in a city_co_ as seen from above)\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tShadows are always visible to the user_co_ regardless of where the camera moves to / which new objects come into view\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tPerformance\n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n_lt_p_gt_\n\tI_t_ve been digging through the forum and plugging away at it all afternoon and evening and just can_t_t seem to get things working as I want_co_ so I was hoping someone had a better idea that might help.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHere_t_s the playground link for what I have so far_dd_ _lt_a href_eq__qt_https_dd_//playground.babylonjs.com/#SX3GXQ%236_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//playground.babylonjs.com/#SX3GXQ#6_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWhat I_t_ve tried (amongst many other things)_dd_\n_lt_/p_gt_\n\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\tLinking the light position with the camera position\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tHigher resolution shadow map\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tFiddling with light.shadowFrustumSize\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\t_lt_span style_eq__qt_color_dd_#000000_sm__qt__gt_Shrinking the scale of the scene_lt_/span_gt_\n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_color_dd_#000000_sm__qt__gt_What I have currently is sort of what I_t_m after but the performance is bad (esp. when you zoom out) and the shadows are pixellated and seem to flicker as the camera is rotated. Also_co_ some of the shadows seem to disappear when the camera is rotated too. My understanding of shadows is limited so I_t_m clearly doing a few things wrong._lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_color_dd_#000000_sm__qt__gt_I_t_m currently scratching my head at a loss for what to try next so hoping someone can help!_lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_color_dd_#000000_sm__qt__gt_Thanks_co__lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_color_dd_#000000_sm__qt__gt_Robin_lt_/span_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-10-04T22:06:17Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHello!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThis could have been fixed with Cascaded shadows but this is not YET supported by Babylon.js (wink! wink! _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/20193-sebavan/?do_eq_hovercard_qt_ data-mentionid_eq__qt_20193_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/20193-sebavan/_qt_ rel_eq__qt__qt__gt_@Sebavan_lt_/a_gt_)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIn the meantime here is a good read (if you did not already)_dd_ _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/babylon101/shadows#troubleshooting_qt_ ipsnoembed_eq__qt_true_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/babylon101/shadows#troubleshooting_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tUsing spector.s on your PG you can see that the light is not at the right position. The trick is to make sure that the light can see all the objects and is closer as possible to make sure we have the maximum precision\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"robhawkes","Date":"2018-10-05T14:16:30Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tAh I see! That_t_s not the first time I_t_ve heard about cascaded shadows. When you say it_t_s not supported yet_co_ do you mean that it_t_s something in the works? Or should it be something I shouldn_t_t expect from Babylon for some time? I ask because I need to make a decision on what framework to use and I_t_m desperate to find one that can provide the nicest shadows. Three.js removed support for cascaded shadows_co_ which is a shame. If I know that it_t_s something I shouldn_t_t expect then that helps me.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI_t_ve been reading through the shadow troubleshooting guide and that_t_s been helping somewhat_co_ thanks. That_t_s basically how I got to where I am now.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIn regards to Spector. How do I use it to see that the light isn_t_t at the right position? I assumed that by linking it to the camera it would help by not creating shadows further from the camera but perhaps I_t_ve misunderstood that. For what it_t_s worth_co_ the shadows need to stay at the same direction even though the light is moving with the camera.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tConsidering cascaded shadows aren_t_t a thing yet_co_ do you have any other advice for ensuring performant and high-quality shadows on a dynamic scene like this? I_t_m only fussed about shadows being around the (moving) camera to a certain point_co_ it_t_s OK if there are no shadows further into the distance so long as the shadows around the camera are decent.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-10-05T16:51:54Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tWe have an open issue (_lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/issues/1818_qt_ ipsnoembed_eq__qt_true_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/issues/1818_lt_/a_gt_) but we are not working on it now\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSpector.js will show you the content of the shadow so you can position the light the closer possible.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tTo your last question_dd_ \n_lt_/p_gt_\n\n_lt_p_gt_\n\t* You can consider playing with shadowcaster list to only keep the local meshes\n_lt_/p_gt_\n\n_lt_p_gt_\n\t* You can use several lights (and limit the affected meshes with addIncludedMeshOnly ) \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]