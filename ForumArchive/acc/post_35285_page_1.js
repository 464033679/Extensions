[{"Owner":"Art Vandelay","Date":"2018-01-25T15:58:30Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIm pretty confused _lt_img alt_eq__qt__dd_blink_dd__qt_ data-emoticon_eq__qt__qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_blink.png_qt_ title_eq__qt__dd_blink_dd__qt_ /_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIn the attached playground I create a sphere at (0_co_0_co_0). Then I change the pivot point to (0_co_-5_co_0) (the bottom of the sphere). At this point the absolute position of the sphere is still (0_co_0_co_0). However_co_ when do setAbsolutePosition(0_co_0_co_0) I would expect no change. But the absolute position changes to (0_co_5_co_0). Why is this happening?\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//playground.babylonjs.com/#RTE4BS%236_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//playground.babylonjs.com/#RTE4BS#6_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JohnK","Date":"2018-01-25T18:00:37Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tTricky things pivots_co_ this might be worth a read _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/how_to/pivots_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/how_to/pivots_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSetting the pivot point to (0_co_ -5_co_ 0) is achieved (under the bonnet by all the following) by translating the sphere by (0_co_ 5_co_ 0) so the pivot point is now at the bottom of the sphere and becomes the local origin of the sphere ie is locally (0_co_ 0_co_ 0) for the sphere. However at this stage the sphere would be sitting on the ground. To move it to its starting point a translation in world space of (0_co_ -5_co_ 0) is needed. Of course the local origin of the sphere (or pivot) moves with the sphere and is still the local origin of the sphere and the sphere_t_s position remains (0_co_ 0_co_ 0) locally.  In world space the coordinates of the local origin of the sphere are (0_co_ -5_co_ 0) and so absolute position is given as (0_co_ -5_co_ 0) as in label 2.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAt the final stage you are resetting the absolute coordinates from (0_co_ -5_co_ 0)  to (0_co_ 0_co_ 0) which is a translation of (0_co_ 5_co_ 0) giving its absolute position as (0_co_ 0_co_ 0) but of course this translation has to be also applied to the local origin of the sphere moving it from (0_co_ 0_co_ 0) to (0_co_ 5_co_ 0) giving the results as in label 3.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"adam","Date":"2018-01-25T20:37:34Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThat looks like a bug.  Either getAbsolutePosition should be taking the pivot matrix into consideration or setAbsolutePosition should be ignoring the pivot matrix.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHere I used the inverted pivotMatrix to update the absolute position_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//playground.babylonjs.com/#RTE4BS%237_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//playground.babylonjs.com/#RTE4BS#7_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-01-25T22:35:05Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tAgree _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4289-adam/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4289_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4289-adam/_qt_ rel_eq__qt__qt__gt_@adam_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tDo you want to tackle it?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"adam","Date":"2018-01-25T22:44:56Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tsure\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-01-25T22:47:49Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThanks mate!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Art Vandelay","Date":"2018-01-26T14:05:11Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThanks Adam_co_ glad I brought it up then _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_ Would be happy to know when the issue is fixed.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAlso_co_ out of curiosity_co_ which option do you think makes more sense_co_ changing getAbsolutePosition or setAbsolutePosition?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"adam","Date":"2018-01-26T15:10:31Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI went with getAbsolutePosition_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/pull/3631_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/pull/3631_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"satguru","Date":"2018-01-26T23:01:04Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tglad this is getting fixed._lt_br /_gt_\n\thad me confused too sometime back\n_lt_/p_gt_\n_lt_iframe allowfullscreen_eq__qt__qt_ data-controller_eq__qt_core.front.core.autosizeiframe_qt_ data-embedcontent_eq__qt__qt_ data-embedid_eq__qt_embed2796004129_qt_ scrolling_eq__qt_no_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/topic/30412-how-do-i-change-the-center-of-merged-meshes/?tab_eq_comments&amp_sm_do_eq_embed&amp_sm_comment_eq_174558&amp_sm_embedComment_eq_174558&amp_sm_embedDo_eq_findComment#comment-174558_qt_ style_eq__qt_height_dd_281px_sm_max-width_dd_502px_sm__qt__gt__lt_/iframe_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-01-29T18:57:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tSo I had to change the fix  bit to not break existing code. But this should be transparent for you (the setPivotPoint behavior should be fixed directly)\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/14282-johnk/?do_eq_hovercard_qt_ data-mentionid_eq__qt_14282_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/14282-johnk/_qt_ rel_eq__qt__qt__gt_@JohnK_lt_/a_gt_ would you mind adding some word about the setPivotMatrix function new parameter? You can now specifiy a boolean as 2nd parameter (false by default). If set to true_co_ the pivotMatrix will ONLY move the pivot and not act as a transformMatrix also. This should be the default behavior but I can force it because of back compat\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks _lt_img alt_eq__qt__dd_D_qt_ data-emoticon_eq__qt_1_qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ title_eq__qt__dd_D_qt_ width_eq__qt_20_qt__gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JohnK","Date":"2018-01-29T20:22:45Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_202913_qt_ data-ipsquote-contentid_eq__qt_35285_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1517252259_qt_ data-ipsquote-userid_eq__qt_4442_qt_ data-ipsquote-username_eq__qt_Deltakosh_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t1 hour ago_co_ Deltakosh said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/14282-johnk/?do_eq_hovercard_qt_ data-mentionid_eq__qt_14282_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/14282-johnk/_qt_ rel_eq__qt__qt__gt_@JohnK_lt_/a_gt_ would you mind adding some word about the setPivotMatrix function new parameter?\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tWill do _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-01-29T20:58:47Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tACtually it could be more than that_dd_\n_lt_/p_gt_\n_lt_iframe allowfullscreen_eq__qt__qt_ class_eq__qt_ipsEmbed_finishedLoading_qt_ data-controller_eq__qt_core.front.core.autosizeiframe_qt_ data-embedcontent_eq__qt__qt_ data-embedid_eq__qt_embed5095783976_qt_ scrolling_eq__qt_no_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/topic/35354-setpivotmatrix-setpretransformmatrix/?do_eq_embed_qt_ style_eq__qt_overflow_dd_ hidden_sm__qt__gt__lt_/iframe_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JohnK","Date":"2018-01-30T11:30:45Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_202937_qt_ data-ipsquote-contentid_eq__qt_35285_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1517259527_qt_ data-ipsquote-userid_eq__qt_4442_qt_ data-ipsquote-username_eq__qt_Deltakosh_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t13 hours ago_co_ Deltakosh said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tACtually it could be more than that_dd_\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tIt could perhaps be even more? In starting to re-write the documentation and the PG examples examples that go with it I came across a situation where a further decision needs to be considered.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI will follow the issue with the reason for it.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_strong_gt_Issue_lt_/strong_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tUnder the breaking change where only the pivot is changed I would expect the following to apply _dd_-\n_lt_/p_gt_\n\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\tA box having width 8_co_ height 4 and depth 2 and origin at (0_co_ 0_co_ 0) is to have a pivot set at its right front lower corner (4_co_ -2_co_ -1)\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tThe pivot need to be translated (4_co_ -2_co_ -1) so set the matrix M for this translation.\n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n_lt_p_gt_\n\thowever\n_lt_/p_gt_\n\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\tBox.setPivotMatrix(M)  places the pivot at (-4_co_ 2_co_ 1)\n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n_lt_p_gt_\n\tYou can see this in the PG _lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#AGXDE%2320_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#AGXDE#20_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSo to place the pivot at (4_co_ -2_co_ -1) requires M to be set using the negative translation (-4_co_ 2_co_ 1) as seen in the PG _lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#AGXDE%2321_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#AGXDE#21_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_u_gt_Decision_lt_/u_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tPossibilities\n_lt_/p_gt_\n\n_lt_ol_gt_\n\t_lt_li_gt_\n\t\tleave the function setPivotMatrix alone and ensure the documentation clearly states that that the matrix needs to use the inverse translation_sm_\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tchange the function setPivotMatrix to work with the actual translation_co_ if so the function setPivotPoint (and possibly getPivotPoint and getAbsolutePivotPoint) would need changing_sm_\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tsomething I haven_t_t thought of.\n\t_lt_/li_gt_\n_lt_/ol_gt_\n\n_lt_p_gt_\n\t_lt_strong_gt_Reasons_lt_/strong_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe original function moved the mesh and so_co_ as in the given example_co_ to place the pivot at the right front lower corner required the translation of the box to be in the opposite direction -\n_lt_/p_gt_\n\n_lt_p_gt_\n\tsee PG using stable version _lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/indexstable#AGXDE%2322_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/indexstable#AGXDE#22_lt_/a_gt_  before translating the box back to its original position. The function setPivotMatrix still follows this procedure.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-01-30T23:10:40Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI would say 1 as I do not want to change things too much (I already did too much for the sake of the backward compatibility)\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]