[{"Owner":"yuccai","Date":"2017-03-23T10:28:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI would like to understand a strange behavior of my camera and how to prevent it. Let me explain.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI have a mesh that I like to see from different point of views with an ArcRotateCamera. If collisions are enabled_co_ if the camera move from viewpoint1 to viewpoint2 and the translation between these 2 points intersects the mesh_co_ the new camera position is not the expected one. If collisions are disabled_co_ it works. If the translation doesn_t_t intersect the mesh_co_ it also works.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHere is a _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1XDIJF%233_qt_ rel_eq__qt_external nofollow_qt__gt_PG_lt_/a_gt_ to illustrate my issue _dd_\n_lt_/p_gt_\n\n_lt_ul_gt__lt_li_gt_\n\t\tyou can change viewpoints by pressing keys  _t_1_t__co_ _t_2_t__co_ _t_3_t__co_ _t_4_t__co_ _t_5_t_ or _t_6_t_ to see respectively the cube from front_co_ left_co_ back_co_ right_co_ top or bottom viewpoint\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tyou can toggle collision by pressing _t_c_t_ \n\t_lt_/li_gt_\n_lt_/ul_gt__lt_p_gt_\n\tIf collisions are enabled_co_ my issue happens when _dd_\n_lt_/p_gt_\n\n_lt_ul_gt__lt_li_gt_\n\t\tswitching from opposite viewpoints (1 -&gt_sm_ 3_co_ 2 -&gt_sm_ 4_co_ 5 -&gt_sm_ 6)_co_ you obviously intersect the cube\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tif you are close enough of the cube_co_ moving to any viewpoint will intersect the cube and pressing consecutively the same key will not have the same result until the camera is not in the intended position\n\t_lt_/li_gt_\n_lt_/ul_gt__lt_p_gt_\n\tIf collisions are disabled_co_ camera_t_s behavior is the expected one.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI don_t_t know why my camera moves like this. I assume that the camera is not teleported from a viewpoint to another but it is translated which implies a collision with my mesh.  Can it be fix in Babylon.js ? Do I misuse the library ? How can I prevent this behavior ? I succeed to avoid it but I have to use window.setTimeout twice to disable collisions_co_ then move my camera and enable collisions.\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_    function setViewpoint(viewpoint) {\n        camera.checkCollisions _eq_ false_sm_\n        window.setTimeout(function() {\n            camera.alpha _eq_ viewpoint.alpha_sm_\n            camera.beta _eq_ viewpoint.beta_sm_\n            window.setTimeout(function() {\n                camera.checkCollisions _eq_ true_sm_\n            }_co_ 100)_sm_\n        }_co_ 100)_sm_\n    }_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tIt is a bit tricky and I_t_d like to find another way to do it.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2017-03-23T11:06:38Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/9254-yuccai/?do_eq_hovercard_qt_ data-mentionid_eq__qt_9254_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/9254-yuccai/_qt_ rel_eq__qt__qt__gt_@yuccai_lt_/a_gt__co_ good to see you again.  _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1XDIJF%234_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1XDIJF#4_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tFirst_co_ you had a split code-line around line 38... maybe no big deal.  The seemingly important changes happened in your setViewpoint() where I added camera.checkCollision toggling AND some scene.render()_t_s.  What the heck_co_ it started working... but I_t_m not sure why. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tA famous adage_dd_  Even a blind squirrel (Wingnut) finds an occasional acorn (a lucky fix).  heh\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe reason I thought that a scene.render() or camera.update() was needed... was because of your DUAL (nested) setTimeout.  That got me thinkin_t_ (which usually just makes me need more coffee_co_ but not THIS time)  _lt_img alt_eq__qt__dd_D_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ title_eq__qt__dd_D_qt_ width_eq__qt_20_qt_ /_gt_  Hope this helps.  Lines 54 and 55 might need to swap order.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWe should probably study this_co_ because this solve is rather kludgy_co_ eh?  Perhaps unavoidable.  Hopefully_co_ smarter people than I... will reply.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tPS_dd_  I don_t_t think there is a camera.update().  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_  We had a similar thing with gravity on ELEVATED cameras.  The camera wouldn_t_t start dropping when the scene finished loading (it needed a cursor keypress first).  Then one day_co_ somebody pointed-out... _lt_em_gt_camera. _needMoveForGravity_lt_/em_gt_ ... a non-public boolean property (available on SOME cameras).  Setting that true...  made the camera fall when sceneReady.  Wild_co_ huh?  I bet you didn_t_t expect an exciting story like that... as a little tag-on gift (snore).  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"yuccai","Date":"2017-03-23T13:23:29Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThanks for this fast answer. I_t_m glad your solution is working even if it_t_s still tricky. I_t_ll use it temporarily.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI think that this behavior is not expected and Babylon need a fix. What_t_s your point of view _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_ ?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tFrom the few I know_co_ the camera position is correct before _lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Cameras/babylon.arcRotateCamera.ts#L474_qt_ rel_eq__qt_external nofollow_qt__gt_this line_lt_/a_gt_. The new position is computed _lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Collisions/babylon.collisionCoordinator.ts#L350_qt_ rel_eq__qt_external nofollow_qt__gt_here_lt_/a_gt_ and especially _lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Collisions/babylon.collisionCoordinator.ts#L380_qt_ rel_eq__qt_external nofollow_qt__gt_here_lt_/a_gt_. Then it becomes more complicated_co_ it mainly uses Collider class.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]