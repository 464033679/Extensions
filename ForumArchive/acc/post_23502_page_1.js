[{"Owner":"valepu","Date":"2016-06-29T09:49:17Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tAs you can see in this playground _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#HKEPK%231_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#HKEPK#1_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIf i put a mesh with an actionManager behind a particle generated using a Solid Particle System i can click on the meshes behind. (There_t_s a sphere behind the panel and it_t_s pickable_co_ if you move the mouse on the panel you will trigger the spere_t_s actions)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIs this intended? Is there some way to prevent it?\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_strong_gt_EDIT_dd_ _lt_/strong_gt_I have realized it_t_s not just SPS but any mesh will let you pick meshes behind_co_ how do you prevent this?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-06-29T13:17:30Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tI guess that if your SPS isn_t_t pickable_co_ like any other mesh_co_ (SPS is NOT pickable by default)  it_t_s _qt_transparent_qt_ in terms of pickability. So the first picked mesh is the one behind the SPS.\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"valepu","Date":"2016-06-29T14:18:30Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThis is embarassing but...\n_lt_/p_gt_\n\n_lt_p_gt_\n\tFor performance reasons i have turned my scene into an SPS (which was composed of 900 cubes_co_ now it runs smoothly!) _co_ each with a pickable panel on top so that they use the same actionManager as the cubes used to have. I didn_t_t realize it was possible to pick meshes behind unpickable meshes because in my previous scene the whole cube was pickable so i couldn_t_t pick cubes behind it.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAnyways_co_ i see i don_t_t just have to set the SPS as pickable but i have to set an action through scene.onPointerDown to prevent picking meshes behind _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#HKEPK%232_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#HKEPK#2_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tOh by the way i have noticed an error in the SPS documentation_co_ in the example code for picking a particle the variable is _qt_meshFaceId_qt_ on a line and _qt_faceId_qt_ on the line after _lt_a href_eq__qt_https_dd_//doc.babylonjs.com/overviews/Solid_Particle_System_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//doc.babylonjs.com/overviews/Solid_Particle_System_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSo the question now is....What_t_s the easiest way to prevent picking meshes behind a mesh (for example if there_t_s an object behind a door)?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"adam","Date":"2016-06-29T15:40:00Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tOne thing you could do is not dispose the cubes_co_ but set their visibility to 0 and then whenever you update the position/rotation of an SPS cube_co_ do the same for the corresponding invisible cube.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#HKEPK%233_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#HKEPK#3_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"adam","Date":"2016-06-29T15:42:43Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tAlso note_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tscene.constantlyUpdateMeshUnderPointer _eq_ true_sm_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"valepu","Date":"2016-06-29T18:15:52Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_134469_qt_ data-ipsquote-contentid_eq__qt_23502_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1467214800_qt_ data-ipsquote-userid_eq__qt_4289_qt_ data-ipsquote-username_eq__qt_adam_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t2 hours ago_co_ adam said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tOne thing you could do is not dispose the cubes_co_ but set their visibility to 0 and then whenever you update the position/rotation of an SPS cube_co_ do the same for the corresponding invisible cube.\n\t\t_lt_/p_gt_\n\n\t\t_lt_p_gt_\n\t\t\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#HKEPK%233_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#HKEPK#3_lt_/a_gt_\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tWouldn_t_t this affect performance even though they are not rendered?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIf i set an SPS as Pickable (without actions) and use scene.constantlyUpdateMeshUnderPointer _eq_ true_sm_ something weird happens_dd_ the mesh behind is picked only on certain points (like just slightly below the top edge of the square)\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#HKEPK%234_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#HKEPK#4_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"adam","Date":"2016-06-29T18:43:12Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_134491_qt_ data-ipsquote-contentid_eq__qt_23502_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1467224152_qt_ data-ipsquote-userid_eq__qt_16238_qt_ data-ipsquote-username_eq__qt_valepu_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t26 minutes ago_co_ valepu said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tWouldn_t_t this affect performance even though they are not rendered?\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tIt shouldn_t_t be as bad as not using SPS.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-06-29T18:51:03Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tif your SPS doesn_t_t need to be updated each frame (say_co_ the particle positions_co_ rotations_co_ colors_co_ etc don_t_t change)_co_ no need for calling _lt_em_gt_setParticles() _lt_/em_gt_each time in the render loop.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tMaybe didn_t_t you also force the SPS bounding box to be recomputed at least once after adding the particles (what are all at the local origin when the SPS mesh is built) ? This may have significant effects on the pickability behavior or pickability area\n_lt_/p_gt_\n\n_lt_p_gt_\n\tPlease have a read at this explanation _dd_ _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/overviews/Solid_Particle_System#sps-visibility_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/overviews/Solid_Particle_System#sps-visibility_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe simplest way is to call once _lt_em_gt_refreshVisibleSize()_lt_/em_gt_ after the first call to _lt_em_gt_setParticles()_lt_/em_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThis should solve most of your SPS pickability issues\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"valepu","Date":"2016-07-02T07:13:29Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThanks_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI solved by doing this_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t1. add scene.constantlyUpdateMeshUnderPointer _eq_ true_sm_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t2. set the SPS as pickable (even without any action)\n_lt_/p_gt_\n\n_lt_p_gt_\n\t3. remove setParticles() from the render loop\n_lt_/p_gt_\n\n_lt_p_gt_\n\t4. Call refreshVisibleSize() after setParticles()\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#HKEPK%235_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#HKEPK#5_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]