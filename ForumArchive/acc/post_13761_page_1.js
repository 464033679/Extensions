[{"Owner":"CodeIain","Date":"2015-04-10T11:33:38Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi am new to Babylon.js and am totaly loving it._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I have followed this _lt_a href_eq__qt_http_dd_//pixelcodr.com/tutos/shooter/shooter.html_qt_ rel_eq__qt_external nofollow_qt__gt_tutorial_lt_/a_gt__co_ to build a FPS_co_ but when I try and change the ground to a height map and apply gravity this drops my framerate to about 2 FPS when I try and move the Camera._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_It I turn the gravity off the game runs at 60 FPS._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Could anyone point me in the right direction for using Gravity with a height map._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_My code can be found _lt_a href_eq__qt_http_dd_//codeiainmmo.azurewebsites.net/_qt_ rel_eq__qt_external nofollow_qt__gt_here_lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_ _lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2015-04-10T17:33:41Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Same as previous post_dd_ collisions with complex mesh is not a good idea (or you can wait for the webworker version of the collisions which should solve this issue)_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Dad72","Date":"2015-04-10T19:01:53Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_You can use an octree for collisions. This should improve performance._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt__lt_a href_eq__qt_http_dd_//babylondoc.azurewebsites.net/page.php?p_eq_22561_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//babylondoc.azurewebsites.net/page.php?p_eq_22561_lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I can not wait to see this DK for Webworker_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2015-04-11T17:17:32Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi Codelain_co_ welcome to the forum!  Did you get a good answer?_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_This thread_co_ and your other thread... both talk about heightMap ground.  When deltakosh says _qt_complex mesh_qt__co_ he is talking about the heightMap ground.  (I re-stated this in case he was unclear)_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Under a basic camera/ground collisions scene_co_ the camera _qt_collider_qt_ is the imaginary sphere that keeps the camera from falling through the ground.  When you activate your virtualJoystick to move a box_co_ sphere_co_ camera_co_ etc_co_ you move it on X and Z axis... but the Y axis of the object is still pushed against the ground.  Scene.gravity is forcing the object downward... all the time._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_This causes near-continuous collision activity ground-to-object.  Frame rates slow.  You can try object.ellipsoidOffset(0_co_ 0.1_co_ 0)) to raise the collider a small amount_co_ but that might cause the object to sink into the ground further.  This _qt_continuous rubbing_qt_ is a problem_co_ for both standard BJS collisions AND physics engine collisions._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Idea_dd_  When moving gravity-affected objects across heightMap terrain_co_ turn off collisions on the object that is moving.  Or turn off scene gravity.  Teach the sphere_co_ box_co_ or camera... how to do _qt_terrain following_qt_ instead.  I have heard of people using _qt_ray casting_qt_ (related to _qt_picking_qt_) to measure distance... such as distance from the bottom of a moving object... to the height of the ground underneath._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_This would be done in the animation loop_co_ and maybe ONLY during a joystick move.  Near-continuously_co_ the object would cast a ray beneath itself to check HOW FAR it is above the ground_co_ and it re-adjusts its height to .1 above the ground.  Now you can move the object X/Z with the joystick... and the object will always keep itself SOME distance above the terrain... no more_co_ no less._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I_t_m not experienced with measuring distance with rays_co_ but maybe others will comment.  I know others have tried this.  Dad72 is maybe THE most experienced _qt_move things across heightMaps_qt_ guy... in the whole tristate region.  _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt_  He said this_co_ once_dd__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_var pickInfo _eq_ yourGround.pick(yourObject.position.x_co_ yourObject.position.z)_sm_pickInfo.pickedPoint.y_sm_ // heightfield_lt_/pre_gt__lt_p_gt_That looks like the beginning of a terrain-following calculator_co_ eh?  (thx dad72)  _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Be sure to read _lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/topic/5385-heightmap-terrain-and-physics/#entry32532_qt__gt_http_dd_//www.html5gamedevs.com/topic/5385-heightmap-terrain-and-physics/#entry32532_lt_/a_gt_ and do forum search for _t_heightMap_t_... because lots of people have talked about these things._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"CodeIain","Date":"2015-04-15T16:47:36Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Sorry for the double post._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Thanks for all the help I worked out that using the octree that dad72 recommended working for my needs._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Regards _lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]