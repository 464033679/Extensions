[{"Owner":"xiuhtecuhtle","Date":"2016-11-06T08:37:41Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tWhat is the best approach to determining what face of a mesh was hit in a collision?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI_t_m creating a game in which there are very many meshes_sm_ they are platforms onto which the player can jump. But if the player hits the side of any platform_co_ he dies.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAs far as I can think_co_ there are two approaches here_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t1. Find some way of determining which vertex set was hit_co_ get the normal to it_co_ and record whether the normal points in the (0_co_1_co_0) direction (OK) or otherwise (kills player)._lt_br /_gt_\n\tHowever_co_ I can only find a way of telling when two meshes collide. The PhysicsImpostor.registerOnPhysicsCollide callback only tells me which meshes are hit. Perhaps once I have the two meshes there is a way to tell which vertex set of one mesh intersects which vertex set of another - but if such a function exists I couldn_t_t find it. (Closest thing is the PickingInfo returned by AbstractMesh.intersects(Ray) - but that_t_s not quite what I need_co_ as far as I can tell).\n_lt_/p_gt_\n\n_lt_p_gt_\n\t2. Add additional meshes to the scene to _qt_cover_qt_ the platforms. So I could for example add a plane to the top face of each platform and say that if the player collides with it then he_t_s safe_co_ otherwise if he collides only with the platform then he_t_s not._lt_br /_gt_\n\tThis approach seems inefficient as it doubles the number of meshes. Also would it even work? Say there is a platform that_t_s a cube_co_ and the player hits the side with normal (0_co_0_co_-1). That should kill him_co_ but if he hits it near the top he may also just touch the edge of the cover - which by the logic above would save him.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks for any pointers!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2016-11-08T16:44:22Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHiya _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/24302-xiuhtecuhtle/?do_eq_hovercard_qt_ data-mentionid_eq__qt_24302_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/24302-xiuhtecuhtle/_qt_ rel_eq__qt__qt__gt_@xiuhtecuhtle_lt_/a_gt__co_ welcome to the forum!  Sorry it is taking so long to get replies.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI would start with a search of our playgrounds... for _qt_collider_qt_.  _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/playground?q_eq_collider&amp_sm_page_eq_1&amp_sm_max_eq_86_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/playground?q_eq_collider&amp_sm_page_eq_1&amp_sm_max_eq_86_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI think you can reference a collider with _lt_em_gt_mesh._collider._lt_/em_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Collisions/babylon.collider.js#L47_qt_ rel_eq__qt_external nofollow_qt__gt_Collider source code_lt_/a_gt_ shows that there are many delicious properties on Colliders.  They are _private properties_co_ but you can use/query them.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tTake a look at _lt_strong_gt__lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1B7WZB%2313_qt_ rel_eq__qt_external nofollow_qt__gt_this playground_lt_/a_gt__lt_/strong_gt_.  There is _lt_em_gt_some_lt_/em_gt_ use of a _collider object_co_ there. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tSorry I don_t_t have more info. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tSpeaking of info_co_ let_t_s look at pickingInfo... _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/classes/2.4/PickingInfo_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/classes/2.4/PickingInfo_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHow about that ._lt_em_gt_faceId_lt_/em_gt_ property?  That might be a good word to use in a _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/playground_qt_ rel_eq__qt_external nofollow_qt__gt_playground search_lt_/a_gt_ and _lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/search/?&amp_sm_type_eq_forums_topic&amp_sm_nodes_eq_28_co_16_co_29_co_30_co_31_qt_ rel_eq__qt__qt__gt_forum search_lt_/a_gt_. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tI hope this helps.  Others will comment_co_ soon_co_ perhaps.  Be well_co_ welcome again.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2016-11-09T00:25:17Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\t _lt_span_gt__lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/5733-wingnut/?do_eq_hovercard_qt_ data-mentionid_eq__qt_5733_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/5733-wingnut/_qt_ rel_eq__qt__qt__gt_@Wingnut_lt_/a_gt__lt_/span_gt_ is right_dd_ just use the faceID to get the face number.From this face number you can get the indices from mesh.getIndices(). So if you want the first vertex from faceID_dd_ mesh.getIndices()[faceID * 3]\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"xiuhtecuhtle","Date":"2016-11-12T10:56:08Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tAwesome_co_ thanks _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/5733-wingnut/?do_eq_hovercard_qt_ data-mentionid_eq__qt_5733_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/5733-wingnut/_qt_ rel_eq__qt__qt__gt_@Wingnut_lt_/a_gt_ and _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_. You pointed me in the right direction - what I do is cast a ray from the centre of one mesh to the centre of the other and use scene.pickWithRay to get the PickingInfo. No need in fact to get faceId to get the normal_dd_ PickingInfo has its own getNormal() method.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThis isn_t_t perfect - you could quite easily conceive of a situation where two meshes collide but the ray cast from the centre of one to the centre of the other _lt_em_gt_doesn_t_t_lt_/em_gt_ intersect the collided faces. But it_t_s good enough for my purposes.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIncidentally_co_ PickingInfo.getNormal(false_co_ false) sometimes returns a normal in the wrong direction. Ie the face hit has normal (0_co_0_co_-1) and getNormal returned (0_co_0_co_1). The solution_co_ for anyone interested_co_ is to use PickingInfo.getNormal(false_co_ _lt_u_gt__lt_strong_gt_true_lt_/strong_gt__lt_/u_gt_).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHere_t_s my code_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_            var didHitSideOfPlatform _eq_ function (ship_co_ platform) {\n                var ray _eq_ new BABYLON.Ray(ship.position_co_ platform.position.subtract(ship.position))_sm_\n\n                var pickInfo_eq_scene.pickWithRay(ray_co_ function (item) { return item _eq__eq_ platform })_sm_\n                    \n                if (pickInfo.hit) {\n                    var normal _eq_ pickInfo.getNormal(false_co_ true)_sm_\n                    return Math.abs(normal.x) &lt_sm_ 0.01 &amp_sm_&amp_sm_ Math.abs(normal.y) &lt_sm_ 0.01_sm_\n                }\n                return false_sm_\n            }_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tThanks again\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2016-11-14T18:38:15Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tThis is cool!\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2016-11-14T19:14:34Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tWoah_co_ pickingInfo has a getNormal?  Well shoooooot... that is exactly what we are seeking... in _lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/topic/26110-angle-of-mesh-intersection/_qt_ rel_eq__qt__qt__gt_another thread_lt_/a_gt_!  Excellent!  hmm.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks for the demo code_co_ X!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]