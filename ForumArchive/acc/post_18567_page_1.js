[{"Owner":"Stalker","Date":"2015-11-12T21:38:43Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi!_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I_t_m trying to create unit (mesh) selection as it is in various strategy games(AoE_co_ CnC (attached image) ...)._lt_/p_gt__lt_p_gt_After some exploring_co_ I_t_ve came to the following_co_ but there are a couple of steps I don_t_t know how to do_dd__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_1. Hook to events (OK - trivial)_lt_/p_gt__lt_p_gt_2. Draw lines using BABYLON.Mesh.CreateLines - at what position? Set LineMesh parent to camera? How to translate mouse position (scene.pointerX and Y) to world coordinates? Just draw rectangle and and set transformation matrix to identity (4x4)? Canvas 2d and 3d context can_t_t be used together._lt_/p_gt__lt_p_gt_3. Once that is known_co_ visible meshes are selected with octree (frustum plane is created and used for selection via octree.select method). But frustum plane can be very small and very close_co_ or very big and far away (but this it_t_s probably solved at step 2)_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I haven_t_t really got to point 3. (got stuck at 2) so it_t_s only my speculation._lt_/p_gt__lt_p_gt_I_t_m open to suggestions if there are any better options _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_&lt_sm_fileStore.core_Emoticons&gt_sm_/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt_._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Explanation for attached image for non strategy game players_dd__lt_/p_gt__lt_p_gt_Green rectangle was drawn simply clicking in one corner and dragging. It_t_s always orthogonal to camera view and at the same position (also based on camera) even if camera is moved or rotated. Its rendered above everything and every unit inside is selected._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Thanks!_lt_/p_gt__lt_p_gt__lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_11_2015/post-17157-0-57686900-1447352414.jpg_qt_ rel_eq__qt_external nofollow_qt__gt__lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_11_2015/post-17157-0-57686900-1447352414.jpg_qt_ data-fileid_eq__qt_5577_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ alt_eq__qt_post-17157-0-57686900-1447352414.jpg_qt__gt__lt_/a_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Jaskar","Date":"2015-11-13T14:25:19Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi Stalker!_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Step 1 _dd_ Good!_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Step 2 _dd__lt_/p_gt__lt_p_gt_Maybe you can _qt_cheat_t__co_ and draw a simple html div with borders_co_ following the mouse coordinates ?_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Step 3 _dd_ _lt_/p_gt__lt_blockquote data-ipsquote_eq__qt__qt_ class_eq__qt_ipsQuote_qt__gt__lt_div_gt__lt_p_gt__lt_span style_eq__qt_font-size_dd_14px_sm__qt__gt__lt_span style_eq__qt_font-family_dd_arial_co_ helvetica_co_ sans-serif_sm__qt__gt_(from _lt_a href_eq__qt_http_dd_//answers.unity3d.com/questions/33901/view.html_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//answers.unity3d.com/questions/33901/view.html_lt_/a_gt_)_lt_/span_gt__lt_/span_gt__lt_/p_gt__lt_p_gt__lt_span style_eq__qt_font-size_dd_14px_sm__qt__gt_Instead of trying to use a world-space selection box like taht_co_ see if the objects_t_ coordinates when converted to screen space are within the screen-space rectangle instead._lt_/span_gt__lt_/p_gt__lt_/div_gt__lt_/blockquote_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Let us know if it_t_s ok! And don_t_t hesisate to share that with the community _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ alt_eq__qt__dd_D_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Stalker","Date":"2015-11-13T16:19:21Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi Jaskar!_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_2.  I came to a similar idea and after some exploring found an _lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/topic/3083-spaces-world-parent-pivot-local/?p_eq_20091_qt__gt_example from user gwenael_lt_/a_gt_. He has two canvases one over another_co_ bottom one for 3D graphics and top one for 2D_co_ where he draws rectangles and lines. It_t_s a cool idea_co_ just haven_t_t found any information yet about performance penalty_co_ if it_t_s negligible or not._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_3. Also came across my mind_co_ but goal is to have somewhere around 1k - 5k objects and would like to have quick access. Number isn_t_t that big at all_co_ but JavaScript isn_t_t exactly known for speed. A hybrid way of using Octree would probably be using getVisibleObjects (or something similar I found somewhere in the docs) and filtering afterwards._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I_t_ll proceed in this direction and let you know with what I came up in the next few days (and I_t_m also open for countless of other suggestions_co_ bad and good ones)._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Thank you very much for your help _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt_!_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Stalker","Date":"2015-11-16T22:12:17Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_At the end I did it as I wrote in my last post._lt_/p_gt__lt_ul_gt__lt_li_gt_2D Canvas overlaying 3D canvas where rectangle is drawn. The performance (frame time_co_ render time_co_ and potential FPS weren_t_t affected)_co_ but the frame rate was slightly decreased (55-60fps) when rectangle was visible._lt_/li_gt__lt_li_gt_All corners are then translated to 3D world coordinates (scene.pick method) (done when mouse button is released)_lt_/li_gt__lt_li_gt_All visible meshes (scene.getActiveMeshes) are stored into an array and filtered by_dd__lt_ul_gt__lt_li_gt_Name (to avoid skybox and ground)_lt_/li_gt__lt_li_gt_Checked if mesh is inside an rectangle using _lt_a href_eq__qt_http_dd_//math.stackexchange.com/questions/190111/how-to-check-if-a-point-is-inside-a-rectangle_qt_ rel_eq__qt_external nofollow_qt__gt_this_lt_/a_gt_._lt_/li_gt__lt_/ul_gt__lt_/li_gt__lt_/ul_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I_t_m sure the entire process can be speed up (a lot)_co_ but it will do for now._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Nikos123","Date":"2015-12-25T14:53:06Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote data-ipsquote_eq__qt__qt_ class_eq__qt_ipsQuote_qt_ data-ipsquote-contentcommentid_eq__qt_105890_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentid_eq__qt_18567_qt_ data-ipsquote-username_eq__qt_Stalker_qt_ data-cite_eq__qt_Stalker_qt_ data-ipsquote-timestamp_eq__qt_1447711937_qt__gt__lt_div_gt__lt_div_gt__lt_p_gt_At the end I did it as I wrote in my last post._lt_/p_gt__lt_ul_gt__lt_li_gt_2D Canvas overlaying 3D canvas where rectangle is drawn. The performance (frame time_co_ render time_co_ and potential FPS weren_t_t affected)_co_ but the frame rate was slightly decreased (55-60fps) when rectangle was visible._lt_/li_gt__lt_li_gt_All corners are then translated to 3D world coordinates (scene.pick method) (done when mouse button is released)_lt_/li_gt__lt_li_gt_All visible meshes (scene.getActiveMeshes) are stored into an array and filtered by_dd__lt_ul_gt__lt_li_gt_Name (to avoid skybox and ground)_lt_/li_gt__lt_li_gt_Checked if mesh is inside an rectangle using _lt_a href_eq__qt_http_dd_//math.stackexchange.com/questions/190111/how-to-check-if-a-point-is-inside-a-rectangle_qt_ rel_eq__qt_external nofollow_qt__gt_this_lt_/a_gt_._lt_/li_gt__lt_/ul_gt__lt_/li_gt__lt_/ul_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I_t_m sure the entire process can be speed up (a lot)_co_ but it will do for now._lt_/p_gt__lt_/div_gt__lt_/div_gt__lt_/blockquote_gt__lt_p_gt_Thanks for sharing this_co_ I will need some solution for my _lt_a href_eq__qt_http_dd_//quantuminformation.github.io/Density-Wars/_qt_ rel_eq__qt_external nofollow_qt__gt_RTS game_lt_/a_gt__co_ although I_t_m not to keen on the complexity of needing another canvas to accomplish this._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Are there any other options?_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Stalker","Date":"2015-12-28T12:39:05Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi!_lt_br_gt__lt_br_gt_There always are other options _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__co_ just that I haven_t_t found any nice. One is definitely ordinary div element with absolute position and set width_co_ height_co_ left and right css properties (which is pretty straight forward)._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I was also thinking of doing everything inside BJS_co_ but by my rough assessment it was way to complicated. Drawing a plane_co_ parenting it to camera (depends on what kind of selection do you need)_co_ creating a render group so it_t_s render above everything_co_ and (probably) translating mouse coordinates to world and doing some sort of transformations so it_t_s orthogonal to camera_co_ keeping word coordinates after transformations... There might be a better way to do this_co_ but didn_t_t find it at the time. (All this is for a specific selection described at my first post)._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I went with another canvas because I will use it for additional 2D drawing_co_ but it is possible that I will rewrite that part using an ordinary HTML elements._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_P.S._dd_ I like what you_t_ve done so far_co_ can_t_t wait to see more _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt_. _lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Nikos123","Date":"2015-12-28T12:44:19Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote data-ipsquote_eq__qt__qt_ class_eq__qt_ipsQuote_qt_ data-ipsquote-contentcommentid_eq__qt_110498_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentid_eq__qt_18567_qt_ data-ipsquote-username_eq__qt_Stalker_qt_ data-cite_eq__qt_Stalker_qt_ data-ipsquote-timestamp_eq__qt_1451306345_qt__gt__lt_div_gt__lt_div_gt__lt_p_gt_Hi!_lt_/p_gt__lt_p_gt_There always are other options _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__co_ just that I haven_t_t found any nice. One is definitely ordinary div element with absolute position and set width_co_ height_co_ left and right css properties (which is pretty straight forward)._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I was also thinking of doing everything inside BJS_co_ but by my rough assessment it was way to complicated. Drawing a plane_co_ parenting it to camera (depends on what kind of selection do you need)_co_ creating a render group so it_t_s render above everything_co_ and (probably) translating mouse coordinates to world and doing some sort of transformations so it_t_s orthogonal to camera_co_ keeping word coordinates after transformations... There might be a better way to do this_co_ but didn_t_t find it at the time. (All this is for a specific selection described at my first post)._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I went with another canvas because I will use it for additional 2D drawing_co_ but it is possible that I will rewrite that part using an ordinary HTML elements._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_P.S._dd_ I like what you_t_ve done so far_co_ can_t_t wait to see more _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt_. _lt_/p_gt__lt_/div_gt__lt_/div_gt__lt_/blockquote_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Thanks for the Kudos_co_ its bringing fun to the community that is one of the motivations for making such a game)_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I like the idea of using a div to draw the selector_co_ I will investigate it. _lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Nikos123","Date":"2015-12-29T21:10:57Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote data-ipsquote_eq__qt__qt_ class_eq__qt_ipsQuote_qt_ data-ipsquote-contentcommentid_eq__qt_105890_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentid_eq__qt_18567_qt_ data-ipsquote-username_eq__qt_Stalker_qt_ data-cite_eq__qt_Stalker_qt_ data-ipsquote-timestamp_eq__qt_1447711937_qt__gt__lt_div_gt__lt_div_gt__lt_p_gt_At the end I did it as I wrote in my last post._lt_/p_gt__lt_ul_gt__lt_li_gt_2D Canvas overlaying 3D canvas where rectangle is drawn. The performance (frame time_co_ render time_co_ and potential FPS weren_t_t affected)_co_ but the frame rate was slightly decreased (55-60fps) when rectangle was visible._lt_/li_gt__lt_li_gt_All corners are then translated to 3D world coordinates (scene.pick method) (done when mouse button is released)_lt_/li_gt__lt_li_gt_All visible meshes (scene.getActiveMeshes) are stored into an array and filtered by_dd__lt_ul_gt__lt_li_gt_Name (to avoid skybox and ground)_lt_/li_gt__lt_li_gt_Checked if mesh is inside an rectangle using _lt_a href_eq__qt_http_dd_//math.stackexchange.com/questions/190111/how-to-check-if-a-point-is-inside-a-rectangle_qt_ rel_eq__qt_external nofollow_qt__gt_this_lt_/a_gt_._lt_/li_gt__lt_/ul_gt__lt_/li_gt__lt_/ul_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I_t_m sure the entire process can be speed up (a lot)_co_ but it will do for now._lt_/p_gt__lt_/div_gt__lt_/div_gt__lt_/blockquote_gt__lt_p_gt_I decided to go for this method as I will also use canvas for drawing stuff like hit points from units taking damage and perhaps health indicators._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"snot224","Date":"2015-12-31T14:51:06Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi all_co__lt_br_gt__lt_br_gt_for my strategy game I create a selection square that work very well_co_ here the algorithm _dd__lt_br_gt__lt_br_gt_1) on mouse down_lt_/p_gt__lt_p_gt_      a ) place a DIV on the mouse start (SourisPoint1)_lt_br_gt_      b ) save babylon PICK point under the mouse (CanvasPoint1)_lt_br_gt_2) on mouse move_lt_/p_gt__lt_p_gt_      a ) draw selection DIV with current mouse position_lt_br_gt_3) on mouse up_lt_br_gt_      a ) save babylon PICK point where is mouse (CanvasPoint2)_lt_br_gt_      b ) save mouse position (SourisPoint2)_lt_br_gt_      c) proceed selection_lt_br_gt__lt_br_gt_Here algorithme for selection _dd__lt_br_gt_1) create 2 more PICK point to make a 3D square on BABYLON Canvas for that _dd__lt_/p_gt__lt_p_gt_      a ) calculate the distance between SourisPoint1.x and SourisPoint2.x_lt_br_gt_      b ) calculate the distance between SourisPoint1.y and SourisPoint2.y_lt_br_gt_      c ) calculate the x and y for SourisPoint3 and SourisPoint4 (ex. SourisPoint1.x + distanceX_co_ SourisPoint1.y + distanceY) _lt_span style_eq__qt_color_dd_#ff0000_sm__qt__gt_WARNING is depending of direction of selection square was made_lt_/span_gt__lt_br_gt_      d ) with SourisPoint3 and SourisPoint4_co_ create 2 PICK point in babylon canvas_lt_br_gt_2) calculate all lenghts of the square in the canvas (pythagore)_lt_/p_gt__lt_p_gt_3) calculate the surface of the 2 triangles making that square (Surface1 and Surface2)_lt_/p_gt__lt_p_gt_4) calculate the total surface of the 3D square (addition of the 2 triangles surfaces) (SurfaceSquare)_lt_/p_gt__lt_p_gt_5) for each unit_lt_/p_gt__lt_p_gt_      a ) calculate the surface of each triangle between position of unit and each points of the 3D square (Surface1_co_ Surface2_co_ Surface3_co_ Surface4)_lt_/p_gt__lt_p_gt_      b ) calculate total surface of all that triangles (SurfaceUnit)_lt_br_gt_6) If SurfaceUnit _eq__eq_ SurfaceSquare_co_ so unit is in the selection square._lt_br_gt__lt_br_gt_In attachment a picture representing all etapes_lt_br_gt__lt_br_gt_Hope it will help._lt_/p_gt__lt_p_gt__lt_br_gt_    _lt_br_gt_     _lt_br_gt_ _lt_/p_gt__lt_p_gt__lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_12_2015/post-18113-0-25905500-1451573398.jpg_qt_ rel_eq__qt_external nofollow_qt__gt__lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_12_2015/post-18113-0-25905500-1451573398_thumb.jpg_qt_ data-fileid_eq__qt_5943_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ alt_eq__qt_post-18113-0-25905500-1451573398_thumb.j_qt__gt__lt_/a_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Nikos123","Date":"2015-12-31T15:05:25Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Thanks snot_co_ do you have real js code for this you can share?_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"snot224","Date":"2015-12-31T16:20:36Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Yes I could paste here the code_co_ _lt_span style_eq__qt_color_dd_#ff0000_sm__qt__gt_but please be carefull this will be not workable because I use MY class names_co_ and MY naming rules_lt_/span_gt__lt_/p_gt__lt_p_gt_In your HTML_lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint lang-html_qt__gt_&lt_sm_style&gt_sm_    div.rectangleSelection    {        position            _dd_absolute_sm_        display                _dd_none_sm_                width                _dd_0px_sm_        height                _dd_0px_sm_        top                    _dd_0px_sm_        left                _dd_0px_sm_                background-color    _dd_rgba(0_co_50_co_70_co_0.3)_sm_        border                _dd_1px solid white_sm_        box-shadow            _dd_0 0 5px #FFF_sm_                z-index                _dd_3_sm_    }&lt_sm_/style&gt_sm_&lt_sm_div id_eq__qt_rectangleSelection_qt_ class_eq__qt_rectangleSelection_qt_&gt_sm_&lt_sm_/div&gt_sm_&lt_sm_canvas id_eq__qt_nkoCanvas_qt_&gt_sm_&lt_sm_/canvas&gt_sm__lt_/pre_gt__lt_p_gt_In your event listener _lt_span style_eq__qt_color_dd_#ff0000_sm__qt__gt_WARNING I USE MY _qt_controleurInput_qt_ class here !!!_lt_/span_gt__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_// On mouse move// Saving mouse coordinate// If an action was registred in _qt_controleurInput_qt_ do itwindow.addEventListener(_qt_mousemove_qt__co_ function(e){\tcontroleurInput.sourisX \t\t_eq_ e.pageX_sm_\tcontroleurInput.sourisY \t\t_eq_ e.pageY_sm_\t\tif (controleurInput.action)\t\tcontroleurInput.doAction()_sm_})_sm_// On mouse down_co_ if it_t_s left button_co_ put action _qt_SelectionStart_qt_ in _qt_ControleurInput_qt_// and Do itwindow.addEventListener(_qt_mousedown_qt__co_ function(e){\t\tswitch (e.button)\t{\t\tcase 0_dd_\t\t\tcontroleurInput.action _eq_ _qt_selectionStart_qt__sm_\t\t\tcontroleurInput.doAction()_sm_\t}})_sm_// On mouse up_co_ if _qt_controleurInput_qt_ is doing action of _qt_selectionEnCours_qt_// It mean we must stop selection_co_ so we put action of _qt_SelectionFin_qt_ in _qt_controleurInput_qt_window.addEventListener(_qt_mouseup_qt__co_ function(e){\tif (controleurInput.action _eq__eq_ _qt_selectionEnCours_qt_)\t{\t\tcontroleurInput.action _eq_ _qt_selectionFin_qt__sm_\t\tcontroleurInput.doAction()_sm_\t}})_sm__lt_/pre_gt__lt_p_gt_In your _qt_controleurInput_qt_ class_co_ we update position and we do action_lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_controleurInput.prototype.doAction _eq_ function(){\tswitch (this.action)\t{\t\tcase _t_selectionStart_t__dd_\t\t\tthis.actualisePosition()_sm_\t\t\tcontroleurObjet.doAction(_t_selectionStart_t_)_sm_\t\t\tthis.action _eq_ _qt_selectionEnCours_qt__sm_\t\t\tbreak_sm_\t\tcase _t_selectionEnCours_t__dd_\t\t\tcontroleurObjet.doAction(_t_selectionEnCours_t_)_sm_\t\t\tbreak_sm_\t\tcase _t_selectionFin_t__dd_\t\t\tthis.actualisePosition()_sm_\t\t\tcontroleurObjet.doAction(_t_selectionFin_t_)_sm_\t\t\tthis.action _eq_ _qt__qt__sm_\t\t\tbreak_sm_\t}}// We save the current canvas positioncontroleurInput.prototype.actualisePosition _eq_ function(){\tvar pickResult _eq_ scene.pick(scene.pointerX_co_ scene.pointerY_co_function(mesh)\t{\t\treturn mesh.name _eq__eq_ _qt_floor_qt__sm_\t})_sm_\tif (pickResult.hit)\t{\t\t// Nouvelles positions\t\tthis.posX \t\t\t\t_eq_ pickResult.pickedPoint.x_sm_\t\tthis.posZ \t\t\t\t_eq_ pickResult.pickedPoint.z_sm_\t\t}}_lt_/pre_gt__lt_p_gt_Here in the _qt_controleurObjet_qt_ class that control all object in the game._lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_controleurObjet.prototype.doAction _eq_ function(action){\tswitch (action)\t{\t\tcase _t_selectionStart_t__dd_\t\t\tthis.rectangleSelection[_t_x1_t_] \t_eq_ controleurInput.posX_sm_\t\t\tthis.rectangleSelection[_t_z1_t_] \t_eq_ controleurInput.posZ_sm_\t\t\t\t\t\tthis.rectangleSelection[_t_sx1_t_]\t_eq_ controleurInput.sourisX_sm_\t\t\tthis.rectangleSelection[_t_sy1_t_]\t_eq_ controleurInput.sourisY_sm_\t\t\t\t\t\t(function($)\t\t\t{\t\t\t\t$(_t_#rectangleSelection_t_).css({\t\t\t\t\t_t_top_t_\t\t_dd_controleurInput.sourisY-5_co_\t\t\t\t\t_t_left_t_\t\t_dd_controleurInput.sourisX-5\t\t\t\t})_sm_\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(_t_#rectangleSelection_t_).fadeIn(200)_sm_\t\t\t})(jQuery)_sm_\t\t\tbreak_sm_\t\tcase _t_selectionEnCours_t__dd_\t\t\tthis.selectionEnCours()_sm_\t\t\tbreak_sm_\t\tcase _t_selectionFin_t__dd_\t\t\tthis.rectangleSelection[_t_x2_t_]\t_eq_ controleurInput.posX_sm_\t\t\tthis.rectangleSelection[_t_z2_t_] \t_eq_ controleurInput.posZ_sm_\t\t\t\t\t\tthis.rectangleSelection[_t_sx2_t_]\t_eq_ controleurInput.sourisX_sm_\t\t\tthis.rectangleSelection[_t_sy2_t_]\t_eq_ controleurInput.sourisY_sm_\t\t\t(function($)\t\t\t{\t\t\t\t$(_t_#rectangleSelection_t_).fadeOut(200)_sm_\t\t\t\t$(_t_#rectangleSelection_t_).css({\t\t\t\t\t_t_top_t_\t\t_dd_0_co_\t\t\t\t\t_t_left_t_\t\t_dd_0_co_\t\t\t\t\t_t_width_t_\t\t_dd_0_co_\t\t\t\t\t_t_height_t_\t_dd_0\t\t\t\t})_sm_\t\t\t})(jQuery)_sm_\t\t\tthis.selection()_sm_\t\t\tbreak_sm_\t}}// This function only place selection square and resize it when mouse movingcontroleurObjet.prototype.selectionEnCours _eq_ function(){\t\t\tvar widthRectangle\t_eq_ Math.abs(this.rectangleSelection[_t_sx1_t_] - controleurInput.sourisX)_sm_ \tvar heightRectangle  \t_eq_ Math.abs(this.rectangleSelection[_t_sy1_t_] - controleurInput.sourisY)_sm_\t(function($)\t{\t\t\t$(_t_#rectangleSelection_t_).css({\t\t\t\t_t_width_t_\t\t_dd_ widthRectangle-5_co_\t\t\t\t_t_height_t_\t_dd_ heightRectangle-5\t\t})_sm_\t})(jQuery)_sm_\t\t// On recale la div suivant si on séléctionne depuis la gauche vers la droite_co_ ou de bas en haut\t// Depending that if you select from left_co_ right_co_ up or down\tif ((controleurInput.sourisX &lt_sm__eq_ this.rectangleSelection[_t_sx1_t_]) &amp_sm_&amp_sm_ (controleurInput.sourisY &gt_sm__eq_ this.rectangleSelection[_t_sy1_t_]))\t{\t\t(function($)\t\t{\t\t\t\t$(_t_#rectangleSelection_t_).css({\t\t\t\t_t_width_t_\t\t_dd_ widthRectangle-5_co_\t\t\t\t_t_height_t_\t_dd_ heightRectangle-5_co_\t\t\t\t_t_left_t_\t\t_dd_ controleurInput.sourisX+5\t\t\t})_sm_\t\t})(jQuery)_sm_\t} \telse if ((controleurInput.sourisY &lt_sm__eq_ this.rectangleSelection[_t_sy1_t_]) &amp_sm_&amp_sm_ (controleurInput.sourisX &gt_sm__eq_ this.rectangleSelection[_t_sx1_t_]))\t{\t\t(function($)\t\t{\t\t\t$(_t_#rectangleSelection_t_).css({\t\t\t\t_t_width_t_\t\t_dd_ widthRectangle-5_co_\t\t\t\t_t_height_t_\t_dd_ heightRectangle-5_co_\t\t\t\t_t_top_t_\t\t_dd_ controleurInput.sourisY+5\t\t\t})_sm_\t\t})(jQuery)_sm_\t} \telse if ((controleurInput.sourisY &lt_sm_ this.rectangleSelection[_t_sy1_t_]) &amp_sm_&amp_sm_ (controleurInput.sourisX &lt_sm_ this.rectangleSelection[_t_sx1_t_]))\t{\t\t(function($)\t\t{\t\t\t$(_t_#rectangleSelection_t_).css({\t\t\t\t_t_width_t_\t\t_dd_ widthRectangle-5_co_\t\t\t\t_t_height_t_\t_dd_ heightRectangle-5_co_\t\t\t\t_t_left_t_\t\t_dd_ controleurInput.sourisX+5_co_\t\t\t\t_t_top_t_\t\t_dd_ controleurInput.sourisY+5\t\t\t})_sm_\t\t})(jQuery)_sm_\t}}// Here the real algorithme of selectioncontroleurObjet.prototype.selection _eq_ function(){\t// ************************************************** Rectangle vue page\tvar sx1 \t\t_eq_ this.rectangleSelection[_t_sx1_t_]_sm_\tvar sx2 \t\t_eq_ this.rectangleSelection[_t_sx2_t_]_sm_\tvar sy1 \t\t_eq_ this.rectangleSelection[_t_sy1_t_]_sm_\tvar sy2 \t\t_eq_ this.rectangleSelection[_t_sy2_t_]_sm_\tvar dx \t\t\t_eq_ sx2-sx1_sm_\tvar dy\t\t\t_eq_ sy2-sy1_sm_\tvar __SELECTION_ADOUCIE__ \t_eq_ 3_sm_\t\t\t// Distance entre X1souris et X2Souris_co_ hypothénus\t// Distance between X1Souris and X2Souris\tvar d \t\t\t_eq_ Math.sqrt( (dy*dy)+(dx*dx) )_sm_\t// Les deux autres cotés du rectangle\t// The 2 overs points of the square inside the canvas\tvar pickResult3 _eq_ scene.pick(sx1+dx_co_ sy1)_sm_\tvar pickResult4 _eq_ scene.pick(sx2-dx_co_ sy2)_sm_\t\t// ************************************************** Rectangle vue scene \t// Coordonnées point\t// All point coordinate (inside the canvas)\tvar x1 _eq_ Math.round(this.rectangleSelection[_t_x1_t_]*1000)/1000_sm_\tvar z1 _eq_ Math.round(this.rectangleSelection[_t_z1_t_]*1000)/1000_sm_\t\tvar x2 _eq_ Math.round(this.rectangleSelection[_t_x2_t_]*1000)/1000_sm_\tvar z2 _eq_ Math.round(this.rectangleSelection[_t_z2_t_]*1000)/1000_sm_\t\tvar x3 _eq_ Math.round(pickResult3.pickedPoint.x*1000)/1000_sm_\tvar z3 _eq_ Math.round(pickResult3.pickedPoint.z*1000)/1000_sm_\t\tvar x4 _eq_ Math.round(pickResult4.pickedPoint.x*1000)/1000_sm_\tvar z4 _eq_ Math.round(pickResult4.pickedPoint.z*1000)/1000_sm_\t\t// Calcul des longueurs des 4 cotés du rectangle du canvas\t// Square lenght inside canvas\tvar a _eq_ Math.sqrt( ((x3 - x2)*(x3 - x2))+((z3 - z2)*(z3 - z2)) )_sm_\tvar b _eq_ Math.sqrt( ((x3 - x1)*(x3 - x1))+((z3 - z1)*(z3 - z1)) )_sm_\tvar i _eq_ Math.sqrt( ((x2 - x4)*(x2 - x4))+((z2 - z4)*(z2 - z4)) )_sm_\tvar j _eq_ Math.sqrt( ((x4 - x1)*(x4 - x1))+((z4 - z1)*(z4 - z1)) )_sm_\t// Diagonale\tvar h _eq_ Math.sqrt( ((x2 - x1)*(x2 - x1))+((z2 - z1)*(z2 - z1)) )_sm_\t\t// Calcul des perimetres\t// perimeter of the 2 triangles\tvar per1 _eq_ (a + b + h)/2_sm_\tvar per2 _eq_ (i + j + h)/2_sm_\t// Surface\tvar Ss _eq_ Math.round((Math.sqrt(per1*(per1-a)*(per1-*(per1-h))+Math.sqrt(per2*(per2-i)*(per2-j)*(per2-h)))*100)/100_sm_\tvar thisObjet _eq_ this_sm_\t(function($)\t{\t\t// Détermine si l_t_unité est dans le rectangle\t\t// If unit is inside the square WARNING I use a SELECTION_MAX to avoid too much selection\t\t$.each(thisObjet.tabUnitesEquipe_co_function(id_co_selectedUnit)\t\t{\t\t\tif ((thisObjet.tabSelection.length &lt_sm_ thisObjet.__SELECTION_MAX__)&amp_sm_&amp_sm_(selectedUnit.mesh.isVisible))\t\t\t{\t\t\t\t\t// Coordonnée unité\t\t\t\t\t\t\t\t\t\t\tvar xu _eq_ selectedUnit.mesh.position.x_sm_\t\t\t\tvar zu _eq_ selectedUnit.mesh.position.z_sm_\t\t\t\t// Calcul longueur\t\t\t\t// Lenght between unit and all square_t_s points\t\t\t\tvar m _eq_ Math.sqrt( ((xu - x1)*(xu - x1))+((zu - z1)*(zu - z1)) )_sm_\t\t\t\tvar n _eq_ Math.sqrt( ((xu - x3)*(xu - x3))+((zu - z3)*(zu - z3)) )_sm_\t\t\t\tvar o _eq_ Math.sqrt( ((xu - x2)*(xu - x2))+((zu - z2)*(zu - z2)) )_sm_\t\t\t\tvar p _eq_ Math.sqrt( ((xu - x4)*(xu - x4))+((zu - z4)*(zu - z4)) )_sm_\t\t\t\t// Calcul des périmètres\t\t\t\t// Perimeter\t\t\t\tvar per3 _eq_ (m + p + j)/2_sm_\t\t\t\tvar per4 _eq_ (m + n + b)/2_sm_\t\t\t\tvar per5 _eq_ (n + o + a)/2_sm_\t\t\t\tvar per6 _eq_ (o + p + i)/2_sm_\t\t\t\t// Calcul des surfaces\t\t\t\tvar St1 _eq_ Math.sqrt(per3*(per3-m)*(per3-p)*(per3-j))_sm_\t\t\t\tvar St2 _eq_ Math.sqrt(per4*(per4-m)*(per4-n)*(per4-)_sm_\t\t\t\tvar St3 _eq_ Math.sqrt(per5*(per5-n)*(per5-o)*(per5-a))_sm_\t\t\t\tvar St4 _eq_ Math.sqrt(per6*(per6-o)*(per6-p)*(per6-i))_sm_\t\t\t\t\t\t\t\tvar St _eq_ Math.round((St1 + St2 + St3 + St4)*100)/100_sm_\t\t\t\t\t\t\t\tif (St _eq__eq_ Ss)\t\t\t\t{\t\t\t\t\tthisObjet.tabSelection.push(selectedUnit.selection())_sm_\t\t\t\t}\t\t\t}\t\t})_sm_\t})(jQuery)_sm_}_lt_/pre_gt__lt_p_gt_Hope it could help _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Nikos123","Date":"2015-12-31T18:30:30Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Cool man thanks for this. Is your game in prod?_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"snot224","Date":"2015-12-31T18:56:23Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote data-ipsquote_eq__qt__qt_ class_eq__qt_ipsQuote_qt_ data-ipsquote-contentcommentid_eq__qt_110944_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentid_eq__qt_18567_qt_ data-ipsquote-username_eq__qt_Nikos123_qt_ data-cite_eq__qt_Nikos123_qt_ data-ipsquote-timestamp_eq__qt_1451586630_qt__gt__lt_div_gt__lt_div_gt__lt_p_gt_Cool man thanks for this. Is your game in prod?_lt_/p_gt__lt_/div_gt__lt_/div_gt__lt_/blockquote_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Yes_co_ still in prod _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Jaskar","Date":"2016-01-05T09:48:12Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote data-ipsquote_eq__qt__qt_ class_eq__qt_ipsQuote_qt_ data-ipsquote-contentcommentid_eq__qt_110946_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentid_eq__qt_18567_qt_ data-ipsquote-username_eq__qt_snot224_qt_ data-cite_eq__qt_snot224_qt_ data-ipsquote-timestamp_eq__qt_1451588183_qt__gt__lt_div_gt__lt_div_gt__lt_p_gt_Yes_co_ still in prod _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt__lt_/div_gt__lt_/div_gt__lt_/blockquote_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Link please ? _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]