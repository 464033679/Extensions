[{"Owner":"santarcade","Date":"2015-11-20T14:44:17Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi guys_lt_br_gt_I_t_m writing the locomotion algorithm for a character I created in blender._lt_br_gt_What I_t_m trying to achieve is a blend tree that will allow me to blend between the _qt_walk-front_qt__co_ _qt_strife-left_qt_ animations according to the velocity of my character (something similar to  _lt_a href_eq__qt_https_dd_//www.youtube.com/watch?v_eq_Xx21y9eJq1U&amp_sm_feature_eq_youtu.be&amp_sm_t_eq_1263_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.youtube.com/watch?v_eq_Xx21y9eJq1U&amp_sm_feature_eq_youtu.be&amp_sm_t_eq_1263_lt_/a_gt_)._lt_br_gt_I_t_ve been able to blend between two frames_co_ by calculating a weighted average of the transformation matrix for each bone_co_ so far so good._lt_br_gt_Now before going on with my development I_t_m asking myself the following design question._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Supposing I will have a state machine to control the character_co_ should I write an update(dt) method called at each engine tick and reposition its bones individually or rather bake at run-time a new animation with frames each time the direction/velocity changes?_lt_br_gt__lt_br_gt_I just do not know the pros/cons sticking with Babylon Animations versus going on with my own update method._lt_/p_gt__lt_p_gt_What I like of using Babylon Animations is the fact that I can fast up / slow down my walk cycles so to simulate faster/slower velocities._lt_br_gt__lt_br_gt_Thank you in advance for any feedback_co__lt_br_gt_Joez_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"BitOfGold","Date":"2015-11-21T10:28:35Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Cool!_lt_br_gt__lt_br_gt_You had nearly the same idea as I had! (baking weighted combination of animations)._lt_/p_gt__lt_p_gt_Calculating many bone matrixes of multiple animations on multiple meshes every frame_co_ it would be too heavy I think._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Maybe a transition between walk-front and strife-left (and back) would look better than baking steps between._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Then you would need to write only one function_co_ which bakes two full new animation transitions._lt_/p_gt__lt_p_gt_walk-front_to_strife-left and strife-left_to_walk-front._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Edit_dd_ it maybe could be part of Babylon animations. Everyone has this same problem with animation blending. _sm_-)_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Edit 2_dd_ I think the transition time would look best if it is two to four times of the animation cycles. Like if the front animation is 60 frame / cycle and the strafe is also 60 frames_co_ the transition would be a multiple of this_co_ like 120 or 240 frames. Just an idea _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"santarcade","Date":"2015-11-21T13:40:07Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi BitOfGold_co_ thanks for your inputs._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_For locomotion_co_ my idea is to have the character move smoothly in all 365 degrees_co_ placing footstep precisely in the direction of movement._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I will do the animations now and test the performances._lt_/p_gt__lt_p_gt_Maybe it will be acceptable to calculate each bone_co_ since I will have just two character and I plan to limit the locomotion animations to the lower part of the body of my bipeds_co_ and use other default animations on the top. Only tests will tell._lt_/p_gt__lt_p_gt_Worst case_co_ according to their size in memory_co_ I could pre-bake a limited set of them to a given approximation_co_ e.g. one each 30 degrees._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_However_co_ the idea of pre-baking transitions is interesting_co_ I think I will use it to blend particular animations on the upper half of the body._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Cheers_co__lt_/p_gt__lt_p_gt_Joez_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"santarcade","Date":"2015-11-26T16:53:30Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi all_co__lt_/p_gt__lt_p_gt_for the records_co_ I created my animations_co_ I did some refactoring to have all the code controlling the character in a dedicated class._lt_/p_gt__lt_p_gt_Then I created a basic state machine and an update(dt) function which gets invoked by the runRenderLoop callback._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_According to the direction of movement the character is required to perform_co_ my code picks two same-length animations and interpolates the currentFrame of these two animations with a weighted average._lt_/p_gt__lt_p_gt_Currently_co_ with no caching of frames and looping through all bones (even not used ones) the performances are perfect._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_The blending result when interpolating the walk-front and walk-left animations is quite realistic_co_ I will keep the optimizations for later._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_When I_t_ll have reached a stable point I will link some screen captures._lt_/p_gt__lt_p_gt_Cheers_co__lt_/p_gt__lt_p_gt_joez82_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"WolfKodi","Date":"2015-11-27T11:51:09Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_I_t_m excited about bone animation blending and I_t_m sure many will find this useful especially for a game engine. If you ever need help with testing and debugging_co_ do post._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"MackeyK24","Date":"2017-10-06T14:28:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tYo _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_ I know this is an old post... But it looks like it is possible to play blended weighted animations ... I need to get BlendTrees working right.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tRight now I am interpolating between animations and it does not look quite right... I need to be able to blend animations like a Walk Forward blended with a strafe left animation.... Simply interpolating between then is not working.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI know your a busy guy. But if you can help me with this it would be great for all babylon toolkit users to create more modern animations for out characters.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIt also looks like you can play different animations of different bones... so I should be able too use the Unity Animation Mask feature to make the bones in the avatar to play different animations from different layers... Like running while swinging a sword ... I can get to all this information (which is serialized as metadata)... Blend tree info_co_ layer mask info and tons of other unity animation information needed to fully re-create the whole Unity Animation System.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIts just in the BabylonJS layer I don_t_t know what it means to _t_Play Weighted Animations_t_ or how to even go about this at all in Babylon...\n_lt_/p_gt_\n\n_lt_p_gt_\n\tBut this guy _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/16634-santarcade/?do_eq_hovercard_qt_ data-mentionid_eq__qt_16634_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/16634-santarcade/_qt_ rel_eq__qt__qt__gt_@santarcade_lt_/a_gt_ seems to have been able to do it. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tAgain.. I know your busy... But can you please work with me a bit (actually hooking up in some kind of gotomeeting or some kind of actual conversations would be freakin awesome... There are a few things things I just cant finish by myself)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tNote_dd_ Any other BabylonJS Gurus out there... IF you can help... Please... I really wanna get a good working version of the toolkit out for all to use _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"MackeyK24","Date":"2017-10-06T14:31:31Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tYo _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/7708-bitofgold/?do_eq_hovercard_qt_ data-mentionid_eq__qt_7708_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/7708-bitofgold/_qt_ rel_eq__qt__qt__gt_@BitOfGold_lt_/a_gt_ ... Hey bro.... have you heard anything more on blend locomotion animations in BabylonJS... I have re-created the Unity Animation State Machine.. But I don_t_t know how to locally play on the client_co_ blended / weighted locomotion animations. Any info you have on this matter would really help out _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"BitOfGold","Date":"2017-10-06T15:17:44Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tHi!_lt_br /_gt__lt_br /_gt_\n\tI think blending animations is easy now like this_co_ so no need for pre baking animation transitions anymore_dd__lt_br /_gt__lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#GTHTR%237_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#GTHTR#7_lt_/a_gt__lt_br /_gt__lt_br /_gt_\n\tI don_t_t know nothing about _lt_span style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#353c41_sm_font-size_dd_14px_sm__qt__gt_Unity Animation Mask_co_ but I understand that swinging a sword while running thing..._lt_br /_gt__lt_br /_gt_\n\tTo understand babylon_t_s animation system in detail_co_ I recommend you to look at an animated model_t_s object structure_lt_br /_gt_\n\tmesh-&gt_sm_skeleton-&gt_sm__animatables  this stores the animations of each bone._lt_br /_gt_\n\tin _animatables there are animations_co_ most (keyframed_co_ skinned) models have one animation._lt_br /_gt_\n\tin each animation there are _keys_co_ this stores the transformation matrix of that bone at that frame/moment._lt_br /_gt_\n\tin the animation there are also _ranges_co_ there store only frame ranges of the animation._lt_br /_gt__lt_br /_gt_\n\tMaybe this helps..._lt_/span_gt__lt_br /_gt__lt_br /_gt__lt_br /_gt__lt_br /_gt_\n\t \n_lt_/p_gt_\n_lt_p_gt__lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_10/animatables.JPG.2a424d4260cd7e541e4601ecee3e57be.JPG_qt_ class_eq__qt_ipsAttachLink ipsAttachLink_image_qt__gt__lt_img data-fileid_eq__qt_15122_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_10/animatables.thumb.JPG.0383b2f5ee253c9393024b2f70d1cf66.JPG_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ alt_eq__qt_animatables.JPG_qt__gt__lt_/a_gt__lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"MackeyK24","Date":"2017-10-06T15:48:54Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/7708-bitofgold/?do_eq_hovercard_qt_ data-mentionid_eq__qt_7708_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/7708-bitofgold/_qt_ rel_eq__qt__qt__gt_@BitOfGold_lt_/a_gt_ Thanks for the reply _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tBut yeah_co_ I got that part... That is actually the backbone of my _qt_Animation Retargeting_qt_... I sample the Skeleton in unity for EACH bone and EACH frame and create a Matrix4x4 using the translation position_co_ rotation and scale in World Space and use that as the key frame value for the _matrix property... I also natively support _qt_Blending Speed_qt_ for _qt_Transitioning_qt_ animations... Also working great... But for BLEND TREE... where you might wanna _qt_BLEND_qt_ grounded locomotion states... For example... Pushing UP/LEFT on the gamepad should move in the LEFT/FORWARD diagonal movement... In the blend tree scenario you would play a 50/50 blend of the WALK FORWARD animation with the LEFT STRAFE animation... I guess you take a weighted average of the two (or more) bone matrix value and play that mix... which in our case would have LEFT/FORWARD animation movement...\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI just don_t_t know how in babylon js to play a weighted average of multiple animation frames... The Unity masking part... allows you to MASK off parts of the skeleton and assign animations from different layers to different body parts (like upper swinging a sword and lower running ... maybe even blend tree on bottom and another blend tree for top)... I think I can serialize WHAT bones of the skeleton are masked and play different animation for bones that are in the mask... that will come later... but if you can play different animations on different bones like it says you can in the post above... its just a matter of me serializing the info out of unity that says what bones should be playing what animations... That should work... we will see when I get there... but yeah that should work.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tBut I gotta get _qt_Blend Tree_qt_ working for it to look right _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"MackeyK24","Date":"2017-10-06T15:57:49Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tYo _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/5733-wingnut/?do_eq_hovercard_qt_ data-mentionid_eq__qt_5733_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/5733-wingnut/_qt_ rel_eq__qt__qt__gt_@Wingnut_lt_/a_gt_ ... How bout you... You always got a bit of info bout these type things... Do know how to play weighted averages of multiple animations to make a BLEND TREE support ???\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2017-10-06T16:13:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\thahaha.  I_t_m honored that you think I_t_m smart enough to have a useful comment.  Thx!  No_co_ that kind of stuff is out of reach for me.  Sorry.  But I can talk aimlessly on a related topic...\n_lt_/p_gt_\n\n_lt_p_gt_\n\tStrafing.  ie. side-stepping.  When is a controller right-pull (east?) considered a strafe_co_ and when is it considered a turn-player-eastward-then-begin-walking-forward?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tTwo possibilities for a single right-pull on the joystick.  Drastically different animation sequences needed for each!  And_co_ different follow-camera operations needed for each.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tDoesn_t_t this make your brain hurt_co_ Mackenoid?  Maybe I_t_m hallucinating again.  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tA blend tree?  What the hell is that?  No wait_co_ I probably don_t_t want to know. I_t_ve added _t_blend tree_t_ to my browser parental control DB_co_ so I don_t_t accidentally search for it.  _lt_img alt_eq__qt__dd_D_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ title_eq__qt__dd_D_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]