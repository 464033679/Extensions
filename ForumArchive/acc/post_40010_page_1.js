[{"Owner":"hcmetal","Date":"2018-09-15T08:06:00Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHello everyone_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI have been trying to create my own hdr environment map and use it in Babylon.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tA panorama is rendered in 3s Max 2019 using the V-Ray Next (4.02.04) sun system and saved as a .hdr file.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe .hdr file is then loaded into Lys and converted to a specular .dds file_co_ following the instructions from _lt_a href_eq__qt_https_dd_//doc.babylonjs.com/how_to/physically_based_rendering_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//doc.babylonjs.com/how_to/physically_based_rendering_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tLooks fine in Lys_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_09/lysscr.jpg.5285018c276cfe55b2565f3af3b6c1b4.jpg_qt_ data-fileid_eq__qt_20041_qt_ rel_eq__qt__qt__gt__lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_20041_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_09/lysscr.thumb.jpg.6684846d9b3c4cfc11ceb9df1d5cafbd.jpg_qt_ alt_eq__qt_lysscr.thumb.jpg.6684846d9b3c4cfc11ceb9df1d5cafbd.jpg_qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHowever_co_ in Babylon some strange things are happening\n_lt_/p_gt_\n\n_lt_p_gt_\n\tPG_dd_ _lt_a href_eq__qt_https_dd_//playground.babylonjs.com/#FDQ594_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//playground.babylonjs.com/#FDQ594_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tTwo things to notice_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t1. Reflection on the sphere with chrome pbr material. The sun looks funky_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_20042_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_09/spherescr.jpg.b4283eedc6e31cba2e5fe4b3925dc635.jpg_qt_ alt_eq__qt_spherescr.jpg.b4283eedc6e31cba2e5fe4b3925dc635.jpg_qt_ /_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t2. Reflection on the ground with a none metallic pbr material. The sun looks funky too_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_20043_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_09/groundscr.jpg.9326fbf6de18e0f913ca2235b0bb7a2d.jpg_qt_ alt_eq__qt_groundscr.jpg.9326fbf6de18e0f913ca2235b0bb7a2d.jpg_qt_ /_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tBoth materials have very sensitive roughness behaviour. More detail can be found in the PG.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe .hdr output from Vray is here_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/applications/core/interface/file/attachment.php?id_eq_20044_qt_ data-fileid_eq__qt_20044_qt_ rel_eq__qt__qt__gt_vrayhdrtest.hdr_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI suspect something has gone wrong during the conversion in Lys_co_ or the original render out of V-Ray has some problem.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHope someone can point me to the right direction.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks a lot!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Sebavan","Date":"2018-09-17T16:12:22Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tIndeed_co_ the file seems corrupted as if I look into the mips manually it is  broken from mip 3_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_09/image.png.69686bbc9be6d3ac93c0ffbdc212b0b1.png_qt_ data-fileid_eq__qt_20086_qt_ rel_eq__qt__qt__gt__lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_20086_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_09/image.thumb.png.aba5afda8b970bdc8187d94e0e9430a5.png_qt_ alt_eq__qt_image.thumb.png.aba5afda8b970bdc8187d94e0e9430a5.png_qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/32589-patrickryan/?do_eq_hovercard_qt_ data-mentionid_eq__qt_32589_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/32589-patrickryan/_qt_ rel_eq__qt__qt__gt_@PatrickRyan_lt_/a_gt_ Could you try to generate the DDS in LYS to see what happens ?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"PatrickRyan","Date":"2018-09-17T19:42:55Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/32476-hcmetal/?do_eq_hovercard_qt_ data-mentionid_eq__qt_32476_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/32476-hcmetal/_qt_ rel_eq__qt__qt__gt_@hcmetal_lt_/a_gt_! \n_lt_/p_gt_\n\n_lt_p_gt_\n\tI took a look at your playground and HDR and noticed a couple of things. \n_lt_/p_gt_\n\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\tWhen you are generating a DDS in Lys_co_ make sure to step through the MIPs in the MIP preview slider. The brute force method is failing on your image as you can see in the screen shot below. The easiest way to fix this is to uncheck _qt_Render ground truth specular using brute force method_qt_ as there is something in the pixels of your HDR that is making the computation fail. I normally use OpenEXR for my renders and images coming into Lys_co_ so I would love to see if you could try exporting your environment as an EXR and see if you have the same problem. It may give us some more clarity about best practices. \n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_09/HDR_BruteForceError.PNG.90e397c7a106bb7a3fe22ec271d40442.PNG_qt_ data-fileid_eq__qt_20092_qt_ rel_eq__qt__qt__gt__lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_20092_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_09/HDR_BruteForceError.thumb.PNG.e94273f3c7c3bb40d897cecc5bdb9e09.PNG_qt_ alt_eq__qt_HDR_BruteForceError.thumb.PNG.e94273f3c7c3bb40d897cecc5bdb9e09.PNG_qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\tWhen calling your environment_co_ you need to make sure you call it saying it_t_s precomputed data like this_dd_\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\t_lt_div style_eq__qt_background-color_dd_#1e1e1e_sm_color_dd_#d4d4d4_sm_font-size_dd_14px_sm__qt__gt_\n\t\t\t_lt_div_gt_\n\t\t\t\t_lt_span style_eq__qt_color_dd_#569cd6_sm__qt__gt_var_lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_ _lt_/span_gt__lt_span style_eq__qt_color_dd_#9cdcfe_sm__qt__gt_hdrTexture_lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_ _lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt__eq__lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_ _lt_/span_gt__lt_span style_eq__qt_color_dd_#9cdcfe_sm__qt__gt_BABYLON_lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_._lt_/span_gt__lt_span style_eq__qt_color_dd_#9cdcfe_sm__qt__gt_CubeTexture_lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_._lt_/span_gt__lt_span style_eq__qt_color_dd_#dcdcaa_sm__qt__gt_CreateFromPrefilteredData_lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_(_lt_/span_gt__lt_span style_eq__qt_color_dd_#ce9178_sm__qt__gt__qt__lt_/span_gt__lt_span style_eq__qt_color_dd_rgb(206_co_145_co_120)_sm__qt__gt__lt_a href_eq__qt_https_dd_//raw.githubusercontent.com/PatrickRyanMS/BabylonJStextures/master/DDS/Studio_Softbox_2Umbrellas_cube_specular.dds_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//raw.githubusercontent.com/PatrickRyanMS/BabylonJStextures/master/DDS/Studio_Softbox_2Umbrellas_cube_specular.dds_lt_/a_gt__lt_/span_gt__lt_span style_eq__qt_color_dd_rgb(206_co_145_co_120)_sm__qt__gt__qt__lt_/span_gt__co_ _lt_span style_eq__qt_color_dd_rgb(156_co_220_co_254)_sm__qt__gt_scene_lt_/span_gt_)_sm_\n\t\t\t_lt_/div_gt_\n\n\t\t\t_lt_div_gt_\n\t\t\t\t_lt_span style_eq__qt_color_dd_#9cdcfe_sm__qt__gt_hdrTexture_lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_._lt_/span_gt__lt_span style_eq__qt_color_dd_#9cdcfe_sm__qt__gt_name_lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_ _lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt__eq__lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_ _lt_/span_gt__lt_span style_eq__qt_color_dd_#ce9178_sm__qt__gt__qt_envTex_qt__lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt__sm__lt_/span_gt_\n\t\t\t_lt_/div_gt_\n\n\t\t\t_lt_div_gt_\n\t\t\t\t_lt_span style_eq__qt_color_dd_#9cdcfe_sm__qt__gt_hdrTexture_lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_._lt_/span_gt__lt_span style_eq__qt_color_dd_#9cdcfe_sm__qt__gt_gammaSpace_lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_ _lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt__eq__lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_ _lt_/span_gt__lt_span style_eq__qt_color_dd_#569cd6_sm__qt__gt_false_lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt__sm__lt_/span_gt_\n\t\t\t_lt_/div_gt_\n\n\t\t\t_lt_div_gt_\n\t\t\t\t_lt_span style_eq__qt_color_dd_#9cdcfe_sm__qt__gt_scene_lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_._lt_/span_gt__lt_span style_eq__qt_color_dd_#9cdcfe_sm__qt__gt_environmentTexture_lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_ _lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt__eq__lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt_ _lt_/span_gt__lt_span style_eq__qt_color_dd_#9cdcfe_sm__qt__gt_hdrTexture_lt_/span_gt__lt_span style_eq__qt_color_dd_#d4d4d4_sm__qt__gt__sm__lt_/span_gt_\n\t\t\t_lt_/div_gt_\n\t\t_lt_/div_gt_\n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\tYou also want to set the gamma space to false because the DDS file is in linear color space as you exported it as a 32-bit float texture. Rendering it as gamma will cause it to render too dark. I updated your playground and added our test spheres glb so that you can see all of the MIP levels present in the DDS. This is a handy test mesh to use when testing environments as it has all of the roughness values on a chrome sphere which will render all of the MIP levels for you and you can see what breaks.\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tAnother good practice if you are just creating a Babylon.js sphere is to use full white for material base color as that will reflect exactly what the environment texture is. Any other color will bias what  you see and can throw you off when trying to understand what the environment is doing. \n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n_lt_p_gt_\n\tPlease let me know if you have other questions or if any of this doesn_t_t make sense. Take care.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tEdited playground_dd_ _lt_a href_eq__qt_https_dd_//playground.babylonjs.com/#FDQ594%232_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//playground.babylonjs.com/#FDQ594#2_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tRaw source for HDR environment sphere test asset_dd_ _lt_a href_eq__qt_https_dd_//raw.githubusercontent.com/PatrickRyanMS/SampleModels/master/ENV_Spheres/ENV_Spheres.glb_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//raw.githubusercontent.com/PatrickRyanMS/SampleModels/master/ENV_Spheres/ENV_Spheres.glb_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tGithub repo of the test sphere asset_dd_ _lt_a href_eq__qt_https_dd_//github.com/PatrickRyanMS/SampleModels/tree/master/ENV_Spheres_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/PatrickRyanMS/SampleModels/tree/master/ENV_Spheres_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"hcmetal","Date":"2018-09-18T09:33:00Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/20193-sebavan/?do_eq_hovercard_qt_ data-mentionid_eq__qt_20193_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/20193-sebavan/_qt_ rel_eq__qt__qt__gt_@Sebavan_lt_/a_gt_ _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/32589-patrickryan/?do_eq_hovercard_qt_ data-mentionid_eq__qt_32589_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/32589-patrickryan/_qt_ rel_eq__qt__qt__gt_@PatrickRyan_lt_/a_gt__co_ thanks for your help!\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#353c41_sm_font-size_dd_14px_sm_text-align_dd_left_sm__qt__gt_Unchecking _qt_Render ground truth specular using brute force method_qt_ in Lys solves the problem. _lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#353c41_sm_font-size_dd_14px_sm_text-align_dd_left_sm__qt__gt_With both .hdr and .exr format_co_ using brute force method produce broken MIP at level 2._lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#353c41_sm_font-size_dd_14px_sm_text-align_dd_left_sm__qt__gt__lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/32589-patrickryan/?do_eq_hovercard_qt_ data-mentionid_eq__qt_32589_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/32589-patrickryan/_qt_ rel_eq__qt__qt__gt_@PatrickRyan_lt_/a_gt__co_ I have adopted the best practices you recommended and the lighting is much more natural. _lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#353c41_sm_font-size_dd_14px_sm_text-align_dd_left_sm__qt__gt_Thank you for sharing your wisdom and experience._lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_background-color_dd_#ffffff_sm_color_dd_#353c41_sm_font-size_dd_14px_sm_text-align_dd_left_sm__qt__gt_Cheers!_lt_/span_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]