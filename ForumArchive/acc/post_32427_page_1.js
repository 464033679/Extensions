[{"Owner":"Hersir","Date":"2017-08-17T13:09:57Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI have issue that elements created with createInstance sometimes don_t_t show up on screen but exist in memory.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI managed to make small _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#B0F11M%234_qt_ rel_eq__qt_external nofollow_qt__gt_PG_lt_/a_gt_ to show issue. There 2 objects are initialised on click. On first click both instances appear but on next one only second instance appear_co_ after many clicks all instances appear. Sometimes helps to change camera angle to see all meshes.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tDevice_dd_ Galaxy S4\n_lt_/p_gt_\n\n_lt_p_gt_\n\tOS_dd_ Android 4.4.2\n_lt_/p_gt_\n\n_lt_p_gt_\n\tBrowser_dd_ Chrome 59.0.3071.125\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI have seen similar issue also on desktop devices_co_ that instanced meshes disappear and appear back on camera rotation_co_ but that I couldn_t_t reproduce in PG yet.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Hersir","Date":"2017-08-17T13:14:16Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tIn my project instances that were added also were not re-rendered (position and rotation was changed but visually it was the same)\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-08-17T16:03:48Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tUnfortunately I cannot reproduce the issue _lt_img alt_eq__qt__dd_(_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_sad.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/sad@2x.png 2x_qt_ title_eq__qt__dd_(_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Hersir","Date":"2017-08-18T06:14:00Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tYes it can be reproduced with some older android devices.\n_lt_/p_gt_\n\n_lt_p_gt_\n\twebgl version _dd_ {vendor_dd_ _qt_Qualcomm_qt__co_ renderer_dd_ _qt_Adreno (TM) 320_qt__co_ version_dd_ _qt_WebGL 1.0 (OpenGL ES 2.0 Chromium)_qt_}\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Hersir","Date":"2017-08-18T06:20:32Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIt  looks like some rendering issue with instances_co_ as if I start to rotate camera (arcrotate camera)_co_ these invisible meshes start to appear and disappear randomly (probably depending on camera viewport). So they are created correctly  but just are not rendered always. could be some check in renderer that prevents update ?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Hersir","Date":"2017-08-18T10:09:15Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tOk found something new _lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#B0F11M%239_qt_ rel_eq__qt_external nofollow_qt__gt_PG_lt_/a_gt__co_ on click on grey box 2 objects should be added_co_ but after second click only red cylinders are added_co_ but if I zoom camera so that meshes leave camera viewport and than zoom back _co_ all meshes are visible_co_ \n_lt_/p_gt_\n\n_lt_p_gt_\n\tWhat happens when mesh leaves camera viewport and come back? is there some revalidation happening? could be so that at point it is added something is not ready yet ?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-08-18T15:08:28Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI_t_m really sorry but I cannot reproduce it at all _lt_img alt_eq__qt__dd_(_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_sad.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/sad@2x.png 2x_qt_ title_eq__qt__dd_(_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tCan you reproduce it on your computer?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Hersir","Date":"2017-08-18T15:36:35Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tNo only on that android device\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-08-18T15:47:09Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tOk..can you try to turn hardware instance off with engine.getCaps().instancedArrays _eq_ false?\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Hersir","Date":"2017-08-21T05:59:17Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI changed _lt_span style_eq__qt_color_dd_#16a085_sm__qt__gt_hardwareInstancedRendering_lt_/span_gt_ inside _lt_span style_eq__qt_color_dd_#1abc9c_sm__qt__gt_Mesh.prototype.render_lt_/span_gt_ to _lt_span style_eq__qt_color_dd_#1abc9c_sm__qt__gt_false_lt_/span_gt_ and objects appeared as they should.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Hersir","Date":"2017-08-21T09:12:32Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tFound something but probably I am of road_co_ but\n_lt_/p_gt_\n\n_lt_p_gt_\n\tInside _lt_span style_eq__qt_color_dd_#1abc9c_sm__qt__gt_Mesh_lt_/span_gt_ class in method _lt_span style_eq__qt_color_dd_#1abc9c_sm__qt__gt__renderWithInstances_lt_/span_gt_ there is check\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_if (!instancesBuffer || currentInstancesBufferSize !_eq_ this._instancesBufferSize) {\n                \n if (instancesBuffer) {\n   instancesBuffer.dispose()_sm_\n }\n\n instancesBuffer _eq_ new Buffer(engine_co_ this._instancesData_co_ true_co_ 16_co_ false_co_ true)_sm_\n this._instancesBuffer _eq_ instancesBuffer_sm_\n\n this.setVerticesBuffer(instancesBuffer.createVertexBuffer(_qt_world0_qt__co_ 0_co_ 4))_sm_\n this.setVerticesBuffer(instancesBuffer.createVertexBuffer(_qt_world1_qt__co_ 4_co_ 4))_sm_\n this.setVerticesBuffer(instancesBuffer.createVertexBuffer(_qt_world2_qt__co_ 8_co_ 4))_sm_\n this.setVerticesBuffer(instancesBuffer.createVertexBuffer(_qt_world3_qt__co_ 12_co_ 4))_sm_\n } else {\n      instancesBuffer.updateDirectly(this._instancesData_co_ 0_co_ instancesCount)_sm_\n }_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tNormally on first call it goes in first block and after in in second till buffer changes.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tlooks like if _lt_span style_eq__qt_color_dd_#1abc9c_sm__qt__gt_this.setVerticesBuffer_lt_/span_gt_ is called in _lt_span style_eq__qt_color_dd_#16a085_sm__qt__gt_else_lt_/span_gt_ block it fixes the issue (need just 1 call _co_ any 1 of 4)_sm_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tFor example_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_else {\n   this.setVerticesBuffer(this._instancesBuffer.createVertexBuffer(_qt_world0_qt__co_ 0_co_ 4))_sm_\n   instancesBuffer.updateDirectly(this._instancesData_co_ 0_co_ instancesCount)_sm_\n}_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-08-21T17:29:21Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\twe cannot create a new vertex buffer on every call unfortunately. This really looks like a weird browser bug to me\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Hersir","Date":"2017-08-22T07:53:14Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tOK will leave it for now_co_ if someone finds why it  is not refreshed_co_ before mesh leaves viewport_co_ feel free to report here\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]