[{"Owner":"Snouto","Date":"2018-07-04T01:44:12Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tAlright errybody\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThis is a question more about maths than anything else_co_ and i_t_m terrible at maths so I_t_m hoping someone (maybe _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/5733-wingnut/?do_eq_hovercard_qt_ data-mentionid_eq__qt_5733_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/5733-wingnut/_qt_ rel_eq__qt__qt__gt_@Wingnut_lt_/a_gt_) can help me here.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tMy scene is loaded from a blender export_co_ which in itself is partially an imported FBX from C4D (still waiting on that C4D exporter boys!).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI have a mesh within the scene that has a set position_co_ and I want to allow it to orbit in a circle when clicked or tapped by the user. Fundamentally this is fine and I have most of the logic in place_co_ but I_t_m struggling to figure out how to make it animate from it_t_s initial position. All of the example code I_t_ve seen make the object jump to a calculated first position and then animate_co_ which is not what I want. Has anyone got some sweet ninja code that I can _lt_s_gt_borrow_lt_/s_gt_ steal that will do what I need?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAdditionally is there a convenient technique or built in method to add easing to the beginAnimation call_co_ or to the calculated keyframes?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tCheers!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHere_t_s my current code_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_var onMeshPicked _eq_ function(bjsEvent) {\n    myPickedMesh _eq_ bjsEvent.source_sm_\n\n\tvar frames _eq_ 90_sm_ // number of points\n\n    var parent _eq_ myPickedMesh.parent_sm_\n    parent.indexPoint _eq_ 0_sm_\n    var p_eq_0_sm_\n\n    var points _eq_ []_sm_\n\n    var radius _eq_ 2_sm_\n\tfor (var i _eq_ 0_sm_ i &lt_sm_ frames_sm_ i++) {\n        // calculate the keyframes\n\t    points.push( new BABYLON.Vector3((radius + Math.sin(i*Math.PI/frames))* Math.cos(2*i*Math.PI/frames)_co_ parent.position.y_co_ ( radius + Math.sin(i*Math.PI/frames)) * Math.sin(2*i*Math.PI/frames)))_sm_\n\t}\n\n\tparent.points_eq_points_sm_\n\tvar path3d _eq_ new BABYLON.Path3D(points)_sm_\n    var tangents _eq_ path3d.getTangents()_sm_  //array of tangents to the curve\n    var normals _eq_ path3d.getNormals()_sm_ //array of normals to the curve\n    var binormals _eq_ path3d.getBinormals()_sm_ //array of binormals to curve\n\n\tparent.animationPosition _eq_ new BABYLON.Animation(_qt_animPos_qt__co_ _qt_position_qt__co_ 30_co_ BABYLON.Animation.ANIMATIONTYPE_VECTOR3_co_ BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE)_sm_\n\tparent.animationRotation _eq_ new BABYLON.Animation(_qt_animRot_qt__co_ _qt_rotationQuaternion_qt__co_ 30_co_ BABYLON.Animation.ANIMATIONTYPE_QUATERNION_co_ BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE)_sm_\t\n\n    var keysPosition _eq_ []_sm_ \n    var keysRotation _eq_ []_sm_\n\n    for(i _eq_ 0_co_p_eq_frames_sm_ i &lt_sm_ p_sm_ i++) {\n        keysPosition.push({\n            frame_dd_ i_co_\n            value_dd_ parent.points[i]\n        })_sm_\n\n        keysRotation.push({\n            frame_dd_ i_co_\n            value_dd_ BABYLON.Quaternion.RotationQuaternionFromAxis(normals[i]_co_ binormals[i]_co_ tangents[i])\n        })_sm_\n    }\n\n    parent.animationPosition.setKeys(keysPosition)_sm_\n    parent.animationRotation.setKeys(keysRotation)_sm_\n\t\n    scene.beginDirectAnimation(parent_co_ [parent.animationPosition_co_parent.animationRotation]_co_  0_co_ frames_co_ false_co_ 0.25_co_null)_sm_\n\n}_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tÂ \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"brianzinn","Date":"2018-07-04T04:23:57Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_220385_qt_ data-ipsquote-contentid_eq__qt_38613_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1530668652_qt_ data-ipsquote-userid_eq__qt_29888_qt_ data-ipsquote-username_eq__qt_Snouto_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t2 hours ago_co_ Snouto said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tAdditionally is there a convenient technique or built in method to add easing to the beginAnimation call_co_ or to the calculated keyframes?\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tYes_co_ see how the easing function is attached to the animation.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI don_t_t know if it qualifies as ninja code_co_ but you can chain the animations.Â  So_co_ first move the mesh using an easing function and once it_t_s in the position you want (onAnimationEnd function is called)Â then you can run the second animation._lt_br /_gt_\n\t_lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#8BYZ34_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#8BYZ34_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Snouto","Date":"2018-07-04T04:38:09Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_220389_qt_ data-ipsquote-contentid_eq__qt_38613_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1530678237_qt_ data-ipsquote-userid_eq__qt_25365_qt_ data-ipsquote-username_eq__qt_brianzinn_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t14 minutes ago_co_ brianzinn said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tYes_co_ see how the easing function is attached to the animation.\n\t\t_lt_/p_gt_\n\n\t\t_lt_p_gt_\n\t\t\tI don_t_t know if it qualifies as ninja code_co_ but you can chain the animations.Â  So_co_ first move the mesh using an easing function and once it_t_s in the position you want (onAnimationEnd function is called)Â then you can run the second animation._lt_br /_gt_\n\t\t\t_lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#8BYZ34_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#8BYZ34_lt_/a_gt_\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p style_eq__qt_color_dd_#000000_sm__qt__gt_\n\t_lt_span_gt_Thanks dude_co_ that easing code is exactly what I was looking for. And now that I_t_ve seen it I realise I_t_ve used it before in one of my other hundred test scriptsÂ _lt_span class_eq__qt_ipsEmoji_qt__gt_ðŸ™„_lt_/span_gt__lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p style_eq__qt_color_dd_#000000_sm__qt__gt_\n\t_lt_span_gt_Following on from my test code I_t_ve been searching around more and found an article on pivot points. My code now looks like this_dd__lt_/span_gt_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_var onMeshPicked _eq_ function(bjsEvent) {\n\tmyPickedMesh _eq_ bjsEvent.source_sm_\n\tif(!myPickedMesh.isPickable) return_sm_\n\n\tvar frames _eq_ 90_sm_ // number of points\n\n\tif( parent_eq__eq__eq_null ){\n\t    parent _eq_ myPickedMesh.parent_sm_\n\t    var CoR_At _eq_ new BABYLON.Vector3(0_co_ parent.position.y_co_ 0)_sm_\n\t\t\tvar axis _eq_ BABYLON.Vector3.Up()_sm_\n\t\t\tvar pilotStart _eq_ new BABYLON.Vector3(parent.position.x_co_parent.position.y_co_parent.position.z)_sm_\n\t\t\tpivot _eq_ new BABYLON.TransformNode(_qt_root_qt_)_sm_\n\t\t  pivot.position _eq_ CoR_At_sm_ \n\t\t  parent.parent _eq_ pivot_sm_\n\t\t\tparent.position.y _eq_ 1.7657999992370605_sm_\n\t\t  var angle _eq_ 0.01_sm_\n\t\n\t\tparent.yRot _eq_ new BABYLON.Animation(_qt_yRot_qt__co_ _qt_rotation.y_qt__co_ 30_co_ BABYLON.Animation.ANIMATIONTYPE_FLOAT_co_ BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE)_sm_\n\n\t\tvar keyFramesR _eq_ []_sm_ \n\n\t\tkeyFramesR.push({\n\t\t   frame_dd_ 0_co_\n\t\t   value_dd_ 0\n\t\t})_sm_\n\n\t\tkeyFramesR.push({\n\t\t   frame_dd_ 2 * frames_co_\n\t\t   value_dd_ 2 * Math.PI\n\t\t})_sm_\n\n\t\tparent.yRot.setKeys(keyFramesR)_sm_\n\t\tvar easingFunction _eq_ new BABYLON.QuarticEase()_sm_\n\t\teasingFunction.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEINOUT)_sm_\n\t\tparent.yRot.setEasingFunction(easingFunction)_sm_\n\t}\n\n\tscene.beginDirectAnimation(pivot_co_ [parent.yRot]_co_  0_co_ 2*frames_co_ false)_sm_\n}_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tThat line_dd_Â parent.position.y _eq_ 1.7657999992370605_sm_ is my wacky attempt to adjust the position of the mesh once it is parented to the pivot_co_ because as soon as that happens the mesh position changes. It may well be due to the parent mesh being over sizedÂ in the blender model due to wanting to avoid recalculating the baked animation (which was done before being parented)_co_ but I_t_ve struggled to figure out what that Y figure should be since there doesn_t_t appear to be an obvious correlation to the new position that I can see.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"brianzinn","Date":"2018-07-04T07:32:19Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_220392_qt_ data-ipsquote-contentid_eq__qt_38613_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1530679089_qt_ data-ipsquote-userid_eq__qt_29888_qt_ data-ipsquote-username_eq__qt_Snouto_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t2 hours ago_co_ Snouto said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tThat line_dd_Â parent.position.y _eq_ 1.7657999992370605_sm_ is my wacky attempt to adjust the position of the mesh once it is parented to the pivot_co_\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tI can_t_t see your code running_co_ but I would imagine that parent.setParent(pivot) might end up fixing your issue (instead of parent.parent Â _eq_ pivot).Â  Otherwise probably best to break this into a Playground?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Snouto","Date":"2018-07-04T07:38:31Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_220402_qt_ data-ipsquote-contentid_eq__qt_38613_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1530689539_qt_ data-ipsquote-userid_eq__qt_25365_qt_ data-ipsquote-username_eq__qt_brianzinn_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t7 minutes ago_co_ brianzinn said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tI can_t_t see your code running_co_ but I would imagine that parent.setParent(pivot) might end up fixing your issue (instead of parent.parent Â _eq_ pivot).Â  Otherwise probably best to break this into a Playground?\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tDing ding ding ding we have a winner! That fixed the problem immediately. That_t_s both super satisfying and incredible perplexing and frustrating at the same time. Just when you think you_t_re getting a handle on BJS something like this occupies half your day!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWell I appreciate your help there _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/25365-brianzinn/?do_eq_hovercard_qt_ data-mentionid_eq__qt_25365_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/25365-brianzinn/_qt_ rel_eq__qt__qt__gt_@brianzinn_lt_/a_gt_Â you managed to solve two big issues for me and now the animation works as planned. Cheers!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2018-07-04T07:59:33Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_220403_qt_ data-ipsquote-contentid_eq__qt_38613_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1530689911_qt_ data-ipsquote-userid_eq__qt_29888_qt_ data-ipsquote-username_eq__qt_Snouto_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\tOn 7/4/2018 at 2_dd_38 AM_co_ Snouto said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tsomething like this occupies half your day\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\thehe.Â  I once had a scene issue... occupy 5 months!Â  (but _lt_em_gt_some _lt_/em_gt_of that time was spent in Tibet_co_ learning how to meditate in 3D from Buddhist monks).Â  _lt_img alt_eq__qt__sm_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_wink.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/wink@2x.png 2x_qt_ title_eq__qt__sm_)_qt_ width_eq__qt_20_qt_ /_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI needed a vector3 direction_co_ based upon the rotationQuaternion of a mesh.Â  Spacecraft... roll it a few degrees around z-axis with physics-based rotation thrusters (quaternion)... then stop.Â  Now get the direction needed to thrust (applyImpulse) the spacecraft perfectly sideways (localSpace_co_ ie.Â  When sitting in pilot_t_s seat.)Â  erf.Â \n_lt_/p_gt_\n\n_lt_p_gt_\n\tIt took a matrix transformToNormal thing.Â  The most difficult part was... describing it in a way that others understood what I wished-for.Â  I didn_t_t have the terminology mastered enough... to know how to ask.Â  Weird phenomena.Â  _lt_span_gt__lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_ It took 3 lines of code._lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tNeedless to say_co_ a significant party happened when the issue was solved... thx to DeltakoshÂ  (It was the 4th time I tried to explain to forum-folk... what I needed).Â \n_lt_/p_gt_\n\n_lt_p_gt_\n\tDK did just like BrianZinn did to you_co_ Snouto.Â  _qt_It sounds like you need this_qt_ ... &lt_sm_something&gt_sm_&lt_sm_something&gt_sm_&lt_sm_something&gt_sm_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThat was it.Â  A few playground and docs searches later... my physics-active spacecraft started acting perfect.Â  The angels rejoiced.Â  The sun came out.Â  The flowers bloomed.Â  And my dog jumped up on my lap and started licking my face.Â  Everyone and everything sensed... something wonderful had happened.Â  _lt_span_gt__lt_span_gt__lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/span_gt__lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI gold-plated those 3 lines of code and they are hanging on the wall here in my puter room.Â  _lt_span_gt__lt_img alt_eq__qt__dd_D_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ title_eq__qt__dd_D_qt_ width_eq__qt_20_qt_ /_gt__lt_/span_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]