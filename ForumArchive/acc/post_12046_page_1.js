[{"Owner":"iiceman","Date":"2015-01-27T22:50:01Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Howdy_co__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt__lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#11DXRI_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#11DXRI_lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_This is the main problem from the other thread about moving with collisions. Ray casting just doesn_t_t seem to work right as soon as the mesh is scaled (along the y axis?). This really seems like a bug to me ... or I am doing something horribly wrong here _dd_-/_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Can that be fixed somehow?_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Temechon","Date":"2015-01-28T07:29:23Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi_co_ _lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_It_t_s really weird because the pickedMesh is indeed the box... I_t_ve been trying to compute the mesh world matrix_co_ but nothing seems to change._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"iiceman","Date":"2015-01-28T08:07:35Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Yeah_co_ weird_co_ eh? I think I tried that_co_ too. Well_co_ it works if you reference the pickedMesh... but for pickedPoint to really get the point on the surface it_t_s somehow messed up. Would be cool if you find a reason for that _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ alt_eq__qt__dd_D_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt_ Thanks for the help!_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"RaananW","Date":"2015-01-28T12:40:58Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_The problem is in the abstractMesh intersects function - line 837 _dd__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_var worldDirection _eq_ BABYLON.Vector3.TransformNormal(direction_co_ world)_sm__lt_/pre_gt__lt_p_gt_actually_co_ the direction vector is already correct (And I believe_co_already in world coordinates_co_ as it is being calculated using the actual distance between the points)_co_ this shouldn_t_t be calculated. If you remove this line (or skip it in the debugger _dd_-) ) everything works as expected. _lt_/p_gt__lt_p_gt_So_co_ a quick fix would be removing all references to worldDirection and changing them to direction_co_ or changing this line to_dd__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_var worldDirection _eq_ direction_sm__lt_/pre_gt__lt_p_gt_Which is kind_t_a redundant _dd_-) _lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_As this is the first time this error appears_co_ I am not sure this is a bug (well_co_ it is_co_ but is removing this line of code leaves everything else intact?)._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_This requires further testing._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2015-01-28T17:22:27Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Direction is coming from ray.direction so he is in local space_lt_/p_gt__lt_p_gt_we need to return it to global space hence the transofrmation with worldMatrix_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_So I have a bug somewhere else_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I_t_ll check this quickly!_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"RaananW","Date":"2015-01-28T18:50:40Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Isn_t_t the ray being transformed to world coordinates in the pickWithRay function (actually inverted)?_lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_world.invertToRef(this._pickWithRayInverseMatrix)_sm_return Ray.Transform(ray_co_ this._pickWithRayInverseMatrix)_sm__lt_/pre_gt__lt_p_gt_because the direction the the scaled case was actually 0_co_-2_co_0 and not the given 0_co_-1_co_0. This is why I thought it is in world coordinates. The direction variable is also being recalculated using the distance from the intersection function (which is correct) as a scale._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2015-01-28T20:07:02Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_OK fixed it. For some reasons I added a normalize which obviously was not required_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Fixed with next push_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"iiceman","Date":"2015-01-28T21:59:54Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_SWEET! Thanks a lot! _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ alt_eq__qt__dd_D_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2015-01-29T00:58:53Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Nice anomaly/bug find_co_ iicepuppy!  And a darned good job investigating it... to determine it was scaling-related.  And then _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#11DXRI_qt_ rel_eq__qt_external nofollow_qt__gt_a swell playground_lt_/a_gt_ proving it (which now works fine).  And thanks for the framework fix_co_ DK!  You guys rock!_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]