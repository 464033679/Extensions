[{"Owner":"binyan","Date":"2014-07-06T19:00:03Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_I_t_m using a custom material which is pretty similar to the ground material used in WorldMonger demo._lt_/p_gt__lt_p_gt_The problem is that I don_t_t get a shadows on it. Well it_t_s not a big surprise_co_ because I_t_m overriding the _effect property of the base material._lt_/p_gt__lt_p_gt_The question is how can I get both my effect with a base material effect without copy-pasting the code from base material._lt_/p_gt__lt_p_gt_I mean how can I get shadows while using additional effects?_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-07-07T00:15:59Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_If you want shadows in your own shader_co_ you have to use the light.getShadowGenerator()._lt_span style_eq__qt_color_dd_rgb(51_co_51_co_51)_sm_font-family_dd_Consolas_co_ _t_Liberation Mono_t__co_ Menlo_co_ Courier_co_ monospace_sm_font-size_dd_12px_sm__qt__gt_getShadowMap() shadowMap_lt_/span_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt__lt_span style_eq__qt_color_dd_rgb(51_co_51_co_51)_sm_font-family_dd_Consolas_co_ _t_Liberation Mono_t__co_ Menlo_co_ Courier_co_ monospace_sm_font-size_dd_12px_sm__qt__gt_Then do like in this shader_dd__lt_/span_gt__lt_/p_gt__lt_p_gt__lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/Babylon/Shaders/default.fragment.fx_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/Babylon/Shaders/default.fragment.fx_lt_/a_gt__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_float computeShadow(vec4 vPositionFromLight_co_ sampler2D shadowSampler_co_ float darkness){\tvec3 depth _eq_ vPositionFromLight.xyz / vPositionFromLight.w_sm_\tvec2 uv _eq_ 0.5 * depth.xy + vec2(0.5_co_ 0.5)_sm_\tif (uv.x &lt_sm_ 0. || uv.x &gt_sm_ 1.0 || uv.y &lt_sm_ 0. || uv.y &gt_sm_ 1.0)\t{\t\treturn 1.0_sm_\t}\tfloat shadow _eq_ unpack(texture2D(shadowSampler_co_ uv))_sm_\tif (depth.z &gt_sm_ shadow)\t{\t\treturn darkness_sm_\t}\treturn 1._sm_}_lt_/pre_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"binyan","Date":"2014-07-07T08:15:07Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_So as I understand there is no way to combine shaders? If I want to use 2 shaders I must create a new one which implements their both functionality?_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-07-08T01:46:59Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Yep this is correct_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jCarrasco","Date":"2016-01-08T20:50:32Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi_co__lt_/p_gt__lt_p_gt_Following this topic_co_ I_t_m trying to get shadows in my custom shader_co_ but can_t_t manage to make it work._lt_/p_gt__lt_p_gt_I setup a shadowGenerator and add the mesh to the render list. It know it works ok because with a StandardMaterial I can see the shadows._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_With my ShaderMaterial_co_ I pass a mat4 lightMatrix0_co_ a sampler2D shadowSampler0 and a vec3 shadowsInfo0 (I only want one light)_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I feed this data in the next way_dd__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_customMaterial.setTexture(_qt_shadowSampler0_qt__co_ light.getShadowGenerator().getShadowMapForRendering())_sm_customMaterial.setMatrix(_qt_lightMatrix0_qt__co_ light.getShadowGenerator().getTransformMatrix())_sm_customMaterial.setVector3(_qt_shadowsInfo0_qt__co_ light.getShadowGenerator().getDarkness()_co_ light.getShadowGenerator().getShadowMap().getSize().width_co_ light.getShadowGenerator().bias)_sm__lt_/pre_gt__lt_p_gt_With this uniforms I feed the computeShadow function_co_ as in the default shader code._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I have tested lightMatrix0 and shadowsInfo0 have the correct values. But nothing is displaying. The returned value of computeShadow is always 1.0_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Any idea on what am I missing? I have tried with .getShadowMapForRendering() and getShadowMap() and nothing works._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Any clue?_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jCarrasco","Date":"2016-01-09T22:12:26Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt__lt_img src_eq__qt_http_dd_//s27.postimg.org/4wujqprf7/snap.jpg_qt_ alt_eq__qt_snap.jpg_qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_By the way_co_ this is what I get from getShadowMap(). Shouldn_t_t it look more like a depth map?_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"igitz","Date":"2017-12-05T12:47:17Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tsorry to dig this up_co_ but is this issue solved?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tis there a working example? the provided link does not work _lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/Babylon/Shaders/default.fragment.fx_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/Babylon/Shaders/default.fragment.fx_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"NasimiAsl","Date":"2017-12-05T12:51:03Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\thi _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/29444-igitz/?do_eq_hovercard_qt_ data-mentionid_eq__qt_29444_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/29444-igitz/_qt_ rel_eq__qt__qt__gt_@igitz_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\twe r on it this is happen after we get new typescript (npm) and we see some error in custom material that maybe take a time for ready new version of custom material \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-12-05T16:55:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tIt is now fixed _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt_1_qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt__gt__lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#3WN9C6#5_qt_ ipsnoembed_eq__qt_true_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#3WN9C6#5_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"NasimiAsl","Date":"2017-12-05T19:25:54Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\treally thanks \n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]