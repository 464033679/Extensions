[{"Owner":"eljuko","Date":"2017-03-21T11:13:27Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHello everyone_co_ long time no see!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSo i_t_v ran to an issue where i_t_m trying to attach meshes to bones from another import.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI_t_v this torso which is built from 2 meshes and this torso assembly holds the skeleton. Then i_t_v another model and when i_t_m trying to place the import directly to head bone for example the model flips around Z axis and goes somewhere it doesn_t_t really belong.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI_t_v attached an image which hopefully explains more than my english does _lt_img alt_eq__qt__dd_D_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ title_eq__qt__dd_D_qt_ width_eq__qt_20_qt_ /_gt_ What i_t_m doing wrong? any ideas?\n_lt_/p_gt_\n\n_lt_p_gt_\n\t- best regards_co_ eljuko\n_lt_/p_gt_\n\n_lt_p_gt__lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_03/issue_with_atttachToBone.png.153711544b8684c34f365821a9590bdf.png_qt_ class_eq__qt_ipsAttachLink ipsAttachLink_image_qt__gt__lt_img data-fileid_eq__qt_12141_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_03/issue_with_atttachToBone.thumb.png.cabfc437e29978b4e3423fc95b1b948b.png_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ alt_eq__qt_issue_with_atttachToBone.png_qt__gt__lt_/a_gt__lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Dad72","Date":"2017-03-21T11:43:24Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI think the fact of using getMeshByName followed attachToBone fact hard time. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe engine must search the mesh before attaching.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThis can be faster_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_var mesh _eq_ scene.getMeshByName(_qt_industrial_body_bottom_qt_)_sm_\nmesh.attachToBone(actor.skeleton.bones[actor.skeleton.getBoneIndexByName(_qt_boneName_qt_)]_co_ actor)_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tOr\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIf you could have the mesh directly without using getMeshByName. it would go faster still._lt_br /_gt_\n\tas the bone_co_ if you know the bone index_co_ it will be faster than using getBoneIndexByName ().\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe skeleton also_co_ if you could get it faster than going through scene.skeleton [0] I guess it would go quicker.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tand there is a second parameter which is attacheToBone the mesh or this is the Skeleton can also accelerate.\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_mesh.attachToBone(actor.skeleton.bones[0]_co_ actor)_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tIf you must use getMeshByName_co_ use it to load the game and you can then use in-game_co_ but it will be already in memory_co_ thus faster to use.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"eljuko","Date":"2017-03-21T12:12:18Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tThanks for the answer_co_ i doubt that_t_s the issue quite yet. I_t_m currently at the state where i_t_v just imported the models and i just want to know how to attach the meshes to bones in right locations without errors _lt_img alt_eq__qt__dd_D_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ title_eq__qt__dd_D_qt_ width_eq__qt_20_qt_ /_gt_ optimization will become handy a bit later_co_ and this is much more clear to me thanks to you _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_ \n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"eljuko","Date":"2017-03-21T13:50:51Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tNo one? Ok_co_ lets put it this way_co_ is there something wrong in the workflow or in import snippet? now i get error that HEAD is undefined _dd_E Please note this is really simplified.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tMaybe i_t_m missing something important.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_\tvar canvas _eq_ document.getElementById(_qt_renderCanvas_qt_)_sm_\n\n\tvar engine _eq_ new BABYLON.Engine(canvas_co_ true)_sm_\n\n\tvar createScene _eq_ function () {\n\t\tvar scene _eq_ new BABYLON.Scene(engine)_sm_\n\t\tscene.clearColor _eq_ new BABYLON.Color3( 23 / 255_co_ 20 / 255_co_ 14/255)_sm_\n\t\tscene.fogMode _eq_ BABYLON.Scene.FOGMODE_LINEAR_sm__sm_\n\t\tscene.fogColor _eq_ new BABYLON.Color3( 23 / 255_co_ 20 / 255_co_ 14/255)_sm_\n\t\tscene.fogDensity _eq_ 1_sm_\n\t\tscene.fogStart _eq_ 5.0_sm_\n\t\tscene.fogEnd _eq_ 30.0_sm_\n\n\t\tvar camera _eq_ new BABYLON.FreeCamera(_qt_camera1_qt__co_ new BABYLON.Vector3(2_co_ 3_co_ -9)_co_ scene)_sm_\n\t\tcamera.setTarget(new BABYLON.Vector3(0_co_3_co_0))_sm_\n\n\t\tvar light _eq_ new BABYLON.DirectionalLight(_qt_dir1_qt__co_ new BABYLON.Vector3(-1_co_ -2_co_ -1)_co_ scene)_sm_\n\t\tlight.position _eq_ new BABYLON.Vector3(20_co_ 40_co_ 20)_sm_\n\t\tlight.intensity _eq_ 1_sm_\n\n\t\tvar light2 _eq_ new BABYLON.SpotLight(_qt_spot1_qt__co_ new BABYLON.Vector3(30_co_ 40_co_ 20)_co_ new BABYLON.Vector3(-1_co_ -2_co_ -1)_co_ 1.1_co_ 16_co_ scene)_sm_\n\t\tlight2.intensity _eq_ 0.5_sm_\n\n\t\tvar shadowGenerator _eq_ new BABYLON.ShadowGenerator(2048_co_ light)_sm_\n\n\n\t\tvar TORSO_sm_\n\t\tvar HEAD_sm_\n\t\tvar SKELETOR_sm_\n\n\t\tBABYLON.SceneLoader.ImportMesh(_qt__qt__co_ _qt_assets/models/sample/_qt__co_ _qt_TORSO_INDUSTRIAL.babylon_qt__co_ scene_co_ function (newMeshes_co_ particleSystems_co_ skeletons){\n\t\t\tTORSO _eq_ newMeshes_sm_\n\t\t\tSKELETOR _eq_ skeletons[0]_sm_\n\t\t\tfor(i _eq_ 0_sm_ i &lt_sm_ TORSO.length_sm_ i++){\n\t\t\t\tTORSO[i].material.specularPower _eq_ 0_sm_\n\t\t\t\tTORSO[i].material.specularColor _eq_ new BABYLON.Color3(0_co_ 0_co_ 0)_sm_\n\t\t\t\tTORSO[i].material.diffuseColor _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm_\n\t\t\t\tTORSO[i].material.emissiveColor _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm_\n\t\t\t\tshadowGenerator.getShadowMap().renderList.push(TORSO[i])_sm_\n\t\t\t\tTORSO[i].material.wireframe _eq_ true_sm_\n\n\t\t\t}\n\t\t})_sm_\n\n\t\tBABYLON.SceneLoader.ImportMesh(_qt__qt__co_ _qt_assets/models/sample/_qt__co_ _qt_HEAD_INDUSTRIAL.babylon_qt__co_ scene_co_ function (newMesh){\n\t\t\tHEAD _eq_ newMesh[0]_sm_\n\t\t\tHEAD.material.specularPower _eq_ 0_sm_\n\t\t\tHEAD.material.specularColor _eq_ new BABYLON.Color3(0_co_ 0_co_ 0)_sm_\n\t\t\tHEAD.material.diffuseColor _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm_\n\t\t\tHEAD.material.emissiveColor _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm_\n\t\t\tshadowGenerator.getShadowMap().renderList.push(HEAD)_sm_\n\t\t})_sm_\n\n\t\tHEAD.attachToBone(SKELETOR.bones[2])_sm_\n\n\t\tshadowGenerator.useVarianceShadowMap _eq_ true_sm_\n\t\tvar material1 _eq_ new BABYLON.StandardMaterial(_qt_texture1_qt__co_ scene)_sm_\n\t\tmaterial1.diffuseTexture _eq_ new BABYLON.Texture(_qt_assets/models/sample/sand.png_qt__co_ scene)_sm_\n\t\tmaterial1.diffuseTexture.uScale _eq_ 500.0_sm_\n\t\tmaterial1.diffuseTexture.vScale _eq_ 500.0_sm_\n\n\t\tvar plane _eq_ BABYLON.Mesh.CreatePlane(_qt_plane_qt__co_ 1000.0_co_ scene)_sm_\n\t\tplane.rotation.x +_eq_ Math.PI / 2_sm_\n\t\tplane.material _eq_ material1_sm_\n\t\tplane.receiveShadows _eq_ true_sm_\n\n\t\treturn scene_sm_\n\t}_sm_\n\n\tvar scene _eq_ createScene()_sm_\n\n\tengine.runRenderLoop(function(){\n\t\t//Do stuff\n\t\tscene.render()_sm_\n\t})_sm_\n\n\twindow.addEventListener(_qt_resize_qt__co_ function () {\n\t\tengine.resize()_sm_\n\t})_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Dad72","Date":"2017-03-21T14:03:25Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThat_t_s because you call attachToBone before the object Import HEAD and SKELETOR is loaded.\n_lt_/p_gt_\n\n_lt_p_gt_\n\ttry _dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_scene.executeWhenReady(function () {\n    HEAD.attachToBone(SKELETOR.bones[2])_sm_\n})_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tOr\n_lt_/p_gt_\n\n_lt_p_gt_\n\tuse a variable to check that everything is loaded and the rendering loop run attachToBone making sure it runs only once._lt_br /_gt_\n\tBut I would prefer the first method with executeWhenReady\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"eljuko","Date":"2017-03-21T14:08:57Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThanks Dad_co_ definetly going forward now. executeWhenReady did the trick and the awkward part was that i never ran across with it earlier _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_ u learn something new everyday!\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]