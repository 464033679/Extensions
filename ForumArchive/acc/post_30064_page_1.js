[{"Owner":"jdurrant","Date":"2017-04-27T14:47:57Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI have a Blender test scene with two objects. One is a complex _qt_tube_co__qt_ and the other is a high-resolution test cube.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_12753_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_04/1.png.0c37855514adc61bbd1a49d422f01b69.png_qt_ alt_eq__qt_1.png.0c37855514adc61bbd1a49d422f01b69.png_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tBoth have UVs. The test cube has 58_co_984 verts_co_ and the tube has 62_co_808 verts. So both come in under the ~65_co_500 limit for exporting as a single mesh.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWhen I export using the Babylon.js ver 5.2.1 exporter_co_ the test cube is exported as a single mesh_co_ but the tube is divided into multiple meshes. The log file suggests there are far more tube verts that Blender reports_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_Exporter version_dd_ 5.2.1_co_ Blender version_dd_ 2.78 (sub 0)\n_eq__eq__eq__eq__eq__eq__eq__eq__eq_ Conversion from Blender to Babylon.js _eq__eq__eq__eq__eq__eq__eq__eq__eq_\n\tScene settings used_dd_\n\t\tselected layers only_dd_  false\n\t\tflat shading entire scene_dd_  false\n\t\tinline textures_dd_  false\n\t\ttexture directory_dd_  /Users/jdurrant/Documents/Work/durrant_git/protein-vr/webapp/scenes/influenza/\n\tPython World class constructor completed\n\tprocessing begun of mesh_dd_  Cube\n\t\tprocessing begun of Standard material_dd_  Material\n\t\tnum positions      _dd_  63245\n\t\tnum normals        _dd_  63245\n\t\tnum uvs            _dd_  126490\n\t\tnum uvs2           _dd_  0\n\t\tnum colors         _dd_  0\n\t\tnum indices        _dd_  353892\n\tprocessing begun of mesh_dd_  NA_patch_single_tube\n\t\tprocessing begun of Standard material_dd_  Material.003\n\t\tnum positions      _dd_  65534\n\t\tnum normals        _dd_  65534\n\t\tnum uvs            _dd_  131068\n\t\tnum uvs2           _dd_  0\n\t\tnum colors         _dd_  0\n\t\tnum indices        _dd_  107769\n\tWARNING_dd_ The following mesh has exceeded the maximum # of vertex elements &amp_sm_ will be broken into multiple Babylon meshes_dd_ NA_patch_single_tube\n\tprocessing begun of mesh_dd_  NA_patch_single_tube1\n\t\tregistered as also a user of material_dd_  Material.003\n\t\tnum positions      _dd_  65535\n\t\tnum normals        _dd_  65535\n\t\tnum uvs            _dd_  131070\n\t\tnum uvs2           _dd_  0\n\t\tnum colors         _dd_  0\n\t\tnum indices        _dd_  107043\n\tprocessing begun of mesh_dd_  NA_patch_single_tube2\n\t\tregistered as also a user of material_dd_  Material.003\n\t\tnum positions      _dd_  65533\n\t\tnum normals        _dd_  65533\n\t\tnum uvs            _dd_  131066\n\t\tnum uvs2           _dd_  0\n\t\tnum colors         _dd_  0\n\t\tnum indices        _dd_  125214\n\tprocessing begun of mesh_dd_  NA_patch_single_tube3\n\t\tregistered as also a user of material_dd_  Material.003\n\t\tnum positions      _dd_  21593\n\t\tnum normals        _dd_  21593\n\t\tnum uvs            _dd_  43186\n\t\tnum uvs2           _dd_  0\n\t\tnum colors         _dd_  0\n\t\tnum indices        _dd_  29625\n\tprocessing begun of camera (FreeCamera)_dd_  cmra\n_eq__eq__eq__eq__eq__eq__eq__eq__eq_ Writing of scene file started _eq__eq__eq__eq__eq__eq__eq__eq__eq_\n_eq__eq__eq__eq__eq__eq__eq__eq__eq_ Writing of scene file completed _eq__eq__eq__eq__eq__eq__eq__eq__eq_\n_eq__eq__eq__eq__eq__eq__eq__eq__eq_ end of processing _eq__eq__eq__eq__eq__eq__eq__eq__eq_\nelapsed time_dd_  0 min_co_ 16.3766 secs\n_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tWhen I view the scene in the browser_co_ it ends up looking checkered (perhaps related)_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_04/2.png.ae016b4f5b0d16ffbd461268766b0dbf.png_qt_ data-fileid_eq__qt_12754_qt_ rel_eq__qt__qt__gt__lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_12754_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_04/2.thumb.png.7b060f0da42e654d73492cc7e995d513.png_qt_ alt_eq__qt_2.thumb.png.7b060f0da42e654d73492cc7e995d513.png_qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks so much for your help!\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JCPalmer","Date":"2017-04-27T16:07:25Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThe problem is that in order to re-use a vertex with multiple triangle faces_co_ not only do they need to share the same position_co_ but also same normal_co_ UV_co_ vertex color_co_ &amp_sm_ matrix weights if being used.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tCannot comment on the alternating pattern.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-04-27T17:41:38Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tFor the alternating pattern_co_ are you using a texture? or is it just a plain material\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jdurrant","Date":"2017-04-28T01:03:36Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThanks for your help_co_ guys. So re. the vertex count_co_ I_t_m guessing it_t_s because of the mesh_t_s complexity. Different UV coordinates had to be assigned to the same vertices. What a mess!\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_04/1.png.000b5e4a877008559ee843bae30937a2.png_qt_ data-fileid_eq__qt_12759_qt_ rel_eq__qt__qt__gt__lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_12759_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_04/1.thumb.png.2d9e518cd3ca8baf84d2ae9c3e050a5c.png_qt_ alt_eq__qt_1.thumb.png.2d9e518cd3ca8baf84d2ae9c3e050a5c.png_qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tDo you agree that that_t_s the culprit_co_ then?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tRe. the material_co_ it is the standard material with an ambient texture. Here_t_s the gist_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_var mat _eq_ new BABYLON.StandardMaterial(_qt_some_name_qt__co_ scene)_sm_\nmat.diffuseColor _eq_ new BABYLON.Color3(0_co_ 0_co_ 0)_sm_  // to make shadeless\nmat.emissiveColor _eq_ new BABYLON.Color3({some_val}_co_ {some_val}_co_ {some_val})_sm_\nmat.specularColor _eq_ new BABYLON.Color3({some_val}_co_ {some_val}_co_ {some_val})_sm_\nmat.ambientTexture _eq_ new BABYLON.Texture(_qt_shadow.png_qt__co_ scene)_sm_\nmesh.material _eq_ mat_sm_\n_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tWhen I use the texture in Blender_co_ it looks great_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_04/2.png.bdcc3b6f756dc89c3c6f93783eedc293.png_qt_ data-fileid_eq__qt_12760_qt_ rel_eq__qt__qt__gt__lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_12760_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_04/2.thumb.png.3a0b5e048d4c5dfb1c32902d05905fc3.png_qt_ alt_eq__qt_2.thumb.png.3a0b5e048d4c5dfb1c32902d05905fc3.png_qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks! Great community you_t_ve got here.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"V!nc3r","Date":"2017-04-28T07:29:20Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tCan you show us the diffuse texture which is baked at the export ? (_t_cause you have Cycles materials)\n_lt_/p_gt_\n\n_lt_p_gt_\n\t[edit] or maybe theses artefacts appears due to alpha ? [/edit]\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jdurrant","Date":"2017-04-29T16:04:47Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi V!nc3r. Just to be clear_co_ I was using Blender to show that the textures do render correctly in that context. I_t_m not using the diffuse texture that Blender would export. Though I am using the baked shadow texture. Here it is_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_04/NA_patch_single_tubeshadow.png.90f2aad136be79fc7e7c2ff50a449461.png_qt_ data-fileid_eq__qt_12780_qt_ rel_eq__qt__qt__gt__lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_12780_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_04/NA_patch_single_tubeshadow.thumb.png.0a93fcf30efd9d188e6cd3f4238a1cfb.png_qt_ alt_eq__qt_NA_patch_single_tubeshadow.thumb.png.0a93fcf30efd9d188e6cd3f4238a1cfb.png_qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jdurrant","Date":"2017-04-29T16:05:23Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tAlso_co_ for what it_t_s worth_co_ I tried different backFaceCulling settings on the material (true and both)_co_ but that didn_t_t fix the problem either. Thanks!\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jdurrant","Date":"2017-04-29T17:54:20Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi all. I was able to resolve this problem by unwrapping the mesh manually (marking seams_co_ etc.). I also divided the mesh into four separate meshes_co_ which may have contributed to the solution. I_t_m still not certain why it happened on the other version of the mesh_co_ though. For what it_t_s worth_co_ with the new manual unwrapping the mesh did not have to be divided on export. I suspect that_t_s where the problem lies.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWith low-res shadow map_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_04/1.png.c616091df14e4234d88f618b02982294.png_qt_ data-fileid_eq__qt_12784_qt_ rel_eq__qt__qt__gt__lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_12784_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_04/1.thumb.png.f0fc9fbb1bf7f2fe9f9af17046d74cbb.png_qt_ alt_eq__qt_1.thumb.png.f0fc9fbb1bf7f2fe9f9af17046d74cbb.png_qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JCPalmer","Date":"2017-05-01T16:27:38Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tLooks like some kind of folded protein.  I think to truly isolate the problem to the mesh division_co_ you would actually need to export the mesh without any material at all.  In any case_co_ I am adding an option to turn off the mesh splitting feature.  That_t_s right it is a feature to allow very large meshes to run on old WebGL implementations.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThis just made it on the very end of the Source Code Exporter_co_ Tower of Babel_co_ 5.3 release being finalized today. Making the JSON exporter is largely a file diff exercise I do using Netbeans.  Here is the TOB UI with the switch.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_12800_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_05/vertexLimitUI.jpg.1b9800d5d88fd99b89f382e46d57e1de.jpg_qt_ alt_eq__qt_vertexLimitUI.jpg.1b9800d5d88fd99b89f382e46d57e1de.jpg_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tFYI_co_ if a mesh requiring more than 64k vertices contains multi-materials or shapekeys_co_ it will be exported as a single mesh regardless.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]