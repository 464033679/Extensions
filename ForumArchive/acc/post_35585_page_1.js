[{"Owner":"V!nc3r","Date":"2018-02-08T16:54:06Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi guys!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSince I use BJS_co_ I always be kind of stucked with lightmap blending with my materials. I was working on standard workflow_co_ but now I_t_m testing PBR_co_ I have still the same issue_co_ so this thread to understand deeper the blocking factor.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI never succeeded to get (basically) the same render from my 3D lighting scene to BJS_co_ after many many tests _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSo I consistently had to tweak my hundred of lightmaps files in Photoshop to increase contrast/luminosity. These lightmaps could came from the usuals RenderToTextures passes from 3D softwares_dd_\n_lt_/p_gt_\n\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\t3DSMax &amp_sm_ VRay_co_ from a RawTotalLighting pass\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tBlender &amp_sm_ Cycles_co_ from a Diffuse Direct &amp_sm_ Indirect pass\n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n_lt_p_gt_\n\tHaving to manually tweak these lightmaps cause me to lighting my scenes in a blind way (which is of course very annoying)_co_ and to not have a WYSIWYG workflow (like_dd_ tweak a lightmap &gt_sm_ save &gt_sm_ reload BJS scene &gt_sm_ retweak &gt_sm_ etc).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSo here a test scene to discuss about_dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#59ZXVF%2311_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#59ZXVF#11_lt_/a_gt_ (_lt_a href_eq__qt_https_dd_//github.com/Vinc3r/cornellBox_qt_ rel_eq__qt_external nofollow_qt__gt_sources_lt_/a_gt_) (_lt_a href_eq__qt_https_dd_//github.com/Vinc3r/cornellBox/blob/master/BJS-PBR/assets/LM/cornellBox.000.LM.png_qt_ rel_eq__qt_external nofollow_qt__gt_here the lightmap of the room_lt_/a_gt_).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tYou can easily switch or add lightmap mode using the line 32_co_ default here is lightmap file set in lightmapTexture as shadowMap.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tBecause I_t_m a devianted person_co_ I wanted to compare with another engine_co_ so I made a scene on _lt_a href_eq__qt_https_dd_//playcanv.as/b/OuZIGpY0/_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//playcanv.as/b/OuZIGpY0/_lt_/a_gt__lt_span_gt_ _dd_ here you can see that my white data on my lightmaps files are read in a better way_co_ they burn materials a little _sm_ I think dark data are darker too. (_lt_em_gt_note that PlayCanvas allow to send HDR files and convert them to RGBM_co_ giving an _lt_a href_eq__qt_https_dd_//playcanv.as/b/cbu1Kyze/_qt_ rel_eq__qt_external nofollow_qt__gt_interesting result_lt_/a_gt__co_ but in the link above I used the exactly same png file than in BJS_co_ of course_lt_/em_gt_). And the result is totally satisfying_lt_/span_gt__lt_span_gt_._lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ data-fileid_eq__qt_16937_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_02/bjs-cycles-playcanvas.png.188c3924ab00f560157eea6b5b4ed7f2.png_qt_ rel_eq__qt__qt__gt__lt_img alt_eq__qt_bjs-cycles-playcanvas.thumb.png.49302477e5ea5adbbca814f43a45d268.png_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_16937_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_02/bjs-cycles-playcanvas.thumb.png.49302477e5ea5adbbca814f43a45d268.png_qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span_gt_So_co_ have I missed a magic parameter? Is the shader need a little tweaking? Is my workflow totally wrong? How do you personally deal with lightmaps?_lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t\t\t\n\n_lt_span class_eq__t_ipsType_reset ipsType_medium ipsType_light_t_ data-excludequote_gt_\n\t_lt_strong_gt_Edited _lt_time datetime_eq__t_2018-02-12T09_dd_25_dd_25Z_t_ title_eq__t_02/12/2018 09_dd_25  AM_t_ data-short_eq__t_Feb 12_t__gt_February 12_lt_/time_gt_ by V!nc3r_lt_/strong_gt_\n\t\n\t\t_lt_br_gt_solved\n\t\n\t\n_lt_/span_gt_\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-02-08T17:12:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHello_co_ first of all in order to compare we will need to have everyone in PBR or in std. Seems like the Playcanvas one is not using PBR. The lightmap in bjs is less important as the main source of energy comes from the environment\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-02-08T17:21:02Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tWAIT!!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI found a bug _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt_1_qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt__gt_ We were not reading the lightmap in linear mode!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tStay tuned!\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-02-08T17:27:06Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#59ZXVF#12_qt_ ipsnoembed_eq__qt_true_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#59ZXVF#12_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t(please also note line #25 where I can manually force the impact of the lightmap)\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"V!nc3r","Date":"2018-02-08T18:26:59Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI think the playcanvas scene is on PBR\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_img alt_eq__qt_6af1QI3.png_qt_ class_eq__qt_ipsImage_qt_ height_eq__qt_110_qt_ src_eq__qt_https_dd_//i.imgur.com/6af1QI3.png_qt_ width_eq__qt_279_qt_ /_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tbut it_t_s true that default environment is not the same (and I don_t_t find where is it in playcanvas_co_ scene ambientColor doesn_t_t change anything_co_ and there is not default skybox)_co_ but! when I play with the gamma button_co_ render tend to be similar than BJS! (below 1.0 instead of the default 2.2)\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ data-fileid_eq__qt_16942_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_02/playcanvas-gamma.png.9a210b0ed445a40fb12718d232f9b93e.png_qt_ rel_eq__qt__qt__gt__lt_img alt_eq__qt_playcanvas-gamma.thumb.png.0dd0c367ec99ecad2a5626aa2f8231e2.png_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_16942_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_02/playcanvas-gamma.thumb.png.0dd0c367ec99ecad2a5626aa2f8231e2.png_qt_ style_eq__qt_width_dd_500px_sm_height_dd_auto_sm__qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIs this related to the lightmap linear mode you talking about_co_ or another path to investigate?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAbout the level parameter_co_ I believe it tends to burn too fast lightmaps values (like the light impact on the ground).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI_t_m waiting about the linear thing _lt_img alt_eq__qt__sm_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_wink.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/wink@2x.png 2x_qt_ title_eq__qt__sm_)_qt_ width_eq__qt_20_qt_ /_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-02-09T18:27:16Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThey are not using PBR (I sniffed their shader _sm_))\n_lt_/p_gt_\n\n_lt_p_gt_\n\tMy linear thingy is published my dear..please let me know\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"V!nc3r","Date":"2018-02-12T09:24:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tYeah_co_ you rocks!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIt seems to work much better_dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#59ZXVF%2315_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#59ZXVF#15_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI_t_ve added a neutral environment_co_ by not using the default one of createDefaultEnvironment_co_ it adds a more... neutral... light (line 6).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIt looks like we now have a better interpretation than playcanvas _lt_img alt_eq__qt__dd_lol_dd__qt_ data-emoticon_eq__qt__qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_laugh.png_qt_ title_eq__qt__dd_lol_dd__qt_ /_gt_ (_lt_a href_eq__qt_https_dd_//playcanv.as/b/OuZIGpY0/_qt_ rel_eq__qt_external nofollow_qt__gt_playcanvas ref_lt_/a_gt_ vs _lt_a href_eq__qt_https_dd_//www.nothing-is-3d.com/dl/babylonJS/cornellBox/BJS-PBR/index-preview.html_qt_ rel_eq__qt_external nofollow_qt__gt_BJS patched_lt_/a_gt_).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks for that great patch!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-02-12T15:34:11Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tMan! thank you for finding it_dd_) \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]