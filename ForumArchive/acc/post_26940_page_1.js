[{"Owner":"Babylonian","Date":"2016-12-09T10:32:44Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI_t_m working on a project where a large number of objects get created_co_ then are destroyed (with .dispose())_co_ on an ongoing basis. I_t_m seeing memory use gradually increasing_co_  and FPS gradually degrading. Have checked to ensure the Scene.meshes[] array is not getting longer and longer. But I noticed that the shadow generator renderlist_co_ which gets added to with _dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tshadowGenerator.getShadowMap().renderList.push(mesh)_sm_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t...is getting longer and longer. The dispose() of the meshes does not seem to trigger removal from the list_co_ although the shadows do disappear.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIs there something I should be doing to remove them from the shadow render list? Or should this be happening automatically?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tBTW there is no heading for ShadowGenerator on _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/classes/2.4_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/classes/2.4_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2016-12-09T17:05:08Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/24671-babylonian/?do_eq_hovercard_qt_ data-mentionid_eq__qt_24671_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/24671-babylonian/_qt_ rel_eq__qt__qt__gt_@Babylonian_lt_/a_gt__co_ welcome to the forum.  I am no expert... but I can tell you what I _lt_em_gt_think_lt_/em_gt_ I know.  _lt_img alt_eq__qt__dd_o_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_ohmy.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/ohmy@2x.png 2x_qt_ title_eq__qt__dd_o_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tThe ._lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Lights/Shadows/babylon.shadowGenerator.ts#L157_qt_ rel_eq__qt_external nofollow_qt__gt_shadowMap for a shadowGenerator_lt_/a_gt_... is type _lt_em_gt__lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Materials/Textures/babylon.renderTargetTexture.ts_qt_ rel_eq__qt_external nofollow_qt__gt_RenderTargetTexture_lt_/a_gt_.  _lt_/em_gt_At _lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Materials/Textures/babylon.renderTargetTexture.ts#L20_qt_ rel_eq__qt_external nofollow_qt__gt_line 20 of the RTT_co__lt_/a_gt_ there is an interesting comment_co_ regarding dynamically updating the renderList.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThis could possibly indicate that RTT_t_s don_t_t have a constantly-updating .renderList... by nature/default.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIf you know how to use this... _lt_em_gt_renderListPredicate  _lt_/em_gt_and assorted stuff from lines 20-34_co_ I think you can activate a continuously-updating renderList.   No promises.  Smarter helpers than I... will comment soon_co_ I_t_m sure.  But meantime_co_ you have some things you can experiment-with_co_ if you wish. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tHere is _lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/topic/25121-instancedispose-should-be-removed-from-shadowgenerator/_qt_ rel_eq__qt__qt__gt_another forum thread that talks about this issue_lt_/a_gt__co_ but it is older.  I was predominantly useless in _lt_em_gt_that_lt_/em_gt_ thread_co_ too.  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tSorry I could not be more helpful.  Stay tuned.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"aWeirdo","Date":"2016-12-09T17:14:57Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi_co_ _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/24671-babylonian/?do_eq_hovercard_qt_ data-mentionid_eq__qt_24671_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/24671-babylonian/_qt_ rel_eq__qt__qt__gt_@Babylonian_lt_/a_gt_ _lt_br /_gt__lt_br /_gt_\n\t_qt_ _lt_span style_eq__qt_color_dd_rgb(39_co_42_co_52)_sm_font-family_dd__t_Helvetica Neue_t__co_ Helvetica_co_ Arial_co_ sans-serif_sm_font-size_dd_14px_sm_font-style_dd_normal_sm_font-weight_dd_normal_sm_letter-spacing_dd_normal_sm_text-indent_dd_0px_sm_text-transform_dd_none_sm_white-space_dd_normal_sm_word-spacing_dd_0px_sm_background-color_dd_rgb(255_co_255_co_255)_sm_float_dd_none_sm__qt__gt_large number of objects_lt_/span_gt_ _qt__co_ what kind of objects are we speaking of?_lt_br /_gt_\n\tare they all the same?_co_ are some of them?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tif they are_co_ you could re-use them_co_ instead of disposing_co__lt_br /_gt_\n\tso a basic setup_sm_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tat start you create/clone the all the objects you need_co_ \n_lt_/p_gt_\n\n_lt_p_gt_\n\twhen you need to _qt_dispose_qt_ them_co_ set mesh.setEnabled( false )_sm_ instead\n_lt_/p_gt_\n\n_lt_p_gt_\n\twhen you need to re-use them_co_ move into position_co_ rescale_co_ etc etc_co_ set mesh.setEnabled( true )_sm_ \n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_br /_gt_\n\tJust a thought _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__co_ i don_t_t know anything about the shadow generator_co_ sorry.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_color_dd_#808080_sm__qt__gt_Edit_lt_/span_gt__lt_br /_gt_\n\there_t_s a very simple example with just one mesh_co_ click anywhere on the canvas to show/hide _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#JUEYV%231_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#JUEYV#1_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2016-12-09T17:37:45Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThe dispose should remove the mesh from the generator_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Mesh/babylon.abstractMesh.ts#L1155_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Mesh/babylon.abstractMesh.ts#L1155_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Babylonian","Date":"2016-12-10T09:57:02Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_span_gt__lt_span_gt_Thanks all for the quick replies!_lt_/span_gt__lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span_gt__lt_span_gt_@Deltakosh_co_ looks like you are right_co_ it should work_co_ and I have confirmed this works in a simple case with a quick experiment in the Playground_dd_ _lt_a href_eq__qt_http_dd_//playground.babylonjs.com/#QHIIR%230_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//playground.babylonjs.com/#QHIIR#0_lt_/a_gt__lt_/span_gt__lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span_gt_I_t_ll have to debug my more complex case further. I *had* checked that the meshes were in fact getting disposed of_co_ as scene.meshes.length is getting reduced._lt_/span_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Babylonian","Date":"2016-12-10T11:14:05Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tFound the cause_dd_ the removal from the shadow generator must have been recent and is not in the 2.4 version I_t_m using from the CDN (which is the newest on the release page_co_ although I see the Playground has 2.6-alpha).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tCan_t_t remember where I found the link to the CDN to be honest. By typing the URL in I found there was a 2.5 CDN.  This has the fix. So I_t_m happy _dd_-)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSuggestion_dd_ the website could add CDN_co_ or a more minimal download option under the getting started and Release sections.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2016-12-11T02:17:24Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tYou can download now from our Download page_dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs.com/versionBuilder/_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs.com/versionBuilder/_lt_/a_gt_\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Babylonian","Date":"2016-12-11T11:04:49Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThanks - have downloaded a plain 2-5 and it is also fine on the shadows.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tFor the newcomer_co_ it would be good with a link from the Downloads page to the _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/whats-new_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/whats-new_lt_/a_gt_ _co_ and also an indication that the many option under Components are in fact not necessary until at least Tutorial #N (if N can be identified). I was a bit baffled at first (_qt_help_co_ do I need the OBJ or the gITF loader??_qt_). Anyway_co_ I selected nothing_co_ and everything I_t_ve tried so far is still working.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAlso noted that the file I got when selecting _qt_2.6 preview_qt_ was bit-identical to the one I got when selecting 2.5?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tNOT complaining_co_ just trying to make it easier for others to follow in my footsteps _dd_-) Fantastic thing you have built here.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2016-12-11T13:37:13Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI love your caring_co_ B!  Good to have you with us.  Keep those suggestions coming_co_ and contribute in any way you wish_co_ always.  We have an un-pinned forum thread called _lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/topic/4983-tutorial-talk/?view_eq_getlastpost_qt_ rel_eq__qt__qt__gt_Tutorial Talk_lt_/a_gt_.  It_t_s a great place to talk about everything docs-related (discussions about documentation _qt_theories_qt__co_ too).  Feel free to say anything in there... lots of us participate in it... slowly.  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tSorry to hear that you were confused_co_ and sorry for my mistake about the .renderList thing.  (And darned good issue-solving on your part_co_ too.  Good investigative work!  You bravely went _qt_diving for knowledge_qt__co_ and that is a trait held in high-esteem_co_ _t_round these parts.  Excellent!)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI forgot that DK made some changes for this issue_co_ even though he said so... at the bottom of KevinBLT_t_s thread.  Dummy me.  I should have thought about a potential versioning issue... but my brain was clogged for some reason.  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_ \n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks to _lt_u_gt_all_lt_/u_gt_ thread participants_co_ for helping to fix my _qt_wild goose chase_qt_.  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_  Babylonian_co_ after you learn more about me_co_ you will see that saying wrong things... is quite common for me.  I_t_m working on it.  But I do a good job at _qt_keeping us talking_qt_ about an issue_co_ and that_t_s something_co_ too.  Wait until we start talking about mesh instances and their shadows.  I_t_m sure that I have 10-20 more wrong things to say about that_co_ as well.  heh.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]