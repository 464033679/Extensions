[{"Owner":"Félix Flores","Date":"2017-10-24T16:22:07Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tHello_co__lt_br /_gt_\n\tI am developing a 3d page_co_ with babylonjs_co_ I have the scene_co_ that I am modeling and exporting in _qt_blender_qt_ to a babylon file. In code I am adding shadows and lights_co_ some of these lights I need turn on an turn off whe the lamp is clicked. I create the lights like this_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_\t//Luz global\n\tlight[0] _eq_ new BABYLON.DirectionalLight(_qt_LuzGlobal_qt__co_ new BABYLON.Vector3(0_co_ -1_co_ 1)_co_ scene)_sm_\n\tlight[0].diffuse _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm_\n\tlight[0].specular _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm_\n\tlight[0].direction _eq_ new BABYLON.Vector3(0_co_ -1_co_ 1)_sm_\n\tlight[0].position.x _eq_ 27_sm_\n\tlight[0].position.y _eq_ 28_sm_\n\tlight[0].position.z _eq_ -89_sm_\n\tlight[0].intensity _eq_ 1.0_sm_\n\t\n\t//createLensFlare()_sm_\n \n\t//Creamos las luces de las lamparas \n\t\n\tlight[1] _eq_ new BABYLON.SpotLight(_qt_lampara1_qt__co_ scene.getMeshByName(_qt_lamp1_qt_).position_co_ new BABYLON.Vector3(0_co_ -1_co_ 0)_co_ 0.8_co_ 2_co_ scene)_sm_\n\tlight[1].diffuse _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm_\n\tlight[1].specular _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm_\n\t\n\tlight[2] _eq_ new BABYLON.SpotLight(_qt_lampara2_qt__co_ scene.getMeshByName(_qt_lamp2_qt_).position_co_ new BABYLON.Vector3(0_co_ -1_co_ 0)_co_ 0.8_co_ 2_co_ scene)_sm_\n\tlight[2].diffuse _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm_\n\tlight[2].specular _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm_\n\t\n\tlight[3] _eq_ new BABYLON.SpotLight(_qt_lampara3_qt__co_ scene.getMeshByName(_qt_lamp3_qt_).position_co_ new BABYLON.Vector3(0_co_ -1_co_ 0)_co_ 0.8_co_ 2_co_ scene)_sm_\n\tlight[3].diffuse _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm_\n\tlight[3].specular _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm_\n\t\n\tlight[4] _eq_ new BABYLON.SpotLight(_qt_lampara4_qt__co_ scene.getMeshByName(_qt_lamp4_qt_).position_co_ new BABYLON.Vector3(0_co_ -1_co_ 0)_co_ 0.8_co_ 2_co_ scene)_sm_\n\tlight[4].diffuse _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm_\n\tlight[4].specular _eq_ new BABYLON.Color3(1_co_ 1_co_ 1)_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tAnd I switch the state like this_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_\t// Apagamos o prendemos la luz de la lampara 1\n\tscene.getMeshByName(_qt_lamaparaCalle1_qt_).actionManager _eq_ new BABYLON.ActionManager(scene)_sm_\n\tscene.getMeshByName(_qt_lamaparaCalle1_qt_).actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger_co_ function (evt) {\n\t\tif(light[1].isEnabled() _eq__eq_ true){\n\t\t\tlight[1].setEnabled(false)_sm_\n\t\t\tif(scene.getMeshByName(_qt_vlsT1_qt_) !_eq_ null)\n\t\t\t\tscene.getMeshByName(_qt_vlsT1_qt_).setEnabled(false)_sm_\n\t\t}\n\t\telse{\n\t\t\tlight[1].setEnabled(true)_sm_\n\t\t\tif(scene.getMeshByName(_qt_vlsT1_qt_) !_eq_ null)\n\t\t\t\tscene.getMeshByName(_qt_vlsT1_qt_).setEnabled(true)_sm_\n\t\t}\n\t}))_sm_\n\t\n\t// Apagamos o prendemos la luz de la lampara 2\n\tscene.getMeshByName(_qt_lamaparaCalle2_qt_).actionManager _eq_ new BABYLON.ActionManager(scene)_sm_\n\tscene.getMeshByName(_qt_lamaparaCalle2_qt_).actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger_co_ function (evt) {\n\t\tif(light[2].isEnabled() _eq__eq_ true){\n\t\t\tlight[2].setEnabled(false)_sm_\n\t\t\tif(scene.getMeshByName(_qt_vlsT2_qt_) !_eq_ null)\n\t\t\t\tscene.getMeshByName(_qt_vlsT2_qt_).setEnabled(false)_sm_\n\t\t}\n\t\telse{\n\t\t\tlight[2].setEnabled(true)_sm_\n\t\t\tif(scene.getMeshByName(_qt_vlsT2_qt_) !_eq_ null)\n\t\t\t\tscene.getMeshByName(_qt_vlsT2_qt_).setEnabled(true)_sm_\n\t\t}\n\t}))_sm_\n\t\n\t\t// Apagamos o prendemos la luz de la lampara 3\n\tscene.getMeshByName(_qt_lamaparaCalle3_qt_).actionManager _eq_ new BABYLON.ActionManager(scene)_sm_\n\tscene.getMeshByName(_qt_lamaparaCalle3_qt_).actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger_co_ function (evt) {\n\t\tif(light[3].isEnabled() _eq__eq_ true){\n\t\t\tlight[3].setEnabled(false)_sm_\n\t\t\tif(scene.getMeshByName(_qt_vlsT3_qt_) !_eq_ null)\n\t\t\t\tscene.getMeshByName(_qt_vlsT3_qt_).setEnabled(false)_sm_\n\t\t}\n\t\telse{\n\t\t\tlight[3].setEnabled(true)_sm_\n\t\t\tif(scene.getMeshByName(_qt_vlsT3_qt_) !_eq_ null)\n\t\t\t\tscene.getMeshByName(_qt_vlsT3_qt_).setEnabled(true)_sm_\n\t\t}\n\t}))_sm_\n\t\n\t\t// Apagamos o prendemos la luz de la lampara 4\n\tscene.getMeshByName(_qt_lamaparaCalle4_qt_).actionManager _eq_ new BABYLON.ActionManager(scene)_sm_\n\tscene.getMeshByName(_qt_lamaparaCalle4_qt_).actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger_co_ function (evt) {\n\t\tif(light[4].isEnabled() _eq__eq_ true){\n\t\t\tlight[4].setEnabled(false)_sm_\n\t\t\tif(scene.getMeshByName(_qt_vlsT4_qt_) !_eq_ null)\n\t\t\t\tscene.getMeshByName(_qt_vlsT4_qt_).setEnabled(false)_sm_\n\t\t}\n\t\telse{\n\t\t\tlight[4].setEnabled(true)_sm_\n\t\t\tif(scene.getMeshByName(_qt_vlsT4_qt_) !_eq_ null)\n\t\t\t\tscene.getMeshByName(_qt_vlsT4_qt_).setEnabled(true)_sm_\n\t\t}\n\t}))_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tBut the first time that i turn off the lights the scene is paused and then continue_co_ what is the best way to do that? maybe I am doing something wrong.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tthe complete source is_dd_ _lt_a href_eq__qt_https_dd_//github.com/flelix/entorno-models.git_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/flelix/entorno-models.git_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tthe project path is_dd_ entorno-models/code/proyBabylon/p2/\n_lt_/p_gt_\n\n_lt_p_gt_\n\tthanks and regards\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-10-24T17:04:32Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tYou are doing things great_dd_)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tYou are seeing a lag because when turning lights off the shaders have to be recompile\n_lt_/p_gt_\n\n_lt_p_gt_\n\tUnfortunately in webgl world shaders compilation is done on the main thread.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThere is a tool to help you compile shaders beforehand_dd_ material.forceCompilation (if I remember correctly)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSo the overall idea will be to setup lights_co_ force compilation on materials then update lights and keep going \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-10-24T17:06:09Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tDoc_dd_ _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/tutorials/How_materials_work)_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/tutorials/How_materials_work)_lt_/a_gt_\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Félix Flores","Date":"2017-10-24T17:47:45Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tHey thanks for the advice_co_ I will try do that_co_ but the link that you share me doesn_t_t works\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-10-26T15:42:55Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tSorry there was a parenthesis at the end\n_lt_/p_gt_\n\n_lt_p_gt_\n\tcorrect link_dd_ _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/resources/how_materials_work_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/resources/how_materials_work_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]