[{"Owner":"piermonn","Date":"2015-06-16T06:56:49Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi everyone!_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I am struggling with the BabylonJS transformations model and I ask for help about it._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I need to create a program where the user chooses transformations one after another (that is to say I can have to perform a rotation_co_ then a translation_co_ than a scaling...). However_co_ it seems I can_t_t have the correct result based on the specific order given by the user and I think it is because BabylonJS executes translation then rotation then scaling (I compare results with a JavaFX program which allows me to add transformations in any order)._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Is there anyway I can bypass the BabylonJS order?_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Thanks in advance for your answers._lt_/p_gt__lt_p_gt_Pierre_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2015-06-16T14:10:11Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi Piermonn_co_ welcome to the forum_co_ good to have you with us.  I_t_m Wingnut_co_ expert wannabe_co_ blowhard yapper_co_ topic railroader_co_ and generally the guy who everyone wants to see get run over by a beer truck.  How ya doon?  I hope well._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_[snip - massive text removed because Wingnut misunderstood the issue]   _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_IF_co_ by chance_co_ you are speaking-of _lt_u_gt_NON-imported mesh_lt_/u_gt__co_ then you can set _lt_em_gt_.position_lt_/em_gt__co_ _lt_em_gt_.rotation_lt_/em_gt__co_ and _lt_em_gt_.scaling_lt_/em_gt_ in any order you wish.  Each setting requires one line of code_co_ so you can arrange the order of the code lines in any order_co_ of course.  Our _lt_a href_eq__qt_http_dd_//babylonjs-playground.azurewebsites.net/?3_qt_ rel_eq__qt_external nofollow_qt__gt_Playground Demo #3_lt_/a_gt_ shows all sorts of position_co_ rotation_co_ and scaling... in all sorts of orders.  Play around in there_co_ do experiments_co_ hit RUN over and over_co_ grab a zip for playing at home._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I hope I didn_t_t misunderstand your issue.  Tell us a bit more_co_ if you please.  Imported mesh?  Locally-produced mesh?_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_And again_co_ welcome!  Party on!_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"piermonn","Date":"2015-06-16T14:38:58Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi Wingnut!_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Thank you for your answer. I_t_m using locally produced meshes_co_ such as Box and Sphere._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_To explain better what I mean_co_ I will show you an example. With the following transformations (in this precise order)_dd__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_- translation(-2.4_co_ 0.2_co_ -1)_lt_/p_gt__lt_p_gt_- rotation(Axis(0.0_co_ 1.0_co_ -1.0)_co_ -0.9)_lt_/p_gt__lt_p_gt_- rotation(Axis(0.0_co_ 1.0_co_ -1.0)_co_ -0.8)_lt_/p_gt__lt_p_gt_- scale(1_co_ 2_co_ 1)_lt_/p_gt__lt_p_gt_- rotation(Axis(0.0_co_ 1.0_co_ -1.0)_co_ 0.8)_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I have this result with BabylonJS (using translate and rotate method_co_ and object.scaling.x/y/z for scaling)_dd__lt_/p_gt__lt_p_gt__lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_06_2015/post-14995-0-40046600-1434465442.png_qt_ rel_eq__qt_external nofollow_qt__gt__lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_06_2015/post-14995-0-40046600-1434465442.png_qt_ data-fileid_eq__qt_4473_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ alt_eq__qt_post-14995-0-40046600-1434465442.png_qt__gt__lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Whereas I have this result with the same program in JavaFX_dd__lt_/p_gt__lt_p_gt__lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_06_2015/post-14995-0-58516200-1434465442.png_qt_ rel_eq__qt_external nofollow_qt__gt__lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_06_2015/post-14995-0-58516200-1434465442.png_qt_ data-fileid_eq__qt_4474_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ alt_eq__qt_post-14995-0-58516200-1434465442.png_qt__gt__lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I believe this is because BabylonJS executes the transformations in a particular order whereas JavaFX multiplies the matrices in the order they come. But I may mistaken and prefer asking to understand what is the reason of it _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_&lt_sm_fileStore.core_Emoticons&gt_sm_/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Thanks!_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2015-06-16T14:39:34Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_About the order things are done_co_ I think everything is in the_lt_em_gt_ computeWorldMatrix()_lt_/em_gt_ method _dd_ _lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/Babylon/Mesh/babylon.abstractMesh.ts#L416_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/Babylon/Mesh/babylon.abstractMesh.ts#L416_lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_So_co_ I guess the right order is _dd__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_- scaling_lt_/p_gt__lt_p_gt_- rotation _dd_ Y_co_ X then Z (I_t_m sure of this one !)_lt_/p_gt__lt_p_gt_- translation (position settings)_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_You can_t_t change it. This matrix is passed to the vertex shader which computes thus world positions for each vertex._lt_/p_gt__lt_p_gt_Unless maybe you code your own vertex shader ..._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2015-06-16T14:41:24Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_rotations aren_t_t accumulated unless you re-compute the mesh WorldMatrix each step _dd_ _lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/topic/14697-mis-understanding-rotations-and-translations-local-and-world/?p_eq_83663_qt__gt_http_dd_//www.html5gamedevs.com/topic/14697-mis-understanding-rotations-and-translations-local-and-world/?p_eq_83663_lt_/a_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"piermonn","Date":"2015-06-16T22:17:44Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_OK_co_ this explains the result difference then _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I will try to change the way the world matrix is calculated (a bit hacky but it seems I can_t_t do better) to get my final result._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Thanks anyway!_lt_/p_gt__lt_p_gt_ _lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Temechon","Date":"2015-06-17T08:01:21Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Why not do something like this ? _lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_ translation(-2.4_co_ 0.2_co_ -1)_lt_/p_gt__lt_p style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_computeWorldMatrix(true)_sm__lt_/p_gt__lt_p style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_- rotation(Axis(0.0_co_ 1.0_co_ -1.0)_co_ -0.9)_lt_/p_gt__lt_div_gt__lt_span style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_computeWorldMatrix(true)_sm__lt_/span_gt__lt_/div_gt__lt_p style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_- rotation(Axis(0.0_co_ 1.0_co_ -1.0)_co_ -0.8)_lt_/p_gt__lt_div_gt__lt_span style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_computeWorldMatrix(true)_sm__lt_/span_gt__lt_/div_gt__lt_p style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_- scale(1_co_ 2_co_ 1)_lt_/p_gt__lt_div_gt__lt_span style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_computeWorldMatrix(true)_sm__lt_/span_gt__lt_/div_gt__lt_p style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_- rotation(Axis(0.0_co_ 1.0_co_ -1.0)_co_ 0.8)_lt_/p_gt__lt_div_gt__lt_span style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_computeWorldMatrix(true)_sm__lt_/span_gt__lt_/div_gt__lt_div_gt_ _lt_/div_gt__lt_div_gt__lt_span_gt_Not very clean_co_ but I think it should work._lt_/span_gt__lt_/div_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"piermonn","Date":"2015-06-17T08:08:15Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Unfortunately it doesn_t_t work. I guess the scale is local (because it is set to _localScaling in the computeWorldMatrix method) and that_t_s why results are different._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2015-06-17T15:50:38Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hello Piermonn_co__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_you have another option_dd_ you can control the way the matrix is built by using  mesh.setPivotMatrix_dd__lt_/p_gt__lt_p_gt__lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/Babylon/Mesh/babylon.abstractMesh.ts#L336_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/Babylon/Mesh/babylon.abstractMesh.ts#L336_lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_By setting only this matrix (and leaving everything else untouched)_co_ you can control the way the final world matrix is produced._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_​for instance_dd__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_var mat _eq_ BABYLON.Matrix.Translation(..)mesh.setPivotMatrix(mat.multiply(BABYLOn.Scaling(...))_lt_/pre_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"piermonn","Date":"2015-06-18T07:13:30Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Oh this will be far easier_co_ I_t_m going to test._lt_/p_gt__lt_p_gt_Thanks!_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]