[{"Owner":"snot224","Date":"2016-11-28T15:22:17Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi all_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\ti_t_m back from a long time_co_ and I update from v2.3 to v2.4 and my code don_t_t work anymore ..._lt_br /_gt_\n\tI just want to know here how to identify and be sure to link correct skeleton with the correct mesh ?\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_br /_gt_\n\tHere the example to explain my problem _dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIn 3DSMax_co_ I create an house with 6 objects_co_ on this house I put bones (55 bones) and somes animations (After export it represent 6 skeletons).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tNow_co_ I would like to import them in Babylon_co_ BUT when I tryed to start animation_co_ black screen appear_co_ and this console log _dd__lt_br /_gt_\n\tTypeError_dd_ Argument 3 is not valid for any of the 3-argument overloads of WebGLRenderingContext.uniformMatrix4fv.[En savoir plus]_lt_br /_gt__lt_br /_gt__lt_br /_gt_\n\tHere my code_co_ that worked fine in v2.3 but don_t_t work anymore in v2.4_co_ and same kind of code work fine with less complexe modele (1 meshe for 1 skeleton)\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_// code d_t_importation et de sauvegarde\nBABYLON.SceneLoader.ImportMesh(_qt__qt__co_dossier_co_fichier_co_scene_co_function(mesh_co_ particleSystems_co_ skeletons)\n{\n        controleurObjet.tabModele[name].mesh                _eq_ []_sm_\n        controleurObjet.tabModele[name].bone                _eq_ []_sm_\n        var i_sm_\n      \n        // On rajoute uniquement les éléments visible (pas les structures)          \n        for (i_eq_0_sm_i&lt_sm_mesh.length_sm_i++)\n        {\n             if(mesh[i].isVisible)\n             {\n                 controleurObjet.tabModele[name].mesh.push(mesh[i])_sm_\n                 // On marque le modèle de départ\n                 mesh[i].isVisible                  _eq_ false_sm_\n             }\n         }\n              \n         for (i_eq_0_sm_ i&lt_sm_skeletons.length_sm_i++)\n         {\n             controleurObjet.tabModele[name].bone.push(skeletons[i])_sm_\n         }\n}\n\n\n// clonage\nfor (i_eq_0 _sm_ i&lt_sm_controleurObjet.tabModele[this.type].mesh.length _sm_ i++)\n{\n    this.mesh[i] _eq_ controleurObjet.tabModele[this.type].mesh[i].clone(this.name+_t___t_+i)_sm_\n    this.parametrage(i)_sm_\n}\n\t\nfor (i_eq_0 _sm_ i&lt_sm_controleurObjet.tabModele[this.type].bone.length _sm_ i++)\n{\n    this.mesh[i].skeleton _eq_ controleurObjet.tabModele[this.type].bone[i].clone(this.name+_t___t_+i)_sm_\n}\n\n\n// Start animation de construction\nfor (var i_eq_0_sm_i&lt_sm_this.mesh.length_sm_i++)\n{\n\tif (this.mesh[i].skeleton)\n\t{\n\t\tscene.beginAnimation(this.mesh[i].skeleton_co_0_co_10_co_ false_co_ 1)_sm_\n\t}\n}\n_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t_lt_br /_gt_\n\tI know that the problem comes because I only keep visible meshes_co_ but If I delete the line _qt_if(mesh_lt_em_gt_.isVisible)_qt__co_ no animation working_co_ and If I keep this line_co_ error above apear .._lt_/em_gt__lt_br /_gt__lt_br /_gt__lt_em_gt_Someone could explain to me how to know on which mesh I could link correct skeleton ?_lt_/em_gt__lt_br /_gt__lt_br /_gt__lt_em_gt_  _lt_/em_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"xaero59","Date":"2016-11-28T16:43:37Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tNot sure if 3ds exporter works like blender one_co_ but I found out that when I import meshes with an armature ( from a blender exported babylon file ) _co_ the skeleton is automaticaly applied to the mesh that are set to use the armature defined in my blender scene._lt_br /_gt__lt_br /_gt_\n\tYou should check if it_t_s the same by doing\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_console.log(mesh[i].skeleton)_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t_lt_em_gt__lt_em_gt__lt_em_gt_in your very first for...loop _co_ if it_t_s the case then you can do all the cloning without keeping skeletons in a separate array. _lt_/em_gt__lt_/em_gt__lt_/em_gt__lt_em_gt__lt_em_gt_ _lt_/em_gt__lt_/em_gt__lt_em_gt_ _lt_/em_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2016-11-28T17:14:03Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\t_lt_span_gt__lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/24090-xaero59/?do_eq_hovercard_qt_ data-mentionid_eq__qt_24090_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/24090-xaero59/_qt_ rel_eq__qt__qt__gt_@xaero59_lt_/a_gt__lt_/span_gt_ is right. You can go through all meshes and test mesh.skeleton\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"snot224","Date":"2016-11-28T17:58:31Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI found the error_co_ but it look like very strange ..._lt_br /_gt__lt_br /_gt_\n\tin the function _qt_parametrage_qt_ that I call in the first part (here the code)\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_Batiment.prototype.parametrage _eq_ function(id)\n{\t\t\n\tthis.mesh[id].scaling \t\t_eq_ new BABYLON.Vector3(0.07_co_0.07_co_0.07)_sm_\n\t\n\t// Paramètre\n\tthis.mesh[id].checkCollisions\t_eq_ true_sm_\n\tthis.mesh[id].receiveShadows\t_eq_ true_sm_\n\tthis.mesh[id].visibility\t_eq_ 1_sm_\n\t\n\tthis.mesh[id].isVisible\t\t_eq_ true_sm_\n\t\n\t\t\n\tshadowGenerator.getShadowMap().renderList.push(this.mesh[id])_sm_\n}_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\twhen I comment the line of the shadowGenerator_co_ no more error_co_ animations works. but_co_ no more shadow for the meshs..._lt_br /_gt__lt_br /_gt_\n\tI just update to v2.5 and same things._lt_br /_gt__lt_br /_gt_\n\tHere the error log _dd__lt_br /_gt_\n\tTypeError_dd_ Argument 3 is not valid for any of the 3-argument overloads of WebGLRenderingContext.uniformMatrix4fv.[En savoir plus]  babylon-2.5.js_dd_5_dd_4857_lt_br /_gt_\n\t    s.prototype.setMatrices babylon-2.5.js_dd_5_dd_4857_lt_br /_gt_\n\t    t.prototype.setMatrices babylon-2.5.js_dd_15_dd_26904_lt_br /_gt_\n\t    t/a babylon-2.5.js_dd_7_dd_29664_lt_br /_gt_\n\t    t/this._shadowMap.customRenderFunction babylon-2.5.js_dd_7_dd_30065_lt_br /_gt_\n\t    t.prototype.render babylon-2.5.js_dd_10_dd_29895_lt_br /_gt_\n\t    t.prototype.render babylon-2.5.js_dd_10_dd_27206_lt_br /_gt_\n\t    i.prototype.renderToTarget babylon-2.5.js_dd_15_dd_3280_lt_br /_gt_\n\t    i.prototype.render babylon-2.5.js_dd_15_dd_2586_lt_br /_gt_\n\t    i.prototype._renderForCamera babylon-2.5.js_dd_12_dd_3526_lt_br /_gt_\n\t    i.prototype._processSubCameras babylon-2.5.js_dd_12_dd_5901_lt_br /_gt_\n\t    i.prototype.render babylon-2.5.js_dd_12_dd_10034_lt_br /_gt_\n\t    creerJeu/&lt_sm_/&lt_sm_  nko.js_dd_265_dd_5_lt_br /_gt_\n\t    s.prototype._renderLoop babylon-2.5.js_dd_4_dd_23094_lt_br /_gt_\n\t    bound  self-hosted_lt_br /_gt__lt_br /_gt_\n\tThe strangest thing is that for all over objects (using exactly the same shadowGenerator)_co_ shadow works fine.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"snot224","Date":"2016-11-28T18:01:52Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHere how I declare the ShadowGenerator\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_// ********************************************************\n// Shadow\n// ********************************************************\nshadowGenerator \t\t\t\t_eq_ new BABYLON.ShadowGenerator(4096_co_shadowLight)_sm_\nshadowGenerator.useVarianceShadowMap \t        _eq_ true_sm_\nshadowGenerator.usePoissonSampling \t\t_eq_ true_sm_\nshadowGenerator._darkness\t\t        _eq_ -0.8_sm_\nshadowGenerator.bias \t\t\t\t_eq_ 0.0001_sm_\nshadowGenerator.getShadowMap().anisotropicFilteringLevel _eq_ __CONST_ANISOTROPIC___sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2016-11-28T18:08:31Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHello\n_lt_/p_gt_\n\n_lt_p_gt_\n\twe need a PG (Playground) that reproduces this issue to help you\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"xaero59","Date":"2016-11-29T13:05:31Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tTry that _dd_ Make sure that your scene object is accessible anywhere in your code_co_ then in your function\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_Batiment_lt_span_gt_.prototype_lt_/span_gt__lt_span_gt_.parametrage_lt_/span_gt__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t_lt_code_gt__lt_span_gt_Replace _dd_ _lt_/span_gt__lt_/code_gt_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_shadowGenerator_lt_span_gt_.getShadowMap_lt_/span_gt_()_lt_span_gt_.renderList_lt_/span_gt__lt_span_gt_.push_lt_/span_gt_(_lt_span_gt_this_lt_/span_gt__lt_span_gt_.mesh_lt_/span_gt_[_lt_span_gt_id_lt_/span_gt_])_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tBy _dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tyourSceneObject.executeWhenReady(function() { _lt_code_gt_shadowGenerator_lt_span_gt_.getShadowMap_lt_/span_gt_()_lt_span_gt_.renderList_lt_/span_gt__lt_span_gt_.push_lt_/span_gt_(_lt_span_gt_this_lt_/span_gt__lt_span_gt_.mesh_lt_/span_gt_[_lt_span_gt_id_lt_/span_gt_])_sm__lt_/code_gt_ })_sm__lt_br /_gt__lt_br /_gt_\n\tYou should do this for anything that requires the mesh to be already in the render loop ( particles emitter _co_ octree etc.. ) _co_ I had the issue once and it_t_s very hard to reproduce because it depends of how fast your browser performs.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"snot224","Date":"2016-11-29T15:27:21Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_152821_qt_ data-ipsquote-contentid_eq__qt_26664_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1480424731_qt_ data-ipsquote-userid_eq__qt_24090_qt_ data-ipsquote-username_eq__qt_xaero59_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t2 hours ago_co_ xaero59 said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tTry that _dd_ Make sure that your scene object is accessible anywhere in your code_co_ then in your function\n\t\t_lt_/p_gt_\n\n\t\t_lt_pre_gt_\n\n_lt_code_gt_Batiment_lt_span_gt_._lt_span_gt_prototype_lt_/span_gt__lt_/span_gt__lt_span_gt_.parametrage_lt_/span_gt__lt_/code_gt__lt_/pre_gt_\n\n\t\t_lt_p_gt_\n\t\t\t_lt_code_gt__lt_span_gt_Replace _dd_ _lt_/span_gt__lt_/code_gt_\n\t\t_lt_/p_gt_\n\n\t\t_lt_pre_gt_\n\n_lt_code_gt_shadowGenerator_lt_span_gt__lt_span_gt_.getShadowMap_lt_/span_gt__lt_/span_gt_()_lt_span_gt__lt_span_gt_.renderList_lt_/span_gt__lt_/span_gt__lt_span_gt__lt_span_gt_.push_lt_/span_gt__lt_/span_gt_(_lt_span_gt__lt_span_gt_this_lt_/span_gt__lt_/span_gt__lt_span_gt__lt_span_gt_.mesh_lt_/span_gt__lt_/span_gt_[_lt_span_gt__lt_span_gt_id_lt_/span_gt__lt_/span_gt_])_sm__lt_/code_gt__lt_/pre_gt_\n\n\t\t_lt_p_gt_\n\t\t\tBy _dd_\n\t\t_lt_/p_gt_\n\n\t\t_lt_p_gt_\n\t\t\tyourSceneObject.executeWhenReady(function() { _lt_code_gt_shadowGenerator_lt_span_gt_.getShadowMap_lt_/span_gt_()_lt_span_gt_.renderList_lt_/span_gt__lt_span_gt_.push_lt_/span_gt_(_lt_span_gt_this_lt_/span_gt__lt_span_gt_.mesh_lt_/span_gt_[_lt_span_gt_id_lt_/span_gt_])_sm__lt_/code_gt_ })_sm__lt_br /_gt__lt_br /_gt_\n\t\t\tYou should do this for anything that requires the mesh to be already in the render loop ( particles emitter _co_ octree etc.. ) _co_ I had the issue once and it_t_s very hard to reproduce because it depends of how fast your browser performs.\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tYES_co_ thanks so mush ! It is the good solution !_lt_br /_gt__lt_br /_gt_\n\tThanks man _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_br /_gt__lt_br /_gt_\n\tI understand now why sometime it worked and sometime no_co_ and why when I delete some object it works (because it take less time to be ready !_lt_br /_gt__lt_br /_gt_\n\tThanks again_co_ I could take the next step _lt_img alt_eq__qt__sm_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_wink.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/wink@2x.png 2x_qt_ title_eq__qt__sm_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]