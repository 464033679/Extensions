[{"Owner":"Vousk-prod.","Date":"2014-06-26T16:33:40Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi !_lt_/p_gt__lt_p_gt_I think I pointed a bug in ActionManager..._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Before discovering this marvelous system_co_ I used to use _lt_strong_gt_scene.pick(evt.x_co_ evt.y)_lt_/strong_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_But when the canvas is not full screen absolute position (0_co_ 0)_co_ the (evt.x_co_ evt.y) click position is not the good one for scene.pick (because it is considered as relative to the canvas_co_ but the returned values are in fact absolute inside the HTML page_co_ we then need to take account of the canvas position itself to correct the evt position)_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_To correct that_co_ I wrote this _dd__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_evtRelPos _eq_ getPointerEventRelativePosition(evt_co_ canvas)_sm_function getPointerEventRelativePosition( evt_co_ element ){    return { x_dd_ evt.clientX - element.getBoundingClientRect().left_co_ y_dd_ evt.clientY - element.getBoundingClientRect().top }_sm_}scene.pick(evtRelPos.x_co_ evtRelPos.y)_sm__lt_/pre_gt__lt_p_gt_It was all good._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_But now with the ActionManager I again suffer from the wrong positionning of the events when the canvas is lost somewhere in the HTML page. Maybe it would be easy to correct this with the little piece of code above._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-06-27T02:19:11Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_This should work I_t_m using evt.offsetX which is supposed to take care of the position_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-06-27T02:35:48Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Here is an example that works even when the canvas is not fullscreen_dd__lt_/p_gt__lt_p_gt__lt_a href_eq__qt_http_dd_//www.babylonjs.com/playground/?16_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs.com/playground/?16_lt_/a_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Vousk-prod.","Date":"2014-06-27T10:20:16Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Yes... but no _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_happy.png_qt_ alt_eq__qt_^_^_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/happy@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_evt.offsetX is stupid_co_ it doesn_t_t take correctly CSS positionning in account_co_ only HTML positionning (or something like that...). Don_t_t even mention when a page is composed of a complex mix of absolute_co_ relative_co_ and fixed elements._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Look at your exemple through a little jsfiddle _dd__lt_/p_gt__lt_p_gt__lt_a href_eq__qt_http_dd_//jsfiddle.net/vouskprod/3ueww/_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//jsfiddle.net/vouskprod/3ueww/_lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Try to locate your mesh_co_ you will need to click above them..._lt_/p_gt__lt_p_gt_With my little snippet (_lt_span_gt_getPointerEventRelativePosition)_lt_/span_gt__co_ your event logic should be fixed._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-06-27T16:32:57Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Ok I did a push with this change. Let me know if this is working. I_t_m also concerned about performance for this solution (sounds like the price of getBoundingClientRect is not that much)_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Vousk-prod.","Date":"2014-06-27T21:46:47Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hmmm... I see no difference _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_huh.png_qt_ alt_eq__qt__dd_huh_dd__qt__gt_ ... which version of bjs should I use to test ?_lt_/p_gt__lt_p_gt_(I tried 1.12_co_ 1.13-beta and 1.13-beta-debug)_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Here is the fiddle with 1.13-beta_co_ same behaviour as before _dd__lt_/p_gt__lt_p_gt__lt_a href_eq__qt_http_dd_//jsfiddle.net/vouskprod/3ueww/_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//jsfiddle.net/vouskprod/3ueww/_lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_[EDIT _dd_ it works_co_ I forgot to add hand.js lib in this test_co_ but another bug_co_ see post below]_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Vousk-prod.","Date":"2014-06-27T22:56:57Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_In fact_co_ I updated the fiddle to demonstrate that the code is working until we scroll the html page._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Try to scroll just a little (reduce your browser size or increase the CSS .some_space class width or height) and you_t_ll have to click your object at a distance equal to scroll amount._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt__lt_a href_eq__qt_http_dd_//jsfiddle.net/vouskprod/3ueww/_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//jsfiddle.net/vouskprod/3ueww/_lt_/a_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Vousk-prod.","Date":"2014-06-28T00:19:53Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_I_t_ve just did a new fiddle with some debug log to show difference between ActionManager events positionning and classic one._lt_/p_gt__lt_p_gt_Scroll the page to see the problem with ActionManager system (I put a 2000px wide DIV so I_t_m pretty sure everybody will be able to scroll at least horizontally  _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_tongue.png_qt_ alt_eq__qt__dd_P_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/tongue@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt_ )_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt__lt_a href_eq__qt_http_dd_//jsfiddle.net/vouskprod/DqRUn/_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//jsfiddle.net/vouskprod/DqRUn/_lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_(classic positionning calculations and logging info are at the end of the script)_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-06-28T00:39:29Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_This works for me. Did you clear your cache?_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Vousk-prod.","Date":"2014-06-28T11:43:27Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Ooh_co_ you know what_co_ I_t_ve just noticed that it doesn_t_t work for me... in Firefox. But it works in IE (I guess you_t_re using IE)._lt_/p_gt__lt_p_gt_I cannot test with Chrome on this PC._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Vousk-prod.","Date":"2014-06-28T11:45:36Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_(no relation _dd_ in IE the response time to change hovered mesh_t_s color to white is a little longer than in Firefox - I_t_m on an old PC here_co_ maybe it_t_s related -)_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-06-28T17:36:11Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_but I use the same code as you. this should work then if your code works for you in Firefox_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Vousk-prod.","Date":"2014-06-30T19:30:42Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p style_eq__qt_margin_dd_0in_sm_font-family_dd_Calibri_sm_font-size_dd_11pt_sm__qt__gt_Hrm_co_ that_t_s strange_co_ there must be a difference somewhere._lt_/p_gt__lt_br_gt__lt_p style_eq__qt_margin_dd_0in_sm_font-family_dd_Calibri_sm_font-size_dd_11pt_sm__qt__gt_I_t_ll try to figure out the problem_co_ where did you make all these events positionning stuff in your code ?_lt_/p_gt__lt_br_gt__lt_p style_eq__qt_margin_dd_0in_sm_font-family_dd_Calibri_sm_font-size_dd_11pt_sm__qt__gt_ _lt_/p_gt__lt_br_gt__lt_p style_eq__qt_margin_dd_0in_sm_font-family_dd_Calibri_sm_font-size_dd_11pt_sm__qt__gt_About performance _dd_ I did some test here using getBoundingClientRect and it seems that on older PCs it is a little time consuming compared to simple canvas.style.left_co_ canvas.width..._co_ but those don_t_t take windows resizing or dynamic CSS in account_co_ I_t_ll do some experiment with resize event listeners_co_ I_t_ll let you know my results._lt_/p_gt__lt_br_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Vousk-prod.","Date":"2014-07-02T08:21:01Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_After some tests getBoundingClientRect seems actually little time consuming. The only way I found is to set a permanent var canvasBounds _eq_ getBoundingClientRect()_co_ use this var for every calculations relative to positionning_co_ and update this var each time elements are resized. I put that in the window.addEventListener(_qt_resize_qt_)_co_ but sometimes the canvas is resized and not the window_co_ I then should use something like canvas.addEventListener(_qt_resize_qt_) but it seems to be never thrown_co_ it_t_s strange..._lt_/p_gt__lt_p_gt_Deltakosh I tried to locate where you are using getBoundingClientRect()_co_ to try to figure out the difference between my use which works in every browser and yours which bug in Firefox_co_ but I didn_t_t manage to find this function in your code... _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_huh.png_qt_ alt_eq__qt__dd_huh_dd__qt__gt__lt_/p_gt__lt_p_gt_(is it the hand.js file I have to update ?)_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-07-02T17:42:55Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_For some reasons It was not commited Oo_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_This should be good now (in scene.ts)_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Vousk-prod.","Date":"2014-07-02T18:05:05Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_So the bjs.1.13.beta I_t_m using in the fiddle to do some tests also does not contain the fix..._lt_/p_gt__lt_p_gt_That would explain why it doesn_t_t work._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Vousk-prod.","Date":"2014-07-02T22:02:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Ah ah your code works perfectly well now that it has been commited _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ alt_eq__qt__dd_D_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_laugh.png_qt_ alt_eq__qt__dd_lol_dd__qt__gt__lt_/p_gt__lt_p_gt_No need to debug anything! _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_cool.png_qt_ alt_eq__qt_B)_qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Regarding getBoundingClientRect()_t_s cost_co_ this method go recursively through all DOM elements and parents to calculate the actual final pos and width of the element (taking in account margins_co_ paddings_co_ borders_co_ relative/absolute positionning of everything_co_ etc). On my side I confirmed that on older PCs or mobiles/tablets the positionning of elements based on this function is a little delayed when camera or objects are moving fast (positionning is done every frame...)_co_ and it cleary makes the whole scene less fluid. That_t_s why I decided to use the following technique instead of recalculating getBoundingClientRect each call (will be a perfect solution when I_t_ll be able to catch a resize event of canvas_co_ but I only manage to catch resize event of windows_co_ don_t_t know why) _dd__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_blockquote data-ipsquote_eq__qt__qt_ class_eq__qt_ipsQuote_qt_ data-ipsquote-contentcommentid_eq__qt_45052_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentid_eq__qt_7431_qt_ data-ipsquote-username_eq__qt_Vousk-prod._qt_ data-cite_eq__qt_Vousk-prod._qt_ data-ipsquote-timestamp_eq__qt_1404289261_qt__gt__lt_div_gt__lt_div_gt__lt_p_gt_The only way I found is to set a permanent var canvasBounds _eq_ getBoundingClientRect()_co_ use this var for every calculations relative to positionning_co_ and update this var each time elements are resized. I put that in the window.addEventListener(_qt_resize_qt_)_co_ but sometimes the canvas is resized and not the window_co_ I then should use something like canvas.addEventListener(_qt_resize_qt_) but it seems to be never thrown_co_ it_t_s strange..._lt_/p_gt__lt_/div_gt__lt_/div_gt__lt_/blockquote_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_For your code_co_ we can just watch and wait for users feedbacks in case of numerous event listeners. But according to your post _dd__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_blockquote data-ipsquote_eq__qt__qt_ class_eq__qt_ipsQuote_qt_ data-ipsquote-contentcommentid_eq__qt_44408_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentid_eq__qt_7431_qt_ data-ipsquote-username_eq__qt_Deltakosh_qt_ data-cite_eq__qt_Deltakosh_qt_ data-ipsquote-timestamp_eq__qt_1403840671_qt__gt__lt_div_gt__lt_div_gt__lt_p_gt_Each time the mouse is moving it checks ALL actionManager to check if they have a trigger to launch. That_t_s why _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt__lt_/div_gt__lt_/div_gt__lt_/blockquote_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I don_t_t exactly know where and how you call getBoundingClientRect()_co_ but if it_t_s really so often I can tell you for sure that it will make a big performance drop sooner or later..._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-07-02T23:53:31Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_I_t_m working on a way to optimize that _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Vousk-prod.","Date":"2014-07-03T00:03:48Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_I_t_m sure you do. With thousands other improvements and debugging at the same time_co_ while answering tons of forum posts _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_tongue.png_qt_ alt_eq__qt__dd_P_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/tongue@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt__lt_p_gt_Do you ever sleep_co_ sometimes ?_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-07-03T14:54:08Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_not too much_dd_)_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]