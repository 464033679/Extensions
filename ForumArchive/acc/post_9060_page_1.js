[{"Owner":"Tyrahell","Date":"2014-09-08T13:29:34Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hello everybody_co__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_After some time dealing with Vector3.unproject()_co_ i got serious doubt about my way to use it._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I try to unproject a screen vector (1_co_0_co_0) to a world coordinate vector and the result of unproject() is always the same even if the ViewMatrix or WorldMatrix is changing._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Here is my code _dd__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_var pMScene _eq_ myScene.getProjectionMatrix()_sm_var vMScene _eq_ myScene.getViewMatrix()_sm_var wMCamera _eq_ myScene.activeCamera.getWorldMatrix()_sm_var globalView _eq_ myScene.activeCamera.viewport.toGlobal(engine)_sm_var ViewportWidth _eq_ globalView.width_sm_var ViewportHeight _eq_ globalView.height_sm_\tvar screenVector _eq_ new BABYLON.Vector3(1_co_0_co_0)_sm_var worldVector _eq_ BABYLON.Vector3.Unproject( screenVector_co_ ViewportWidth_co_ ViewportHeight_co_ wMCamera_co_ vMScene_co_ pMScene )_sm__lt_/pre_gt__lt_p_gt_My projection Matrix is constant _dd__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_1.6_co_ 0_co_ 0_co_ 0_co__lt_/p_gt__lt_p_gt_0_co_ 2.4_co_ 0_co_ 0_co__lt_/p_gt__lt_p_gt_0_co_ 0_co_ 1_co_ 1_lt_/p_gt__lt_p_gt_0_co_ 0_co_ -0.1_co_ 0_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_My viewMatrix depends of the scene view_co_ quite logical_co_ same for the worldMatrix depending from the camera fov._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_My viewport seems correct _dd_ width _eq_ 1200_co_ height _eq_ 900._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_And my unprojected vector (1_co_ 0_co_ 0) is always (-0.051_co_ 0.042_co_ 0.1 ) _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_angry.png_qt_ alt_eq__qt__dd_angry_dd__qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Am i doing something wrong ?_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_++Tyra _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_ohmy.png_qt_ alt_eq__qt__dd_o_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/ohmy@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt_ Lost in spaces..._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_ _lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Temechon","Date":"2014-09-08T14:24:44Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi_co_ _lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Can you try by using this _dd_ _lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_var wMCamera _eq_ BABYLON.Matrix.Identity()_sm__lt_/pre_gt__lt_p_gt_Anyway_co_ what are you trying to do ? You have an example of creating a picking ray here_co_ maybe that can help _dd_ _lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_Scene.prototype.createPickingRay()_lt_/pre_gt__lt_p_gt_Cheers_co_ _lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Tyrahell","Date":"2014-09-08T15:00:18Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Well_co_ im trying to express a screen unit vector into a world vector to translate my geometry _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_huh.png_qt_ alt_eq__qt__dd_huh_dd__qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Does unproject() seems to be the way to go ?_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_++Tyra _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_ph34r.png_qt_ alt_eq__qt__dd_ph34r_dd__qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/ph34r@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-09-08T17:51:24Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_You are right unproject is the good way to do that_dd_)_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_But if you want to unproject into world_co_ the world matrix must be set to identity. You have to use it if you want to unproject into a mesh local world._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Temechon","Date":"2014-09-09T06:50:53Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Here is a solution_co_ what do you think about it ? _lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_        var pMScene _eq_ scene.getProjectionMatrix()_sm_        var vMScene _eq_ scene.getViewMatrix()_sm_        var wMCamera _eq_ BABYLON.Matrix.Identity()_sm_ //scene.activeCamera.getWorldMatrix()_sm_        var globalView _eq_ scene.activeCamera.viewport.toGlobal(engine)_sm_        var ViewportWidth _eq_ globalView.width_sm_        var ViewportHeight _eq_ globalView.height_sm_        var screenVector _eq_ new BABYLON.Vector3(0_co_0_co_0)_sm_        var screenVector2 _eq_ new BABYLON.Vector3(1_co_0_co_0)_sm_        var worldVector _eq_ BABYLON.Vector3.Unproject( screenVector_co_ ViewportWidth_co_ ViewportHeight_co_ wMCamera_co_ vMScene_co_ pMScene )_sm_        var worldVector2 _eq_ BABYLON.Vector3.Unproject( screenVector2_co_ ViewportWidth_co_ ViewportHeight_co_ wMCamera_co_ vMScene_co_ pMScene )_sm_        var res _eq_ worldVector2.subtract(worldVector)_sm_        res.normalize()_sm_        box.locallyTranslate(res)_sm__lt_/pre_gt__lt_p_gt_Cheers_co_ _lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Tyrahell","Date":"2014-09-09T15:15:41Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Temechon and DK your awesome !_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Thanks to you i can now design my own arcrotatecamera with translation on right-clic like CAD software !_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Ill publish some code sample for the community when it will be over _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_wink.png_qt_ alt_eq__qt__sm_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/wink@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I close this topic and go back to the other one to finish my arcrotatecamera with translation!_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Thanks thanks thanks _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_tongue.png_qt_ alt_eq__qt__dd_P_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/tongue@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ alt_eq__qt__dd_D_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_laugh.png_qt_ alt_eq__qt__dd_lol_dd__qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]