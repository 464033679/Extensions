[{"Owner":"mediabounds","Date":"2014-07-22T17:03:45Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_I_t_m getting up-to-speed on developing with Babylon.js and I_t_m having a problem with physics simulations and initial rotation on a mesh_dd__lt_/p_gt__lt_p_gt__lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_07_2014/post-9762-0-61804200-1406048082.gif_qt_ rel_eq__qt_external nofollow_qt__gt__lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_07_2014/post-9762-0-61804200-1406048082.gif_qt_ data-fileid_eq__qt_2275_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ alt_eq__qt_post-9762-0-61804200-1406048082.gif_qt__gt__lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_You_t_ll notice that the box and the ball bounce off the air above the _qt_ground._qt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_My expectation is that both the box and the ball would land on the surface of the ground. It works as expected if there is no initial rotation. The greater the rotation_co_ the more obvious the problem. Here_t_s how I_t_m rotating the ground_dd__lt_/p_gt__lt_div_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_var ground _eq_ BABYLON.Mesh.CreateBox(_qt_ground_qt__co_ 10_co_ scene)_sm_ground.rotate(BABYLON.Axis.Z_co_ .3_co_ BABYLON.Space.LOCAL)_sm_ground.setPhysicsState(BABYLON.PhysicsEngine.BoxImpostor_co_ {mass_dd_0_co_ friction_dd_0.5_co_ restitution_dd_ 0.4})_sm__lt_/pre_gt__lt_/div_gt__lt_p_gt_If it helps_co_ here_t_s all the code I_t_m using to create the scene_dd__lt_/p_gt__lt_div_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_var createPrototypeScene _eq_ function(engine) {var scene _eq_ new BABYLON.Scene(engine)_sm_var camera _eq_ new BABYLON.FreeCamera(_qt_Camera_qt__co_ new BABYLON.Vector3(0_co_ 10_co_ -40)_co_ scene)_sm_var light0 _eq_ new BABYLON.DirectionalLight(_qt_Omni_qt__co_ new BABYLON.Vector3(-2_co_ -5_co_ 2)_co_ scene)_sm_var light1 _eq_ new BABYLON.PointLight(_qt_Omni_qt__co_ new BABYLON.Vector3(2_co_ -5_co_ -2)_co_ scene)_sm_camera.setTarget(new BABYLON.Vector3(0_co_ 0_co_ 0))_sm_scene.enablePhysics(null_co_ new BABYLON.CannonJSPlugin())_sm_// Create the groundvar ground _eq_ BABYLON.Mesh.CreateBox(_qt_ground_qt__co_ 10_co_ scene)_sm_ground.rotate(BABYLON.Axis.Z_co_ .3_co_ BABYLON.Space.LOCAL)_sm_ground.setPhysicsState(BABYLON.PhysicsEngine.BoxImpostor_co_ {mass_dd_0_co_ friction_dd_0.5_co_ restitution_dd_ 0.4})_sm_// Create the ballvar ball _eq_ BABYLON.Mesh.CreateSphere(_qt_ball_qt__co_ 16_co_ 1_co_ scene)_sm_ball.material _eq_ new BABYLON.StandardMaterial(_qt_ball_qt__co_ scene)_sm_ball.material.wireframe _eq_ true_sm_ball.position _eq_ new BABYLON.Vector3(3_co_ 20_co_ 0)_sm_ball.setPhysicsState(BABYLON.PhysicsEngine.SphereImpostor_co_ { mass_dd_ 5 })_sm_var box _eq_ BABYLON.Mesh.CreateBox(_qt_box_qt__co_ 3_co_ scene)_sm_box.position _eq_ new BABYLON.Vector3(0_co_ 15_co_ 0)_sm_box.setPhysicsState(BABYLON.PhysicsEngine.BoxImpostor_co_ {mass_dd_ 1})_sm_return scene_sm_}_lt_/pre_gt__lt_p_gt_Thanks!_lt_/p_gt__lt_/div_gt__lt_p_gt_ _lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2014-07-23T21:28:03Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi MB_co_ welcome to the forum.  I have no solution_co_ but I made a Run-able playground scene for this... at..._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt__lt_a href_eq__qt_http_dd_//www.babylonjs.com/playground/#1AAQUN_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs.com/playground/#1AAQUN_lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Strange situation... easy to see it happen.  *scratch scratch*  The experts will have comments_co_ soon_co_ I suspect.  _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Kilombo","Date":"2014-07-23T23:51:33Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Quite strange really_co_ I took wingnut example_co_ and added another box and sphere 1 pixel bigger_co_ then I parented them to the first ones_co_ and the problem got a bit better. I think that maybe cannon.js creates something like a _qt_invizible box_qt_ that makes the original one a bit larger but it gets unseen (just specullating of course)._lt_/p_gt__lt_p_gt_Where_t_s the example_dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs.com/playground/#26L9IU%231_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs.com/playground/#26L9IU#1_lt_/a_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Temechon","Date":"2014-07-24T07:25:28Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_I think this problem is linked to the physic body size calculation. In CannonJs (and in OimoJs)_co_ all registered mesh is linekd to a _t_body_t_ _dd_ an invisible object linked to the physic engine._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Here is how the body size is processed with CannonJs _dd_ _lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_bbox _eq_ mesh.getBoundingInfo().boundingBox_sm_var min _eq_ bbox.minimumWorld_sm_var max _eq_ bbox.maximumWorld_sm_var box _eq_ max.subtract(min).scale(0.5)_sm__lt_/pre_gt__lt_p_gt_This code does not take into account the rotation at all (the maximum point of a box is ok when the box is not rotated)._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Temechon","Date":"2014-07-24T08:38:21Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_This problem is fixed in Oimo plugin with this _dd_ _lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_bbox _eq_ mesh.getBoundingInfo().boundingBox_sm_var size _eq_ bbox.extends.scale(2).multiply(mesh.scaling)_sm_ _lt_/pre_gt__lt_p_gt_I don_t_t know if this will fix the problem in CannonJs._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Fixed in Oimo.js _dd_ _lt_a href_eq__qt_http_dd_//pixelcodr.com/oimo3/_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//pixelcodr.com/oimo3/_lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_EDIT _dd_ Updated to take scaling into account._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"mediabounds","Date":"2014-07-24T14:29:11Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_I believe Temechon is right about the problem being the physics size calculation._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_If I go straight to the physics plugin and rotate it_t_s body instead of the Babylon Mesh_co_ it behaves correctly_dd__lt_/p_gt__lt_p_gt__lt_a href_eq__qt_http_dd_//www.babylonjs.com/playground/#1AAQUN%232_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs.com/playground/#1AAQUN#2_lt_/a_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Kilombo","Date":"2014-07-24T20:43:00Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Temechon it_t_s probably right _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ alt_eq__qt__dd_D_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt_ Is the man of the physics engines _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ alt_eq__qt__dd_D_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__co_ If he says so_co_ probably he_t_s right _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ alt_eq__qt__dd_D_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]