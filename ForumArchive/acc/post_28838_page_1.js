[{"Owner":"royibernthal","Date":"2017-03-05T00:17:13Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tGiven a class instance_co_ is there a way to know in runtime if it belongs to bjs or canvas2d namespaces via ts/js?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tFor instance_co_ if I have an instance of BABYLON.AbstractMesh_co_ the check will return true because it belongs to the BABYLON namespace.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIs there perhaps some property/function that exists in all bjs classes?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"fenomas","Date":"2017-03-05T05:44:58Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI don_t_t think there_t_s a robust way to do this. You can check for specific cases_co_ like_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_myMesh instanceof BABYLON.Node_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t..because meshes all inherit from Node_co_ but there_t_s no single root that every BJS class inherits from.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAlternately_co_ you could check for property names like _lt_strong_gt_foo._scene_lt_/strong_gt_ or _lt_strong_gt_foo.__serializableMembers_lt_/strong_gt_ because many Babylon objects have them_co_ but there are many others that don_t_t.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIf those aren_t_t enough_co_ this seems like a bad code smell - there_t_s probably a better solution than introspection.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"royibernthal","Date":"2017-03-06T00:10:40Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI have a dispose function which recursively iterates over objects and calls their dispose function (if exists).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe problem is_co_ doing that on some bjs objects (e.g. meshes) results in an infinite recursion_co_ on bjs objects I_t_d just like to call their dispose function without iterating over them recursively_co_ the recourse is meant for my project_t_s objects.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI could do some ugly workarounds like adding to each of my project_t_s objects some shared property in order to be able to identify it at runtime_co_ but I_t_d like to avoid that.\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_static dispose(value_dd_ any)_dd_ void {\n\tif (value _eq__eq_ null) return_sm_\n\n\t//TODO_dd_ don_t_t iterate over objects that belong to bjs as it_t_ll result in an infinite recursion\n\tif (typeof value _eq__eq__eq_ _t_object_t_) {\n\t\tfor (var key in value) {\n\t\t\tdispose( value[key] )_sm_\n\t\t}\n\t}\n\telse if (value.dispose !_eq_ null) value.dispose()_sm_\n}_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tDoes that code smell bad?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"AlbertTJames","Date":"2017-03-06T08:02:43Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi! \n_lt_/p_gt_\n\n_lt_p_gt_\n\tWhat would be the use case of this function ?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tTwo ways to check the class of which the object is an instance of _dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_if (object.constructor _eq__eq__eq_ BABYLON.Canvas2D) {}\nif (object instanceof BABYLON.Canvas2D) {}_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tTo check if there is a dispose function_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_if ((object.hasOwnProperty(_qt_dispose_qt_))&amp_sm_&amp_sm_(object.dispose.constructor _eq__eq__eq_ Function)) {}_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"fenomas","Date":"2017-03-06T08:27:07Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_166009_qt_ data-ipsquote-contentid_eq__qt_28838_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1488759040_qt_ data-ipsquote-userid_eq__qt_8420_qt_ data-ipsquote-username_eq__qt_royibernthal_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t8 hours ago_co_ royibernthal said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tDoes that code smell bad?\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tI_t_m just guessing out of context_co_ but my guess would be yes _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_ \n_lt_/p_gt_\n\n_lt_p_gt_\n\tI mean_co_ in the narrow sense_dd_ it only makes sense to recursively walk through a data structure if that data is a tree of some kind. If I understand you right_co_ you have one set of objects where that_t_s the case_co_ which are being managed together with some BJS objects? However since BJS objects don_t_t live in any kind of tree structure_co_ probably they need to be managed separately from other stuff that is.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tBut more generally_co_ a given object_t_s dispose function should internally dispose any other assets that that object is responsible for_co_ right? I think (but haven_t_t confirmed in any detail) that most Babylon objects behave this way - so calling mesh.dispose() should already dispose any assets that can be safely disposed with that mesh. So that_t_s what I meant about recursively walking through a data structure disposing everything sounding like an iffy thing to do.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tNot meaning this as criticism of course - naturally you could have good reasons for doing it that I don_t_t know about.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JCPalmer","Date":"2017-03-06T15:41:56Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tI have not used Canvas 2D_co_ but you might get rewarded by checking if layermask can be found in a source text search.  If Canvas 2D is implemented with its own camera_t_s_co_  then layermask are highly likely how canvas 2d identifies which meshes are its.\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"royibernthal","Date":"2017-03-07T17:16:21Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/12925-fenomas/?do_eq_hovercard_qt_ data-mentionid_eq__qt_12925_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/12925-fenomas/_qt_ rel_eq__qt__qt__gt_@fenomas_lt_/a_gt_ Something felt weird and I wasn_t_t able to put my finger on it. This was some old undocumented code which I decided to _qt_upgrade_qt_ from iterating over arrays to iterating over objects as well.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe original intention was to allow passing multiple objects to this functions in an array_co_ manually and intentionally_co_ and not to recursively iterate over objects.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tNeedless to say_co_ I documented it so I won_t_t forget it again _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_static dispose(value_dd_ any | any[])_dd_ void {\n\tif (value _eq__eq_ null) return_sm_\n\t\n\tif (value instanceof Array) value.forEach(item _eq_&gt_sm_ MemoryUtils.dispose(item))_sm_\n\telse if (value.dispose !_eq_ null) value.dispose()_sm_\n}_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tThanks for the help everybody_co_ your answers are helpful if I were to stick with the approach mentioned in the topic.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]