[{"Owner":"satguru","Date":"2018-06-18T14:07:27Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tLooks like the obj loader is not finished loading material when the BABYLON.SceneLoader.ImportMesh() onSuccess function is called.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tsee\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/loaders/src/OBJ/babylon.objFileLoader.ts#L231_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/loaders/src/OBJ/babylon.objFileLoader.ts#L231_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI need to make changes to the mesh material after the mesh is loaded by the obj loader.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHow would i know when the obj loader is done loading the material?\n_lt_/p_gt_\n\n_lt_p_gt_\n\twhat is the most reliable method for doing that?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"dbawel","Date":"2018-06-18T15:40:25Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI can_t_t tell without a PG example. This is simple to troubleshoot if you simply load your OBJ into the playground. You may need to edit your OBJ and/or material file_co_ or perhaps there_t_s not time to load the texture - however this is rare.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tDB\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIs your OBJ_co_ MTL_co_ and image file int the same directory? Are you using power of 2 texturing?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tEDIT - In looking further at your code_co_ I can see allot of declarations that perhaps won_t_t allow the mapping of a texture. I haven_t_t figured out why you_t_re addressing UVs_co_ but the OBJ importer is simple yet fickle if you make one error. Also_co_ if the issue is not the texture and it is the material_co_ then edit your OBJ file to remove reference to the material_co_ and reference in the MTL file to a texture if necessary. Eliminating the reference to the MTL file in the OBJ file will provide a very nice default texture - which could be your issue depending on how the OBJ was generated and if you already applied any materials.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"satguru","Date":"2018-06-18T16:44:29Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHere_t_s a PG example.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#UKNERM%2311_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#UKNERM#11_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThis loads a small obj file _qt_TallWall.obj_qt_. The obj file has a small mtl file _qt_TallWall.mtl_qt_._lt_br /_gt_\n\tNo textures_co_ just colors.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe files are located here  _lt_a href_eq__qt_https_dd_//github.com/ssatguru/obj-samples_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/ssatguru/obj-samples_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIn the PG example I print _qt_mesh.material_qt_ from two places\n_lt_/p_gt_\n\n_lt_p_gt_\n\t1) from inside the   ImportMesh() OnSuccess  method and\n_lt_/p_gt_\n\n_lt_p_gt_\n\t2) outside it after waiting 2 secs.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tInside I get undefined _co_ outside_co_ after 2 sec_co_ I get the material\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"brianzinn","Date":"2018-06-18T16:57:22Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI_t_ve ran into this before as well.  The comment that it_t_s loaded syncronously (_lt_span style_eq__qt_background-color_dd_#fffbdd_sm_color_dd_#6a737d_sm_font-size_dd_12px_sm__qt__gt_Calls synchronously the MTL file attached to this ob_lt_/span_gt_) was what confused me last time I checked - I found it to be async._lt_br /_gt_\n\t_lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Tools/babylon.tools.ts#L634_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Tools/babylon.tools.ts#L634_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tCheck here as well_dd__lt_br /_gt_\n\t_lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/loaders/src/OBJ/babylon.objFileLoader.ts#L860_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/loaders/src/OBJ/babylon.objFileLoader.ts#L860_lt_/a_gt__lt_br /_gt_\n\tNotice the onSuccess() just attaches the material and if I recall correctly the onSucess() you are working with is just that the OBJ file loaded_co_ where material is async.  I don_t_t see a way to wire into material loading except manually checking in a loop (2 seconds is not a guarantee on a slower connection) or updating the loader itself to trigger (additional) events._lt_br /_gt_\n\t_lt_br /_gt_\n\tOne easy solution is to switch from OBJ...  I_t_m using OBJ files_co_ but not MTL materials.  Other standards include material in original file._lt_br /_gt_\n\t_lt_br /_gt_\n\tedit_dd_ If you want to work on the loader to delay onSuccess until materials are loaded_co_ it could be added as an option.  ie_dd_ { onSuccessWithMaterials_dd_ true }_co_ which defaults to false.  I think you need to get importMesh(...) to not return until materials are loaded_co_ probably not done as it could block for a while.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"dbawel","Date":"2018-06-19T07:44:12Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tAs stated previously_co_ edit out the mtl file and create you_t_re own_co_ or follow the correct protocol.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tDB\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"RaananW","Date":"2018-06-19T09:19:11Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/issues/4571_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/issues/4571_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIssue submitted_co_ I agree that it should be async and not sync.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"satguru","Date":"2018-06-19T14:25:07Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tNice. Thanks\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Sebavan","Date":"2018-06-19T17:01:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThis should be all deployed in a minute.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"satguru","Date":"2018-06-20T00:56:30Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tWorks fine now _lt_span_gt__lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_ Thanks_lt_/span_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]