[{"Owner":"jerome","Date":"2016-12-16T16:02:12Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThis post is the gathering of old posts getting far from their original topic to a new one _dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe ability to have some facet data for any mesh_co_ like facet normal data_co_ facet position data_co_ facet area data_co_ etc_co_ etc\n_lt_/p_gt_\n\n_lt_p_gt_\n\tFor now_co_ it_t_s still a prototype.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHere you have the facet normal and position data used. More over a (naive and simple) internal octree is built by giving its number of subdivisions per axis (because the octree can_t_t know the mesh geometry a priori) at the line 230. I added at the line 234 a simple octree visualizer (no plane on Z else it_t_s hardly visible)\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#2KXNQ6_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#2KXNQ6_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWhen the little red ball enter one the mesh octree block_co_ a green box is set on the closest facet to the ball in the same block.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIt should work with any mesh now (I hope). The code is commented... because I get some holidays and will probably forget everything before I take it back.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSome tests _dd_ icosphere _eq_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#2KXNQ6%231_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#2KXNQ6#1_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tdifferent octree (10 sub on x_co_ 2 on other axis) _eq_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#2KXNQ6%232_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#2KXNQ6#2_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\ttorus knot with a 10 x10 x 10 octree _eq_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#2KXNQ6%233_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#2KXNQ6#3_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tactually_co_ the octree size should be chosen in order that no mesh will be bigger than an octree block... else it_t_s not efficient. So set it to have some or many facets inside each block.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tmore visible _eq_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#2KXNQ6%234_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#2KXNQ6#4_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThere_t_s no use of any ray here.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI intend (next year_co_ now) to make a demo of custom collisions (physics) of plenty of solid particles bouncing against any kind of shape... even against dynamically morphed ones_co_ at 60 fps if possible.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t[EDIT] Ribbon test _eq_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#2KXNQ6%235_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#2KXNQ6#5_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tOld related posts _dd_\n_lt_/p_gt_\n_lt_iframe data-embedcontent_eq__qt__qt_ frameborder_eq__qt_0_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/topic/27092-working-with-individual-mesh-facets/?do_eq_embed_qt__gt__lt_/iframe_gt__lt_iframe data-embedcontent_eq__qt__qt_ frameborder_eq__qt_0_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/topic/26110-angle-of-mesh-intersection/?do_eq_embed_qt__gt__lt_/iframe_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JohnK","Date":"2016-12-17T10:14:58Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/5453-jerome/?do_eq_hovercard_qt_ data-mentionid_eq__qt_5453_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/5453-jerome/_qt_ rel_eq__qt__qt__gt_@jerome_lt_/a_gt_ still playing with with it. Now have added working with individual faces - getFaceData_co_  tidied up the setFacetColor and added setFaceColor (as you said needs a flat shaded mesh). Also for consistency have changed your nbFaces in getFacetData to nbFacets. Hope my uses of faces as well as facets do not confuse too many people.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1CRS0Z%233_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1CRS0Z#3_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-12-17T11:24:40Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\treally nice _dd_-)\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"adam","Date":"2016-12-17T14:47:50Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tWhy is it that you can only color 4 facets?\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JohnK","Date":"2016-12-17T16:52:37Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\t4 was just a test you can do from 1 to all\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"adam","Date":"2016-12-17T17:00:26Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tThanks John.  I wasn_t_t setting the colors correctly when testing.\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-12-17T17:40:26Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI think you can even set one color in the middle of the array\n_lt_/p_gt_\n\n_lt_p_gt_\n\tsay_co_ you_t_ve got 3000 facets_co_ just create a new Array(3000)_co_ called_co_  say_co_ colors\n_lt_/p_gt_\n\n_lt_p_gt_\n\tand set only the i-th element _dd_ colors[1500].r _eq_ 0.0\n_lt_/p_gt_\n\n_lt_p_gt_\n\tthis should work_co_ I think ...\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tAbout _lt_em_gt_getFacetData()_lt_/em_gt__co_ I think that I will refactor it directly in _lt_em_gt_ComputeNormals(_lt_/em_gt_). Indeed_co__lt_em_gt_ getFacetData()_lt_/em_gt_ shares 98% of its code with _lt_em_gt_ComputeNormals()_lt_/em_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSo I think_co_ instead of _lt_em_gt_ComputeNormals(positions_co_ indices_co_ normals)_lt_/em_gt__co_ we could then now have _lt_em_gt_ComputeNormals(positions_co_ indices_co_ normals_co_ { options})_lt_/em_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\twhere _lt_em_gt_options_lt_/em_gt_ could be _dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tfacetNormals (array) \n_lt_/p_gt_\n\n_lt_p_gt_\n\tfacetPositions (array)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tfacetAreas (array)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tfacetColors (array) maybe\n_lt_/p_gt_\n\n_lt_p_gt_\n\tall optionals and computed then returned_co_ if passed to _lt_em_gt_ComputeNormals()_lt_/em_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThis would be very fast and a single iteration on all the indices/positions array\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JohnK","Date":"2016-12-17T18:59:23Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tFrom my point of view I was just playing with facet and face colors and don_t_t expect many people will be interested so happy for them not to be included. \n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-12-19T11:41:01Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tLet_t_s go _dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tA sphere flies and collides a mesh. When it hits the mesh_co_ it slides on its surface as long it detects a new facet in its current direction.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThere_t_s no ray here and no knowledge of the mesh geometry etiher... so it should work with any mesh _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3%231_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3#1_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI let you discover the scene code what is quite simple.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI_t_ll provide some other examples soon to check if it fits_co_ as I expect_co_ any mesh shape_co_ even dynamically morphed ones and if it can be stressed to support a great number of collisions per frame.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tnote _dd_ for now_co_ it only works in the local space_co_ so don_t_t rotate_co_ scale or move the mesh\n_lt_/p_gt_\n\n_lt_p_gt_\n\t[EDIT] cylinder _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3%232_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3#2_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tTorus knot _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3%233_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3#3_lt_/a_gt_  (funny)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tstill a bug with the box _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3%234_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3#4_lt_/a_gt_ and tetrahedron _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3%235_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3#5_lt_/a_gt_ (related to some wrong size octree size_co_ I suppose)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tbut works better with more facets _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3%236_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3#6_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3%237_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3#7_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3%238_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3#8_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tthe same with an octree 10 x 10 x 10 instead of 4 x 4 x 4 is more performant _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3%239_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3#9_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tnote that the behavior (this one _dd_ ball flying_co_ etc_co_ independant from the mesh/octree) could be different with the automtatic octree computation (27 blocs per axis here) _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3%2310_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3#10_lt_/a_gt_  ... the ball exits quickly the surface_co_ because less facets per block\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tIf the mesh has enough facets (dozens or hundreds or more) the automatic octree computation seems to be good enough _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3%2311_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3#11_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\talthough_co_ when the mesh becomes bigger (in terms of facets) the automatic computation is not that good _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3%2312_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3#12_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tsetting manual values (l 49) is then better _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1SZHS3%2313_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1SZHS3#13_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe torus knot is a good example of a difficult mesh to manage because it has external facets inside its internal concave global shape_co_ not only around an external surface like a sphere_co_ a regular polyhedron_co_ etc. The automatic octree computation assumes that the mesh is concave and could be homogeneously projected on its bouding box... so in average the same number of facets on each of the 6 box sides.  This rule won_t_t work for more complex meshes like the torus knot_co_ so a manual setting will be better.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tNext challenge to meet _dd_ collide a random spherical harmonics \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-12-20T11:15:12Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tSpherical Harmonics facet data self challenge _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1AD81E_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1AD81E_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tplain _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1AD81E%231_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1AD81E#1_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\truns at 60 fps in Chrome here\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2016-12-20T13:15:25Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tYou_t_re a MADMAN_co_ Jerome!!!  Phenomenal stuff!  Wow!  What a great xmas gift you have given us!  The _lt_a href_eq__qt_https_dd_//moviewriternyu.files.wordpress.com/2015/01/snowglobe-2.jpg_qt_ rel_eq__qt_external nofollow_qt__gt_snow globe_lt_/a_gt_ project has a definite good chance for success... with snow sliding along slanted roofs and slanted tree limbs.  Yum!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tDo you foresee ._lt_em_gt_faceNormal_lt_/em_gt_ being added to _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/classes/2.5/PickingInfo_qt_ rel_eq__qt_external nofollow_qt__gt_PickingInfo_lt_/a_gt_?  (a sister to _lt_em_gt_faceId_lt_/em_gt_)\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-12-20T13:51:10Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tFor now_co_ this just a prototype_co_ some work in progress ...\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI need to provide many PG examples at first to let people play with it and try to find the weaknesses. I need also to stress the model _dd_ I intend to make many solid particles collide a morphing ribbon to check how it behaves_co_ especially in terms of performances and to compare this with the same that would be designed with ray collisions.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThen_co_ I need to refactor this prototype _dd_ better var names and probably to embedded it in the function _lt_em_gt_ComputeNormals() _lt_/em_gt_so the facetData_co_ the internal mesh octree and the normals would be computed in the same lone iteration over all the mesh vertices_co_ what would be faster (currently there are two _dd_ one for normals when the mesh is morphed_co_ and quite exactly the same for the facet data). I also need to ask the experts for a better or smarter octree implementation.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThen only... everything will be possible to inject it in the BJS core (what is actually not a big addition in term of LOC) and to make it interact with any other current parts like _lt_em_gt_pickingInfo_lt_/em_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t[EDIT] different original velocity vector and different octree _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1AD81E%232_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1AD81E#2_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI suppose that a fair bounce instead of a slide-and-continue behavior would be more pertinent to understand how the collision is detected\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t[EDIT 2] a SH is not a good candidate to show the facet collision detection_co_ because it_t_s a complex shape_co_ with some concave and some convex parts_co_ with some inverted facets_co_ some quite reduced to zero while others are very big_co_ etc... this demo as just to test the facetData against a complex morphing mesh\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-12-20T19:37:56Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tThe same with a fair bounce on collision instead of slide &amp_sm_ quit _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1AD81E%234_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1AD81E#4_lt_/a_gt_\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-12-21T13:49:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tlittle improvement (octree size bigger than the mesh bounding box for 10%) _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1AD81E%235_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1AD81E#5_lt_/a_gt_\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"gryff","Date":"2016-12-21T14:15:28Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/5453-jerome/?do_eq_hovercard_qt_ data-mentionid_eq__qt_5453_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/5453-jerome/_qt_ rel_eq__qt__qt__gt_@jerome_lt_/a_gt_ _dd_ I_t_ve said it before_co_ and I_t_ll say it again_co_ your PGs are fascinating (almost hypnotic) to me. One day_co_ hopefully soon_co_ I have to spend time with the SPS system and see if this wimpy coder can understand it _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/5733-wingnut/?do_eq_hovercard_qt_ data-mentionid_eq__qt_5733_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/5733-wingnut/_qt_ rel_eq__qt__qt__gt_@Wingnut_lt_/a_gt_ _dd_ That snow globe thought takes me back to my first or second Christmas using VRML. Some guys at Sun (I think?) built one. A Christmas tree inside the globe with a model train going around it. _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_ \n_lt_/p_gt_\n\n_lt_p_gt_\n\tcheers_co_ gryff _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-12-21T19:00:05Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tmany thanks _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/7026-gryff/?do_eq_hovercard_qt_ data-mentionid_eq__qt_7026_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/7026-gryff/_qt_ rel_eq__qt__qt__gt_@gryff_lt_/a_gt_ _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2017-01-03T15:39:33Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi_co_ in this new year ...\n_lt_/p_gt_\n\n_lt_p_gt_\n\there_t_s (still prototype) a complete refactor of my facet data project _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1AD81E%236_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1AD81E#6_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWhat_t_s different ?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tNow_co_ the mesh has new properties _dd_ an array facetNormals and an array facetPositions (no longer facetData objects)_co_ both containing Vector3. Why two arrays instead of facetData objects ? because now_co_ the facet positions and normals (and the internal octree that I won_t_t speak about for now) are all computed in the same call than the one for the mesh normals_co_ also known as the famous _lt_em_gt_VertexData.ComputeNormals()_lt_/em_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tA new version of this method is coded under the the code of _lt_em_gt_createScene()_lt_/em_gt_ at the line 279.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThis means only one single loop to update the normals and all the mesh facet data even when the mesh is dynamically morphed.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAnd more simple methods for the final user. As you can see from the line 145_co_ the function _lt_em_gt_registerBeforeRender()_lt_/em_gt_ is quite easy now to understand.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI hope I can make you a decent PG soon with some stress on this prototype to check if it behaves like I hope. My challenge _dd_ to throw thousands of solid particles on a dynamically morphed moving ribbon and to make them bounce against it at 60 fps.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2017-01-04T10:53:58Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tit looks like I had a bug in the bounce computation_co_ better here _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1AD81E%237_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1AD81E#7 _lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t(not easy to check with such strange shapes as SH)\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2017-01-05T14:18:47Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tTadaaannnnnnn\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#CNMNR_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#CNMNR_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\twell_co_ the physics are my own and not that complex (still a little buggy if the mesh is translated or if a ball keeps in the bottom of the convex shape when immobile)... anyway_co_ the goal is just to show a real case of use of facet data _dd_ facet normals_co_ positions and mesh internal octree. By the way the octree has been refactored_co_ optimized and simplified.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIn this example_co_ you_t_ve got 500 solid particles (spheres) falling and collinding a mesh (a ribbon). There_t_s no impostor_co_ the mesh can have any wanted shape and the balls don_t_t know anything about the mesh geometry.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tStress test _dd_ same example with 2000 balls_co_ still running at 60 fps in Chrome here when executed out off the playground _lt_a href_eq__qt_http_dd_//jerome.bousquie.fr/BJS/test/facetdata2.html_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//jerome.bousquie.fr/BJS/test/facetdata2.html_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2017-01-05T15:09:18Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThis seems to work also with dynamically updated meshes _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1UAOG0%232_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1UAOG0#2_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tmore visible _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1UAOG0%233_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1UAOG0#3_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2017-01-05T15:31:04Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tultra stress test _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1UAOG0%231_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1UAOG0#1_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tthis one runs at 60 fps with 10000 tetrahedrons on my desktop in chrome_co_ outside the PG.... don_t_t click if your PC is weak CPU wise\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-01-05T16:23:37Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tThis is REALLY COOL. PR? _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2017-01-05T17:40:52Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tstill need plenty of tests_co_ tweakings_co_ etc_co_ etc\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tactually the facet normals and positions are already OK and can be embedded in the function ComputeNormals() at no cost (10 more lines only)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI still need to tweak the octree part\n_lt_/p_gt_\n\n_lt_p_gt_\n\tFor now_co_ we could do _lt_em_gt_VertexData.ComputeNormals(positions_co_ indices_co_ normals_co_ {facetPositions_dd_ array1_co_ facetNormals_dd_ array2})_lt_/em_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tif passed (optional) array1 and arrray2 are populated with the facet normals and positions within the same loop than the mesh normal computation\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2017-01-05T19:52:14Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tskull.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tskull ..?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tskull !\n_lt_/p_gt_\n\n_lt_p_gt_\n\tok _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1WOE6G%234_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1WOE6G#4_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t1 skull_co_ 1000 spheres_co_ 2 draw calls_co_ no impostor_co_ no awareness of the mesh geometry\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\ttetrahedrons ?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tok _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1WOE6G%238_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1WOE6G#8_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_em_gt_(beat this_co_ threejs ! _lt_img alt_eq__qt__dd_P_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_tongue.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/tongue@2x.png 2x_qt_ title_eq__qt__dd_P_qt_ width_eq__qt_20_qt_ /_gt_)_lt_/em_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2017-01-05T20:38:14Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tI hope that we finally have a way to compute accurate intersections now _lt_img alt_eq__qt__sm_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_wink.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/wink@2x.png 2x_qt_ title_eq__qt__sm_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]