[{"Owner":"ragingclaw","Date":"2016-06-14T18:19:18Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI have been trying to figure out a way to animate the focus distance of the depth of field post process but have come up empty handed. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tI have setup a click event that runs a set of animations changing the (arc) camera_t_s alpha_co_ beta_co_ radius_co_ position_co_ and target. I would like to animate the dof_focus_distance to match that of the camera radius so that the selected object keeps focus.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tmy click event_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_scene.onPointerDown _eq_ function(e_co_ pickResult) {\t\t\t\n\tif (pickResult.hit ) {\n\t\tArcAnimation(0_co_ camera.upperBetaLimit_co_ camera.lowerRadiusLimit_co_ pickResult.pickedMesh.position_co_ pickResult.pickedMesh_co_ true)_sm_\t\t\n\t\tcurrentobj _eq_ pickResult.pickedMesh_sm_\n\t}\n\n}_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tI set up the depth of field with the following_dd_ (this came for the docs at _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/tutorials/Using_depth-of-field_and_other_lens_effects_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/tutorials/Using_depth-of-field_and_other_lens_effects_lt_/a_gt_)\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_var params _eq_ {\n\tedge_blur_dd_ 1_co_\n\tchromatic_aberration_dd_ 0_co_\n\tdistortion_dd_ 0_co_\n\tdof_focus_distance_dd_ 4000_co_\n\tdof_aperture_dd_ 200_co_\n\tgrain_amount_dd_ 0\n}_sm_\nvar lensEffect _eq_ new BABYLON.LensRenderingPipeline(_t_lensEffects_t__co_ params_co_ scene_co_ 1.0_co_ camera)_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tMy animation function_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_var ArcAnimation _eq_ function (toAlpha_co_ toBeta_co_ toRadius_co_ toPosition_co_ obj_co_ arc) {\n\tvar keysAlpha _eq_ []_co_ keysBeta _eq_ []_co_ keysRadius _eq_ []_co_ keysPosition _eq_ []_sm_\n\tvar easingFunction _eq_ new BABYLON.CubicEase()_sm_\n\teasingFunction.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEINOUT)_sm_\n\t\n\tvar animCamAlpha _eq_ new BABYLON.Animation(_qt_animCam_qt__co_ _qt_alpha_qt__co_ 30_co_ BABYLON.Animation.ANIMATIONTYPE_FLOAT_co_ BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT )_sm_\n\tkeysAlpha.push({frame_dd_ 0_co_ value_dd_ camera.alpha})_sm_\n\tkeysAlpha.push({frame_dd_ 300_co_ value_dd_ toAlpha})_sm_\n\n\tvar animCamBeta _eq_ new BABYLON.Animation(_qt_animCam_qt__co_ _qt_beta_qt__co_ 30_co_ BABYLON.Animation.ANIMATIONTYPE_FLOAT_co_ BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT )_sm_\n\tkeysBeta.push({frame_dd_ 0_co_ value_dd_ camera.beta})_sm_\n\tif (arc) {\n\t\tkeysBeta.push({frame_dd_ 150_co_ value_dd_ toBeta*0.2})_sm_\n\t}\n\tkeysBeta.push({frame_dd_ 300_co_ value_dd_ toBeta})_sm_\n\n\tvar animCamRadius _eq_ new BABYLON.Animation(_qt_animCam_qt__co_ _qt_radius_qt__co_ 30_co_ BABYLON.Animation.ANIMATIONTYPE_FLOAT_co_ BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT )_sm_\n\tkeysRadius.push({frame_dd_ 0_co_ value_dd_ camera.radius })_sm_ \n\tkeysRadius.push({frame_dd_ 300_co_ value_dd_ toRadius })_sm_\n\n\tvar animCamPosition _eq_ new BABYLON.Animation(_qt_animCam_qt__co_ _qt_target_qt__co_ 30_co_ BABYLON.Animation.ANIMATIONTYPE_VECTOR3 _co_ BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT )_sm_\n\tkeysPosition.push({frame_dd_ 0_co_ value_dd_ camera.target })_sm_ \n\t\n\tif (arc) {\n\t\tkeysPosition.push({frame_dd_ 150_co_ value_dd_ obj.position.add( new BABYLON.Vector3(0_co_obj.position.y + obj.position.y*0.5 _co_0) )})_sm_\t\n\t}\n\t\t\t\t\n\tkeysPosition.push({frame_dd_ 300_co_ value_dd_ obj.position })_sm_\n\t\n\tanimCamAlpha.setKeys(keysAlpha)_sm_\n\tanimCamBeta.setKeys(keysBeta)_sm_\n\tanimCamRadius.setKeys(keysRadius)_sm_\n\tanimCamPosition.setKeys(keysPosition)_sm_\n\n\tanimCamAlpha.setEasingFunction(easingFunction)_sm_\n\tanimCamBeta.setEasingFunction(easingFunction)_sm_\n\tanimCamRadius.setEasingFunction(easingFunction)_sm_\n\tanimCamPosition.setEasingFunction(easingFunction)_sm_\n\n\tcamera.animations.push(animCamAlpha)_sm_\n\tcamera.animations.push(animCamBeta)_sm_\n\tcamera.animations.push(animCamRadius)_sm_\n\tcamera.animations.push(animCamPosition)_sm_\n\tscene.beginAnimation(camera_co_ 0_co_ 300_co_ false_co_ 2_co_ function () {\n\t})_sm_\n}_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tI attempted to animate the DOF the same but it seems that cannot be done_co_ or I am doing it wrong. I tried like this_co_ among other ways but this was my last attempt before wanting to rage flip my desk_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_var keysDofFocusDistance _eq_ []_co_ keysDofApeture _eq_ []_sm_\nvar animDof _eq_ new BABYLON.Animation(_qt_animDof_qt__co_ _t_setFocusDepth_t__co_ 30_co_ BABYLON.Animation.ANIMATIONTYPE_FLOAT_co_ BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT)_sm_\nkeysDofFocusDistance.push({frame_dd_ 0_co_ value_dd_ 4000})_sm_\nkeysDofFocusDistance.push({frame_dd_ 100_co_ value_dd_ toRadius})_sm_\nanimDof.setKeys(keysDofFocusDistance)_sm_\nanimDof.setEasingFunction(easingFunction)_sm_\nlensEffect.animations.push(animDof)_sm_\nscene.beginAnimation(lensEffect.setFocusDepth_co_ 0_co_ 100_co_ false_co_ 2_co_ function () {\n\tconsole.log(_qt_animated DOF_qt_)_sm_\n})_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tSO_co_ is it possible to animate the depth of field focus (or any properties) at all? Why not allow it to use an object as a focal point? I_t_m new to babylon so maybe I am just missing something simple. I can modify the value using lensEffect.setFocusDistance(toRadius)_sm_ but I would really like to get it animated some how. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tthanks_co__lt_br /_gt_\n\tCharles\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tEDIT_dd_ here is a playground _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1ENHC8%230_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1ENHC8#_lt_/a_gt_1\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t\t\t\n\n_lt_span class_eq__t_ipsType_reset ipsType_medium ipsType_light_t_ data-excludequote_gt_\n\t_lt_strong_gt_Edited _lt_time datetime_eq__t_2016-06-14T19_dd_24_dd_08Z_t_ title_eq__t_06/14/2016 07_dd_24  PM_t_ data-short_eq__t_2 yr_t__gt_June 14_co_ 2016_lt_/time_gt_ by ragingclaw_lt_/strong_gt_\n\t\n\t\t_lt_br_gt_made a\n\t\n\t\n_lt_/span_gt_\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2016-06-14T19:00:53Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tHello_co_ I suggest creating a Playground to allow us to help you efficiently _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"ragingclaw","Date":"2016-06-14T19:17:00Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\task and you shall receive! also edited the original post so it doesn_t_t get lost\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1ENHC8%231_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1ENHC8#1_lt_/a_gt_ zooming out will reset the DOF here\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t\t\t\n\n_lt_span class_eq__t_ipsType_reset ipsType_medium ipsType_light_t_ data-excludequote_gt_\n\t_lt_strong_gt_Edited _lt_time datetime_eq__t_2016-06-14T19_dd_23_dd_22Z_t_ title_eq__t_06/14/2016 07_dd_23  PM_t_ data-short_eq__t_2 yr_t__gt_June 14_co_ 2016_lt_/time_gt_ by ragingclaw_lt_/strong_gt_\n\t\n\t\t_lt_br_gt_made a new playground that is better\n\t\n\t\n_lt_/span_gt_\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2016-06-15T03:24:59Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHere we are _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1ENHC8%232_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1ENHC8#2_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"ragingclaw","Date":"2016-06-15T12:50:55Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_132430_qt_ data-ipsquote-contentid_eq__qt_23181_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1465961099_qt_ data-ipsquote-userid_eq__qt_4442_qt_ data-ipsquote-username_eq__qt_Deltakosh_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t9 hours ago_co_ Deltakosh said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tHere we are _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\t\t_lt_p_gt_\n\t\t\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1ENHC8%232_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1ENHC8#2_lt_/a_gt_\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tYEEEEEEEEEEEA! I was watching your videos yesterday and got the idea to run a ray in the registerBeforeRender function to manually set the focus distance_co_ but this is much less taxing. Thanks David!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]