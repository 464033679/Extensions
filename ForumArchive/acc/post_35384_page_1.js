[{"Owner":"Amarth2Estel","Date":"2018-01-31T09:26:13Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHello Everyone !_lt_br /_gt_\n\t_lt_br /_gt_\n\tI am currently working on an _t_indoor_t_ project and can_t_t manage to solve an issue._lt_br /_gt_\n\t_lt_br /_gt_\n\tI would like to render a room with a ceiling light.\n_lt_/p_gt_\n\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\tI am working with StandardMaterial only.\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tI use a single pointLight to avoid heavy computations with multiple lights.\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tEvery mesh both cast and receive shadows.\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tTo see non-directly-illuminated mesh_co_ I also use an ambientColor on every material on the scene.\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tThanks to Deltakosh_t_s answers on a previous post_co_ I managed to get correct shadows using Close Exponential Shadow Map by stretching my scene into a unit cube and setting the depthScale of the shadowGenerator to 1.\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tI use shadowGenerator.setDarkness(0) to ensure shadows are the most dark as possible.\n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n_lt_p_gt_\n\tHowever_co_ even if these shadows are correct_co_ they are way too light to be seen in my scene. I think this is both due to the depthScale and the fact that receiving-shadows-mesh material have an ambientColor._lt_br /_gt_\n\t_lt_br /_gt_\n\tI thought about apply a filter directly in the shadows texture to increase level of gray in the entire image but I don_t_t know how to get this texture and how to apply filter before the render._lt_br /_gt_\n\t_lt_br /_gt_\n\tDo you know how to do that ? Or any ideas on how to reach my goal ?_lt_br /_gt_\n\t_lt_br /_gt_\n\tBecause the room I would like to render is fully dynamic_co_ I think I cannot use tricks like static lightMapping._lt_br /_gt_\n\t_lt_br /_gt_\n\tPS _dd_ Here is a _lt_a href_eq__qt_https_dd_//playground.babylonjs.com/#27GWGK%231_qt_ rel_eq__qt_external nofollow_qt__gt_PG_lt_/a_gt_ showing my problem. I would like the shadow to be darker._lt_br /_gt_\n\t_lt_br /_gt_\n\tThank you very much !\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-01-31T17:59:53Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tUnfortunately shadows try to work like in real world_dd_ They are space where the light can_t_t be seen\n_lt_/p_gt_\n\n_lt_p_gt_\n\tBecause you have a white ambient_co_ the light influence is minimal so shadows for this light reduce the lighting but not the ambient light.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAnyway you can still force the darkness by increasing the depthScale_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//playground.babylonjs.com/#27GWGK#2_qt_ ipsnoembed_eq__qt_true_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//playground.babylonjs.com/#27GWGK#2_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Amarth2Estel","Date":"2018-02-01T09:36:21Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThank you very much for your answer _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_ !_lt_br /_gt_\n\t_lt_br /_gt_\n\tI totally understand that. This is the most consistent way of managing shadows. Even though I was a little afraid of that answer _lt_img alt_eq__qt__dd_P_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_tongue.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/tongue@2x.png 2x_qt_ title_eq__qt__dd_P_qt_ width_eq__qt_20_qt_ /_gt_._lt_br /_gt_\n\t_lt_br /_gt_\n\tIs there any way to access the shadow texture(s) to increase its intensity before rendering ? Because the scene is _lt_br /_gt_\n\t_lt_br /_gt_\n\tOtherwise_co_ I will try to work with lightMaps and the property _lt_em_gt_lightmapMode _eq_ LIGHTMAP_SHADOWSONLY_lt_/em_gt_ of Light. _lt_br /_gt_\n\t_lt_br /_gt_\n\tThanks again !\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-02-01T18:23:18Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tUnfortunately the shadow maps do not contain color information but distance to light so you cannot change their content _lt_img alt_eq__qt__dd_(_qt_ data-emoticon_eq__qt_1_qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_sad.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/sad@2x.png 2x_qt_ title_eq__qt__dd_(_qt_ width_eq__qt_20_qt__gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Amarth2Estel","Date":"2018-02-02T09:47:34Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tOw.. I got it. Thanks again _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_ !\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Amarth2Estel","Date":"2018-02-02T15:01:14Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi everyone !_lt_br /_gt_\n\t_lt_br /_gt_\n\tI finally manage to find a way to get darker shadows with CESM !_lt_br /_gt_\n\tI know it is very bad for memory usage because it litteraly doubles the vertices and indices number in the scene... so if somebody has another idea_co_ it would be _lt_u_gt__lt_strong_gt_really_lt_/strong_gt__lt_/u_gt_ appreciated !_lt_br /_gt_\n\t_lt_br /_gt_\n\tWhat I changed _dd_\n_lt_/p_gt_\n\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\tEvery mesh in my scene is now casting shadows but not receiving shadows anymore.\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tThen_co_ I merge all the meshes (without disposing source) in a _t_shadowReceiver_t_ mesh with a _lt_a href_eq__qt_https_dd_//doc.babylonjs.com/extensions/shadowonly_qt_ rel_eq__qt_external nofollow_qt__gt_shadow-only material_lt_/a_gt_. \n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tTo avoid artifacts because _t_real meshes_t_ and _t_shadowMesh_t_ have the exact same vertices_co_ I use the property zOffset on the shadow-only material.\n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n_lt_p_gt_\n\tPS _dd_ There are some little memory optimizations (like deleting the unused data from the shadowMesh VertexData)...\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//playground.babylonjs.com/#27GWGK%235_qt_ rel_eq__qt_external nofollow_qt__gt_Playground with the too light shadows_lt_/a_gt__lt_br /_gt_\n\t_lt_a href_eq__qt_https_dd_//playground.babylonjs.com/#27GWGK%234_qt_ rel_eq__qt_external nofollow_qt__gt_Same Playground using this method_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHere is the kind of result I managed to reach (Indoor scene with piece of furniture_co_ 1 single ceiling light)_lt_br /_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_02/5a747cd35effa_Capturedecran2018-02-02a15_57_27.png.5cbd6cf9101d785e540ff519eb695c3a.png_qt_ data-fileid_eq__qt_16857_qt_ rel_eq__qt__qt__gt__lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_16857_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_02/5a747cd57e56a_Capturedecran2018-02-02a15_57_27.thumb.png.2549822b2b4fcf1c16da452983f0a671.png_qt_ alt_eq__qt_5a747cd57e56a_Capturedecran2018-02-02a15_57_27.thumb.png.2549822b2b4fcf1c16da452983f0a671.png_qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-02-02T19:07:37Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThis is a really cool idea!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]