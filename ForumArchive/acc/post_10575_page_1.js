[{"Owner":"Nico","Date":"2014-11-20T13:47:50Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hi guys_co__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I have been away for a long time_co_ and I have now a little more time to play again with BabylonJS._lt_/p_gt__lt_p_gt_I am using RenderPipeline_co_ and I think there is a problem with this feature  _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_unsure.png_qt_ alt_eq__qt__dd_unsure_dd__qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_When I try to use scene.pick there is a shift (I don_t_t know what is the best word to describe this) between my pointer positions and what the pick function returns_co_ I have no problem if I don_t_t use RenderPipeline (so I think the pointer positions values I am sending to the pick function are good)._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_After some investigations I think I found something interesting_co_ inside scene.pick BJS calls createPickingRay function_co_ and I found this code inside _dd__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_// Moving coordinates to local viewport worldx _eq_ x / this._engine.getHardwareScalingLevel() - viewport.x_sm_y _eq_ y / this._engine.getHardwareScalingLevel() - (this._engine.getRenderHeight() - viewport.y - viewport.height)_sm__lt_/pre_gt__lt_p_gt_To get _qt_y_qt_ value_co_ it calls engine.getRenderHeight()_co_ here is the code of this function _dd__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_public getRenderHeight()_dd_ number {    if (this._currentRenderTarget) {        return this._currentRenderTarget._height_sm_    }    return this._renderingCanvas.height_sm_}_lt_/pre_gt__lt_p_gt_So it is returning the height of the renderTarget if it exists_co_ I use in the RenderPipeline so it exists in this case_co_ but I can_t_t use my screen size here (because of the non power of two texture size limitation in WebGL) so I manually set a 2048x2048 texture while my screen resolution is 1920x1080._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_If I use comment only the getRenderHeight part_co_ I still have a shift_co_ so the getRenderWidth is used too for the picking_co_ but I didn_t_t try to locate this_co_ since using renderingCanvas width and height seems to solve the problem._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_These parts are causing this shift between my mouse click and the picking result_co_ when I comment this code like that it seems to work _dd__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_public getRenderWidth()_dd_ number {    /*if (this._currentRenderTarget) {        return this._currentRenderTarget._width_sm_    }*/    return this._renderingCanvas.width_sm_}public getRenderHeight()_dd_ number {    /*if (this._currentRenderTarget) {        return this._currentRenderTarget._height_sm_    }*/    return this._renderingCanvas.height_sm_}_lt_/pre_gt__lt_p_gt_I don_t_t know how to solve this problem in a clean way_co_ but I have located the problem  _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ alt_eq__qt__dd_D_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Does the pick function should always use the canvas width and height instead of using RenderTarget size ?_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_So in this case a parameter can be sent through this two functions to force to return the canvas width/height instead of renderTarget ones_co_ or should it use directly the _qt_getRenderingCanvas_qt_ method to get the canvas_co_ and then retrieve its width and height ?_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-11-21T00:17:52Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_perhaps this is a _qt_timing_qt_ issue. When do you call your pick? It could be interesting to call it onBeforeRender for instance_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Nico","Date":"2014-11-21T12:47:56Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Thanks for the answer!  _lt_/p_gt__lt_p_gt_I tried to call the pick function inside the callbacks (beforeRender_co_ or afterRender)_co_ and the result is the same_co_ there is always a WebGLTexture reference inside the _currentTargetRender  _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_unsure.png_qt_ alt_eq__qt__dd_unsure_dd__qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-11-21T16:17:35Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_can you try to create a playground repro?_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Nico","Date":"2014-11-24T16:19:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Here it is !_lt_/p_gt__lt_p_gt_I have to add a line to the bjs version to make the RenderPipeline works._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Inside the PostProcessRenderPass constructor_co_ the _renderList property was not setted_co_ so I added this line _dd__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_this._renderList _eq_ renderList_sm__lt_/pre_gt__lt_p_gt_You will find my custom bjs version inside the attached zip._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I put particles to easy show the pointer position (in the 3D world)._lt_/p_gt__lt_p_gt_There is no problem if the renderPipelineManager has not yet attached pipeline to camera_co_ the mouse pointer and the particle source are at the _qt_same position_qt__co_ but when I attach the camera to the pipeline_co_ there is this shift  _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_wacko.png_qt_ alt_eq__qt__dd_wacko_dd__qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_You just have to comment the line 46 to see the difference _dd__lt_/p_gt__lt_pre class_eq__qt_ipsCode prettyprint_qt__gt_postProcessRenderPipelineManager.attachCamerasToRenderPipeline(_qt_standardPipeline_qt__co_ camera_co_ false)_sm__lt_/pre_gt__lt_p_gt_I still have a WebGL warning_co_ but I don_t_t know where it come from  _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_unsure.png_qt_ alt_eq__qt__dd_unsure_dd__qt__gt__lt_/p_gt__lt_blockquote data-ipsquote_eq__qt__qt_ class_eq__qt_ipsQuote_qt__gt__lt_div_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_INVALID_ENUM_dd_ activeTexture_dd_ texture unit out of range_lt_/p_gt__lt_/div_gt__lt_/blockquote_gt__lt_p_gt__lt_a href_eq__qt_http_dd_//www.html5gamedevs.com/applications/core/interface/file/attachment.php?id_eq_3144_qt__gt_PostProcesses.zip_lt_/a_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-11-24T18:38:13Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_hello this will be really more convenient if you could create a playground repro _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ alt_eq__qt__dd_)_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_BTW I fixed the _renderList issue for the next release_dd_)_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Nico","Date":"2014-11-25T08:06:04Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hello !_lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_I have done a repro case using BabylonJS Playground_co_ you can see it here _dd_ _lt_span style_eq__qt_color_dd_rgb(40_co_40_co_40)_sm_font-family_dd_helvetica_co_ arial_co_ sans-serif_sm__qt__gt_ _lt_/span_gt__lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#2DWHRN%233_qt_ title_eq__qt_External link_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs...d.com/#2DWHRN#3_lt_/a_gt__lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_In this exemple I am not using the pick function_co_ but the engine.getRenderHeight/Width function to show where is the problem._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Since the pick function use this function too_co_ the shift is the same in my exemple_co_ so the particles source is the position you will get using the pick function._lt_/p_gt__lt_p_gt_ _lt_/p_gt__lt_p_gt_Edit _dd_ I have added picking on mouseup event._lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2014-11-26T23:38:29Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Hey good job it was a bug_dd_) I fixed the playground and will quickly publish the fix on the repo_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Nico","Date":"2014-11-27T08:43:46Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_Thank you very much for the fix!  _lt_img src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_biggrin.png_qt_ alt_eq__qt__dd_D_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/biggrin@2x.png 2x_qt_ width_eq__qt_20_qt_ height_eq__qt_20_qt__gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]