[{"Owner":"AlexB","Date":"2018-06-19T20:52:51Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI_t_m having a really hard time figuring this out. I_t_m creating this material._lt_br /_gt_\n\t_lt_br /_gt_\n\tÂ \n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_this.material _eq_ new BABYLON.ShaderMaterial(\n        part.url_co_\n        this.viewService.scene_co_\n        {\n          vertex_dd_ _t_/shaders/v_t__co_\n          fragment_dd_ _t_/shaders/f_t__co_\n        }_co_\n        {\n          needAlphaBlending_dd_ true_co_\n          needAlphaTesting_dd_ true_co_\n          defines_dd_ [\n            _t_#extension GL_OES_standard_derivatives _dd_ enable_t__co_\n            _t_#define IS_CLOWN_PASS 0_t__co_\n            _t_#define IS_TRANSLUCENT false_t__co_\n            _t_#define IS_METAL false_t__co_\n          ]_co_\n          attributes_dd_ [_t_position_t__co_ _t_uv_t__co_ _t_normal_t_]_co_\n          uniforms_dd_ [\n            _t_world_t__co_\n            _t_worldView_t__co_\n            _t_worldViewProjection_t__co_\n            _t_view_t__co_\n            _t_viewProjection_t__co_\n            _t_u_combinedTextures_t__co_\n            _t_texArr_t__co_\n          ]_co_\n        }\n      )_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tThen a few seconds later_co_ in a totally different function_co_ I_t_m attempting to update a uniform._lt_br /_gt_\n\tÂ \n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_this.material.setTextureArray(_t_texArr_t__co_ [\n        // red\n        BABYLON.RawTexture.CreateRGBATexture(new Uint8Array([255_co_ 0_co_ 0_co_ 255])_co_ 1_co_ 1_co_ this.viewService.scene)_co_\n        // blue\n        BABYLON.RawTexture.CreateRGBATexture(new Uint8Array([0_co_ 0_co_ 255_co_ 255])_co_ 1_co_ 1_co_ this.viewService.scene)_co_\n      ])_sm_\nthis.material.isReady(mesh)_sm_\nmesh.material _eq_ this.material_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tThis works if I paste this code right below where I create the material. Otherwise it seems to not set the values (I use SpectorJS to inspect the uniforms). Some questions_dd__lt_br /_gt_\n\tÂ \n_lt_/p_gt_\n\n_lt_ol_gt_\n\t_lt_li_gt_\n\t\tIs there another command I need to call to get the material to update?\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tDoes every uniform need to be in the initial uniforms array?\n\t_lt_/li_gt_\n\t_lt_li_gt_\n\t\tHow does setting the uniforms directly differ from scene.registerBeforeRender and doing it there?\n\t_lt_/li_gt_\n_lt_/ol_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"brianzinn","Date":"2018-06-19T21:59:01Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_span style_eq__qt_font-size_dd_12px_sm__qt__gt_Did you try this.material.markDirty() or this.material.markAsDirty( BABYLON._lt_span style_eq__qt_background-color_dd_rgb(255_co_255_co_255)_sm_color_dd_rgb(36_co_41_co_46)_sm__qt__gt_Material_lt_/span_gt__lt_span style_eq__qt_background-color_dd_rgb(255_co_255_co_255)_sm_color_dd_rgb(36_co_41_co_46)_sm__qt__gt_._lt_/span_gt__lt_span style_eq__qt_background-color_dd_rgb(255_co_255_co_255)_sm_color_dd_rgb(36_co_41_co_46)_sm__qt__gt_TextureDirtyFlag)?_lt_/span_gt__lt_/span_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"AlexB","Date":"2018-06-19T22:49:53Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tNo_co_ what_t_s the syntax for that?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Pryme8","Date":"2018-06-19T23:02:07Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI might be mistaken but_dd__lt_br /_gt_\n\tÂ \n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_ uniforms_dd_ [\n            _t_world_t__co_\n            _t_worldView_t__co_\n            _t_worldViewProjection_t__co_\n            _t_view_t__co_\n            _t_viewProjection_t_\n          ]_co_\nsamplers_dd_ [\n            _t_u_combinedTextures_t__co_\n            _t_texArr[2]_t_\n          ]_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tÂ \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Sebavan","Date":"2018-06-20T00:21:29Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\tIs there another command I need to call to get the material to update?_lt_span_gt_ï»¿_lt_/span_gt_\n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n_lt_p_gt_\n\tThe material should update on the next frame when you set the info.\n_lt_/p_gt_\n\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\t_lt_span_gt_ï»¿_lt_/span_gt__lt_span_gt_Â _lt_/span_gt_Does every uniform ne_lt_span_gt_ï»¿_lt_/span_gt_e_lt_span_gt_ï»¿_lt_/span_gt_d to be in the initial uniforms array?_lt_span_gt_ï»¿_lt_span_gt_ï»¿_lt_/span_gt__lt_/span_gt_\n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n_lt_p_gt_\n\tYes they should be listed in the initial one in order to get their location\n_lt_/p_gt_\n\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\tHow does setting the uniforms directly differ from scene.registerBeforeRender and doing it there?\n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n_lt_p_gt_\n\tThe first time the effect is created it keeps a map of uniform names to glUniformLocation based on the name you provide. Calling setTextureArray before the first render will automatically append the uniform name before the first render hence resulting in the uniform name being cached and usable. If you do it after I guess the cache does not contain the location hence why it does not work.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHope this could help.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Pryme8","Date":"2018-06-20T00:34:17Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tif its a sampler though_co_ I_t_m almost positive it needs to be under the _qt_samplers_qt_ argument on the constructor options.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Sebavan","Date":"2018-06-20T04:17:25Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tYup as PRyme said as well _lt_span_gt__lt_span class_eq__qt_ipsEmoji_qt__gt_ðŸ™‚_lt_/span_gt__lt_/span_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"AlexB","Date":"2018-06-20T15:42:47Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThis seems to be working_co_ but only intermittently. Sometimes I will see my texture_co_ but then I change some arbitrary code someone else and it_t_ll stop working. It seems as though there is a race condition somewhere. When I inspect the scene using Spector_co_ I don_t_t always see theÂ uniforms. I know for a fact that the material creator method is happening before the uniform setting method. I can also re-trigger the setter function so I don_t_t think it_t_s a race condition in my code.Â \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Sebavan","Date":"2018-06-20T16:49:20Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThis is really weird and sounds like a bug.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tCould you create a repro in the playground ?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]