[{"Owner":"Rodrix3","Date":"2018-04-21T00:27:38Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI have several gltf files that use the same textures.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tDifferent materials_co_ but same textures._lt_br /_gt_\n\t_lt_br /_gt_\n\tUnfortunately Babylon is not getting that the textures are the same_co_ and thus it is loading the SAME jpg file about 10 times (when I load 10 gltf files that use that jpeg)._lt_br /_gt_\n\tSince the textures are VERY big (4K resolution) this is making everything slower.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHow could I solve this?_lt_br /_gt_\n\tI cannot combine the multiple gltf files into one_co_ as they are very heavy.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_br /_gt_\n\tThanks in advance!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Sebavan","Date":"2018-04-23T15:57:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tping _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/26831-bghgary/?do_eq_hovercard_qt_ data-mentionid_eq__qt_26831_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/26831-bghgary/_qt_ rel_eq__qt__qt__gt_@bghgary_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"bghgary","Date":"2018-04-23T18:28:26Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_212390_qt_ data-ipsquote-contentid_eq__qt_37130_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1524270458_qt_ data-ipsquote-userid_eq__qt_27138_qt_ data-ipsquote-username_eq__qt_Rodrix3_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\tOn ‎4‎/‎20‎/‎2018 at 5_dd_27 PM_co_ Rodrix3 said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tUnfortunately Babylon is not getting that the textures are the same_co_ and thus it is loading the SAME jpg file about 10 times\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/27138-rodrix3/?do_eq_hovercard_qt_ data-mentionid_eq__qt_27138_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/27138-rodrix3/_qt_ rel_eq__qt__qt__gt_@Rodrix3_lt_/a_gt_ It is true that the glTF loader will create texture objects each time a texture is referenced_co_ but it should not reload the same image multiple times. The reason for creating multiple textures is to accommodate textureInfo properties (like coordinate index). Do you have a model you can share that I can investigate?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Rodrix3","Date":"2018-04-25T07:51:46Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHI _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/26831-bghgary/?do_eq_hovercard_qt_ data-mentionid_eq__qt_26831_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/26831-bghgary/_qt_ rel_eq__qt__qt__gt_@bghgary_lt_/a_gt__co_ thanks so much for the input!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tUnfortunately the mesh that I am working with too big (almost 600 mb or more!)._lt_br /_gt_\n\t_lt_br /_gt_\n\tIn 3ds Max I have multiple materials_co_ each material uses the same 3 textures (diffuse_co_ roughness_co_ metalness)_co_ and a different ambient occlusion texture._lt_br /_gt_\n\tThis means that at least 10 materials share the same textures (diffuse_co_ roughness_co_ metalness)_co_ but different ambient occlusion texture._lt_br /_gt_\n\t_lt_br /_gt_\n\tNow_co_ when I export these 10 different gltf files_co_ the 3 textures that the 10 materials have in common_co_ are loaded per every gltf file._lt_br /_gt_\n\tThis means_co_ that the 3 textures are loaded x10 times. This means having 30 textures loaded_co_ instead of 3. (...and I am using 8000x8000 textures)_lt_br /_gt_\n\t_lt_br /_gt_\n\tI am thinking that the only way to solve this is to export everything with the same material from 3ds Max_co_ and then do an override on mesh load_co__lt_br /_gt_\n\tand thus ensuring that the textures are loaded just once_co_ and used multiple times._lt_br /_gt_\n\t_lt_br /_gt_\n\tWhat do you think?_lt_br /_gt_\n\tThanks in advance!_lt_br /_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"bghgary","Date":"2018-04-25T17:34:35Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_212753_qt_ data-ipsquote-contentid_eq__qt_37130_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1524642706_qt_ data-ipsquote-userid_eq__qt_27138_qt_ data-ipsquote-username_eq__qt_Rodrix3_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t9 hours ago_co_ Rodrix3 said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tNow_co_ when I export these 10 different gltf files_co_ the 3 textures that the 10 materials have in common_co_ are loaded per every gltf file._lt_br /_gt_\n\t\t\tThis means_co_ that the 3 textures are loaded x10 times. This means having 30 textures loaded_co_ instead of 3.\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tAhh_co_ different glTF files. Yes_co_ that doesn_t_t instance right now because the loader creates a blob url in the loader. I will try to fix this when _lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/issues/4145_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/issues/4145_lt_/a_gt_ is fixed. It should make it such that images with the same url will only be loaded once.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Rodrix3","Date":"2018-04-27T01:29:51Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_212816_qt_ data-ipsquote-contentid_eq__qt_37130_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1524677675_qt_ data-ipsquote-userid_eq__qt_26831_qt_ data-ipsquote-username_eq__qt_bghgary_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\tOn 4/25/2018 at 2_dd_34 PM_co_ bghgary said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tAhh_co_ different glTF files. Yes_co_ that doesn_t_t instance right now because the loader creates a blob url in the loader. I will try to fix this when _lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/issues/4145_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/issues/4145_lt_/a_gt_ is fixed. It should make it such that images with the same url will only be loaded once.\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tIs there a way so I can use the  assetsManager.addMeshTask(_qt_Model_qt__co_ _qt__qt__co_ _qt_assets/models/_qt__co_ _qt__model.gltf_qt_)_sm_ and AVOID loading the textures_co_ so I can load them manually?_lt_br /_gt_\n\tThis would be the best at this point. I need to load a gltf mesh WITHOUT the material. I will create the material manually._lt_br /_gt_\n\t_lt_br /_gt_\n\tIs it possible to do this?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"bghgary","Date":"2018-04-27T16:06:01Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_212997_qt_ data-ipsquote-contentid_eq__qt_37130_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1524792591_qt_ data-ipsquote-userid_eq__qt_27138_qt_ data-ipsquote-username_eq__qt_Rodrix3_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t14 hours ago_co_ Rodrix3 said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tI need to load a gltf mesh WITHOUT the material_lt_span_gt_﻿_lt_/span_gt__lt_span_gt_﻿_lt_/span_gt_\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tI can think of a few hacky ways to do it_co_ but I don_t_t recommend any of them.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tCan you export the files without the texture/material?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI will try to fix the 4145 issue as soon as I can so that you don_t_t have to do this.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Rodrix3","Date":"2018-04-27T16:20:59Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_213046_qt_ data-ipsquote-contentid_eq__qt_37130_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1524845161_qt_ data-ipsquote-userid_eq__qt_26831_qt_ data-ipsquote-username_eq__qt_bghgary_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t15 minutes ago_co_ bghgary said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tI can think of a few hacky ways to do it_co_ but I don_t_t recommend any of them.\n\t\t_lt_/p_gt_\n\n\t\t_lt_p_gt_\n\t\t\tCan you export the files without the texture/material?\n\t\t_lt_/p_gt_\n\n\t\t_lt_p_gt_\n\t\t\tI will try to fix the 4145 issue as soon as I can so that you don_t_t have to do this.\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tMaybe i can modify the gltf files manually... However I am not sure if I can set _qt_no material_qt_._lt_br /_gt_\n\t_lt_br /_gt_\n\tI was thinking of_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tlet task _eq_ assetsManager.addMeshTask(taskName_co_ meshesNames_co_ rootUrl_co_ _qt_sceneFilename_qt_)_sm__lt_br /_gt_\n\t                task.onSuccess _eq_ function (task) {  _lt_br /_gt_\n\t                    task.loadedMeshes.forEach(function(mesh){_lt_br /_gt_\n\t          _lt_br /_gt_\n\t                        //If not a group_co_ and we need to override the material_lt_br /_gt_\n\t                        if(mesh.material &amp_sm_&amp_sm_ settings.material){_lt_br /_gt_\n\t                            let materialToDelete _eq_ mesh.material_sm__lt_br /_gt_\n\t                            mesh.material _eq_ null_sm__lt_br /_gt_\n\t                            materialToDelete.dispose()_sm__lt_br /_gt_\n\t                            scene.resetCachedMaterial()_sm_ //Not sure if this line is necessary_lt_br /_gt_\n\t                            mesh.material _eq_newMaterial_lt_br /_gt_\n\t                        }_lt_br /_gt_\n\t                                                 _lt_br /_gt_\n\t                    })_sm__lt_br /_gt_\n\t                }      \n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t..what do you think?                 \n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks in advance _lt_span_gt__lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/span_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"bghgary","Date":"2018-04-27T16:32:09Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tYou can certainly override the materials afterwards_co_ but it doesn_t_t stop the loading of the textures.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tManually modifying the glTF files to remove the references to the materials is relatively straight forward. Just search for _qt_material_qt__dd_ &lt_sm_index&gt_sm_ and remove all of them. This can be done with code as well via the SceneLoader.OnPluginActivatedObservable and the loader_t_s onParsedObservable which gives you access to the JSON before it is loaded.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Rodrix3","Date":"2018-04-28T04:10:39Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/26831-bghgary/?do_eq_hovercard_qt_ data-mentionid_eq__qt_26831_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/26831-bghgary/_qt_ rel_eq__qt__qt__gt_@bghgary_lt_/a_gt__co_ I am having a really hard time.._lt_br /_gt_\n\tI think I will have to wait till you fix the bugs.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThis is what I see in additional_dd_\n_lt_/p_gt_\n\n_lt_ul_gt_\n\t_lt_li_gt_\n\t\tIf ambient texture_co_ albedo_co_ metallicRoughness texture point to the texture index_co_ STILL Babylon is loading 3 different textures._lt_br /_gt_\n\t\tThat should not happen._lt_br /_gt_\n\t\t_lt_br /_gt_\n\t\t_lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_18046_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_04/image.png.2dd7015682f1b31d24023a8000f135f1.png_qt_ alt_eq__qt_image.png.2dd7015682f1b31d24023a8000f135f1.png_qt_ /_gt__lt_img class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_18047_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2018_04/image.png.14860f86aaff3ebdf6465ced24df9452.png_qt_ alt_eq__qt_image.png.14860f86aaff3ebdf6465ced24df9452.png_qt_ /_gt_\n\t_lt_/li_gt_\n_lt_/ul_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"bghgary","Date":"2018-04-28T14:25:48Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/27138-rodrix3/?do_eq_hovercard_qt_ data-mentionid_eq__qt_27138_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/27138-rodrix3/_qt_ rel_eq__qt__qt__gt_@Rodrix3_lt_/a_gt_ What you are seeing is by design. Babylon stores certain properties on the texture object that cannot be shared and thus the loader creates a new instance of the texture object for each reference to a texture. The underlying internal texture storing the actual image data will be shared based on the URL of the texture.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"bghgary","Date":"2018-05-11T20:44:52Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThis _lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/pull/4284_qt_ rel_eq__qt_external nofollow_qt__gt_PR_lt_/a_gt_ should fix the issues you are having with loading multiple glTF assets pointing to the same textures.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]