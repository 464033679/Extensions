[{"Owner":"Pryme8","Date":"2018-02-11T17:27:14Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tOk so if I have a normal vector of lets say a section of terrain.  Now I want to get a _t_orientation_t_ value for the direction of the slope. So that I can point an arrow in that direction with the formula_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\trotation _eq_ vec2(cos(orientation)_co_ sin(orientation))_sm__lt_br /_gt_\n\t_lt_br /_gt_\n\tas seen in this mock up shader I made that has the arrow being rotated by the time float_dd__lt_br /_gt_\n\t_lt_a href_eq__qt_https_dd_//cyos.babylonjs.com/#DV2KWT_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//cyos.babylonjs.com/#DV2KWT_lt_/a_gt__lt_br /_gt_\n\t_lt_br /_gt_\n\tI hope that makes sense?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2018-02-11T17:54:55Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi P8/others.  Direction to rotation?  _lt_a href_eq__qt_https_dd_//www.google.com/search?q_eq_direction+to+rotation_qt_ rel_eq__qt_external nofollow_qt__gt_Common stackoverflow question_lt_/a_gt_.  We have some code onboard that does SOMETHING similar... called billboardMode.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Mesh/babylon.transformNode.ts#L751_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Mesh/babylon.transformNode.ts#L751_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWhat a pile of demented math.  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_  I got a brain tumor by just clicking that URL. heh.  Others will surely comment_co_ soon.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Pryme8","Date":"2018-02-11T18:09:32Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI guess I kinda phrased it wrong_co_ I would more or less be looking for the direction of the slope vector first then convert that to radians.  This is all assuming it is a terrain like object._lt_br /_gt_\n\t_lt_br /_gt_\n\tSo I think its like the dot product of the normal to a vector 0_co_1_co_0 \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2018-02-11T19:11:11Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI don_t_t think any of that terrain stuff... matters.  A face normal is a direction_co_ yes?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tBut I think I understand better... and maybe... _lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#53YWDR%231_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#53YWDR#1_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t(not my PG)   Click on various sides of the mesh... see that the cylinders align with the faces. Lines 50-51 might do the dirty work.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2018-02-11T19:31:56Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tIf you have the normal to the terrain_co_ you can get the slope with  2 cross products _dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tcross(normal_co_ Y) will be give you a vector orthogonal to the normal_co_ let_qt_s call it binorm\n_lt_/p_gt_\n\n_lt_p_gt_\n\tcross(normal_co_ binorm) will give you a vector orthogonal to both the normal and binorm_co_ it_t_s the terrain slope\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIf these 3 vectors are normalized and orthogonal to each other_co_ then you have a rotated normalized system. You can get the rotation to apply to any mesh to align it to this rotated system with the method RotationFromAxis(normal_co_ binormal_co_ slope)\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Pryme8","Date":"2018-02-12T00:16:33Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI was looking at the method RotationFromAxis_co_ and I do not know how that will return a float that I can use as in the documentation it says it returns a vector3._lt_br /_gt_\n\t_lt_br /_gt_\n\tI am doing all this in a shader as well so I do not have access to that method_co_ but I was looking to see what it does to see if I could of redone it in glsl format._lt_br /_gt_\n\t_lt_br /_gt_\n\t_lt_a href_eq__qt_https_dd_//cyos.babylonjs.com/#DV2KWT%231_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//cyos.babylonjs.com/#DV2KWT#1_lt_/a_gt__lt_br /_gt_\n\t_lt_br /_gt_\n\tlines 78-91 on this are where I am trying to figure this out.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2018-02-12T08:35:34Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tOk_co_ you can then do the same thing GPU side.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tJust compute the 2 vectors binorm and slope from the normal vector (2 cross products)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tnow if you consider the 3*3 matrix _dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tnorm_x     norm_ y    norm_z\n_lt_/p_gt_\n\n_lt_p_gt_\n\tbinorm_x binorm_y binorm_z\n_lt_/p_gt_\n\n_lt_p_gt_\n\tslope_x    slope_y     slope_z\n_lt_/p_gt_\n\n_lt_p_gt_\n\tWell_co_ this matrix is actually the rotation matrix (let_t_s call it rotMat) to apply directly to any vector you would rotate so it_t_s in the same position in this new system than it used to be in its local one originally. Said differently _dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\trotMat * Vec3 _eq_ rotatedVec3\n_lt_/p_gt_\n\n_lt_p_gt_\n\tyou just have to multiply the arrow vectors by this rotation matrix to get the arrow rotated along the slope _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Pryme8","Date":"2018-02-12T16:22:59Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\twait so...\n_lt_/p_gt_\n\n_lt_p_gt_\n\tP*rotMat _eq_ rotatedP?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Pryme8","Date":"2018-02-12T16:58:00Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/5453-jerome/?do_eq_hovercard_qt_ data-mentionid_eq__qt_5453_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/5453-jerome/_qt_ rel_eq__qt__qt__gt_@jerome_lt_/a_gt__lt_br /_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//cyos.babylonjs.com/#DV2KWT%233_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//cyos.babylonjs.com/#DV2KWT#3_lt_/a_gt__lt_br /_gt_\n\t_lt_br /_gt_\n\tI get blank output on the arrows when I follow these directions_co_ I must be doing it wrong!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Pryme8","Date":"2018-02-12T20:20:12Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//cyos.babylonjs.com/#DV2KWT%234_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//cyos.babylonjs.com/#DV2KWT#4_lt_/a_gt__lt_br /_gt_\n\t_lt_br /_gt_\n\tThis is closer_co_ but I think its still off... plus I_t_m not sure how to get rid of that distortion.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI ended up using atan(vNormal.z_co_ vNormal.x) to get the radians conversion... but I still feel like this is wrong._lt_br /_gt_\n\t_lt_br /_gt_\n\t*EDIT*\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI think I got it!_lt_br /_gt_\n\t_lt_a href_eq__qt_https_dd_//cyos.babylonjs.com/#DV2KWT%237_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//cyos.babylonjs.com/#DV2KWT#7_lt_/a_gt__lt_br /_gt_\n\t_lt_br /_gt_\n\tChange model to sphere for best preview.\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_vec3 up _eq_ vec3(0._co_1._co_0.)_sm_\n    vec3 biNorm _eq_ cross(vNormal_co_ up)_sm_\n    float a _eq_ atan(biNorm.x_co_ biNorm.z)_sm_\n    vec2 rotation _eq_ vec2(cos(a)_co_ sin(a))_sm_\n_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Pryme8","Date":"2018-02-13T03:40:13Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tthis all would have been so much easier if I had heightmaps and a nice smooth normal map &gt_sm__&lt_sm_ but yeah that is not what I was provided..._lt_br /_gt_\n\t_lt_br /_gt_\n\tNow I gotta figure out how to get rid of the choppiness when the arrows go onto another face... maybe a better solution would be to make a cube over the whole mesh that you cant see and raymarch some arrows with some wizardry....\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Pryme8","Date":"2018-02-13T19:20:58Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tSo I am still having trouble with this_co_ \n_lt_/p_gt_\n\n_lt_p_gt_\n\tI have the shader which _qt_works_qt_ but has some glitchs when the arrow transfers to a different normal so I am looking for a different solution._lt_br /_gt_\n\t_lt_br /_gt_\n\tI am following your instructions but can not get the markers to be in the correct rotation basically flat on the surface and the arrow pointing down the slope._lt_br /_gt_\n\t_lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#SHW98H%232_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#SHW98H#2_lt_/a_gt__lt_br /_gt_\n\t_lt_br /_gt_\n\tI am at least able to get the correct y rotation_dd__lt_br /_gt_\n\t_lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#SHW98H%233_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#SHW98H#3_lt_/a_gt__lt_br /_gt_\n\t_lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#SHW98H%234_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#SHW98H#4_lt_/a_gt_ &lt_sm_- Better but slow because of how many arrows Im making._lt_br /_gt_\n\t_lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#SHW98H%238_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#SHW98H#8_lt_/a_gt_ &lt_sm_- scaling the arrows by slope._lt_br /_gt_\n\t_lt_br /_gt_\n\t&gt_sm__&lt_sm_ uhhg this is giving me a headache...\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]