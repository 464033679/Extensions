[{"Owner":"jdurrant","Date":"2017-10-08T01:53:52Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI recently got my hands on an HTC Vive_co_ and I can_t_t even express how excited I am about this technology! Babylon.js works well with the device too. I_t_m just thrilled!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI have run into what I think might be a bug_co_ though. When I load a .babylon file that I exported from Blender and try to hook in a WebVR camera_co_ the controllers don_t_t show up. I can_t_t figure out how to open up an external .babylon file in the Playground_co_ unfortunately_co_ but here_t_s my code_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_function makeWebVRCamera(scene_co_ position) {\n    var metrics _eq_ BABYLON.VRCameraMetrics.GetDefault()_sm_\n    var camera _eq_ new BABYLON.WebVRFreeCamera(\n        _qt_deviceOrientationCamera_qt__co_ \n        position_co_ \n        scene_co_\n        false_co_  // compensate distortion\n        metrics\n    )_sm_\n    window.scrollTo(0_co_ 1)_sm_  // supposed to autohide scroll bar.\n    return camera_sm_\n}\n\nfunction startLoop(engine_co_ scene) {\n    engine.runRenderLoop(function(){\n        scene.render()_sm_\n    })_sm_\n}\n\nfunction addLight(scene) {\n    var light _eq_ new BABYLON.HemisphericLight(_qt_light1_qt__co_ new BABYLON.Vector3(0_co_ 1_co_ 0)_co_ scene)_sm_\n    light.intensity _eq_ .5_sm_\n}\n\nfunction createSceneFromBabylonFile(canvas_co_ engine) {\n\n    BABYLON.SceneLoader.Load(_qt__qt__co_ _qt_babylon.babylon_qt__co_ engine_co_ (newScene) _eq_&gt_sm_ {\n        var webVRCamera _eq_ makeWebVRCamera(newScene_co_ newScene.activeCamera.position)_sm_    \n\n        // Wait for textures and shaders to be ready\n        newScene.executeWhenReady(() _eq_&gt_sm_ {\n            jQuery(_qt_#renderCanvas_qt_).click(() _eq_&gt_sm_ {\n\n                // Now remove the original camera\n                newScene.activeCamera.detachControl(canvas)_sm_\n                if (newScene.activeCamera.dispose) {\n                    newScene.activeCamera.dispose()_sm_\n                }\n            \n                // Set the new (VR) camera to be active\n                newScene.activeCamera _eq_ webVRCamera_sm_\n            \n                // Attach that camera to the canvas.\n                newScene.activeCamera.attachControl(canvas)_sm_  // This won_t_t work if desktop-based vr like htc vive. So this command also run on play-button click.\n            })_sm_\n\n            addLight(newScene)_sm_\n            startLoop(engine_co_ newScene)_sm_\n        })_sm_\n    })_sm_\n}\n\nfunction createSceneFromScratch(canvas_co_ engine) {\n    window.scrollTo(0_co_ 1)_sm_  // supposed to autohide scroll bar.\n\n    var scene _eq_ new BABYLON.Scene(engine)_sm_\n    var webVRCamera _eq_ makeWebVRCamera(scene_co_ new BABYLON.Vector3(1.8756_co_ 3.4648_co_ 8.517))_sm_\n    \n    jQuery(_qt_#renderCanvas_qt_).click(() _eq_&gt_sm_ {\n        // Set the new (VR) camera to be active\n        scene.activeCamera _eq_ webVRCamera_sm_\n    \n        // Attach that camera to the canvas.\n        scene.activeCamera.attachControl(canvas)_sm_  // This won_t_t work if desktop-based vr like htc vive. So this command also run on play-button click.\n    })_sm_\n\n    addLight(scene)_sm_\n    var box _eq_ BABYLON.Mesh.CreateBox(_qt_Box_qt__co_ 4.0_co_ scene)_sm_        \n\n    startLoop(engine_co_ scene)_sm_\n}\n\njQuery(document).ready(() _eq_&gt_sm_ {\n    var canvas _eq_ document.getElementById(_t_renderCanvas_t_)_sm_   \n    var engine _eq_ new BABYLON.Engine(canvas_co_ true)_sm_\n\n    // createSceneFromBabylonFile(canvas_co_ engine)_sm_\n    createSceneFromScratch(canvas_co_ engine)_sm_\n})_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tThere are two functions for creating a scene_dd_ _qt_createSceneFromBabylonFile_qt_ and _qt_createSceneFromScratch_qt_. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tcreateSceneFromScratch (not commented out in the code above) works great. I can see my scene in the HTC Vive_co_ and the Vive_t_s controllers are also visible.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tcreateSceneFromBabylonFile (commented out in the code above) also works well. The 3D scene appears in the Vive correctly. But there are no controllers visible in the scene_co_ even when I_t_m holding them in my hands.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI haven_t_t for the life of me been able to figure out how to make those controllers appear when I load an external .babylon file. \n_lt_/p_gt_\n\n_lt_p_gt_\n\t(Note_dd_ putting newScene.activeCamera.initControllers() after the camera is attached to the canvas was not effective.)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks for your help!\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"dbawel","Date":"2017-10-08T07:06:58Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI don_t_t know which controller you_t_re using_co_ but if it_t_s the Vive controllers_co_ they have issues with connectivity - not a babylon issue. For development_co_ I use the Moga Pro bluetooth controller as it connects 100% of the time to every device and can handle 95% of my control setups. I only develop with the Vive controllers when necessary_co_ as I can_t_t handle interruptions during development.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tDB\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jdurrant","Date":"2017-10-09T13:17:09Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThanks for your help with this_co_ _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/11286-dbawel/?do_eq_hovercard_qt_ data-mentionid_eq__qt_11286_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/11286-dbawel/_qt_ rel_eq__qt__qt__gt_@dbawel_lt_/a_gt_ . But I haven_t_t experienced your same problem with the Vive controllers. They have always connected for me in other applications_co_ including web-based apps such as those posted at _lt_a href_eq__qt_https_dd_//mozvr.com/_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//mozvr.com/_lt_/a_gt_ . They have also always connected in babylonjs apps for me when I create the scene (including the camera) from scratch. It seems to be something specific to trying to load an external .babylon file and then trying to use controllers. I wonder if I_t_m replacing the .babylon-file camera with the WebVR camera incorrectly...\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-10-09T16:34:04Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHello!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tcan you try this PG to see if it works?\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//playground.babylonjs.com/#E0WY4U%231_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//playground.babylonjs.com/#E0WY4U#1_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t(Interesting read for you_dd_ _lt_a href_eq__qt_https_dd_//www.davrous.com/2017/07/07/from-zero-to-hero-creating-webvr-experiences-with-babylon-js-on-all-platforms/_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.davrous.com/2017/07/07/from-zero-to-hero-creating-webvr-experiences-with-babylon-js-on-all-platforms/_lt_/a_gt_)\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jdurrant","Date":"2017-10-09T18:47:06Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThanks for your help_co_ _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_ . The playground scene you posted works perfectly. (Remarkable scene_co_ BTW_co_ to view in the HTC Vive!) I see both the scene and the controllers.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tBut I continue to have troubles. Here_t_s what I_t_ve done to debug so far_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSTEP 1_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI took your exact code_co_ except I swapped in my .babylon file_dd_ _lt_a href_eq__qt_http_dd_//playground.babylonjs.com/#E0WY4U%2316_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//playground.babylonjs.com/#E0WY4U#16_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSuccess! I could see my (unlit) scene as well as the Vive controllers.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSTEP 2_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI created my own local playground. My server is on localhost_dd_8000_co_ started via python_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_python -m SimpleHTTPServer 8000_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tHere_t_s my playground framework_co_ which I assume is similar to yours_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_var canvas _eq_ document.getElementById(_t_renderCanvas_t_)_sm_   \nvar engine _eq_ new BABYLON.Engine(canvas_co_ true)_sm_\n\njQuery(document).ready(() _eq_&gt_sm_ {\n    var scene _eq_ createScene()_sm_\n\n    engine.runRenderLoop(function(){\n        scene.render()_sm_\n    })_sm_\n\n})_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tI then copied the EXACT same code for the createScene function into this playground environment.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe 3D scene appears in the Vive_co_ but no controllers!\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSTEP 3_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAs a sanity check_co_ I then changed my local-playground createScene function only slightly_co_ to load your sponza scene into my local playground. The 3D scene appeared_co_ but again no controllers.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tSTEP 4_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tCould there be something wrong with my server that_t_s getting in the way? I uploaded my code to a publically available server. See _lt_a href_eq__qt_https_dd_//durrantlab.com/tmp/babylon_test/_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//durrantlab.com/tmp/babylon_test/_lt_/a_gt_ \n_lt_/p_gt_\n\n_lt_p_gt_\n\tGreat 3D scene in the Vive_co_ but no controllers. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tTENTATIVE CONCLUSION\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThere_t_s something you_t_re doing _lt_strong_gt_at the level of the playground environment_lt_/strong_gt_ that_t_s making the controllers appear in your playground but not in mine. You can see my code here (which_co_ again_co_ does not show Vive controllers_co_ even though it_t_s identical to what I posted at _lt_a href_eq__qt_http_dd_//playground.babylonjs.com/#E0WY4U%2316_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//playground.babylonjs.com/#E0WY4U#16_lt_/a_gt_)_dd_ _lt_a href_eq__qt_https_dd_//durrantlab.com/tmp/babylon_test/main2.js_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//durrantlab.com/tmp/babylon_test/main2.js_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks so much for your help_co_ guys! I_t_ve long been a huge babylon.js fan. Both your library and your amazing_co_ supportive community are just fantastic.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAll the best.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-10-09T21:21:30Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tCan you just make sure to reference the gltf loader? (Is there any error on the console?)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tDid you allow .gltf / .glb mime types?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jdurrant","Date":"2017-10-10T03:59:20Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThanks_co_ all. It seems I was using a slightly out-of-date version of babylon.js. Both the online playground and my local copy were 3.1-alpha_co_ but apparently not the same 3.1-alpha.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tUsing BABYLON.SceneLoader.Append_co_ rather than BABYLON.SceneLoader.Load_co_ also seemed to be important. Hope all this helps someone else. All the best.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]