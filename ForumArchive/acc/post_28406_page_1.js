[{"Owner":"BangTao","Date":"2017-02-13T10:10:34Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi all.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThere_t_s a question about animation(exported from 3dsMax_co_and i only know 3dsMax a little ) which is _dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tQ1_dd_How skeleton_t_s bones influence mesh_t_s vertex data?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tQ2_dd_ the _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1BZJVJ%2333_qt_ rel_eq__qt_external nofollow_qt__gt_PG_lt_/a_gt_. and how can i get every mesh_t_s vertex data from the .babylon file?\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ data-fileid_eq__qt_11621_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_02/1.png.4f19268ec8903499213b107d79a71c26.png_qt_ rel_eq__qt__qt__gt__lt_img alt_eq__qt_1.thumb.png.7d3d10c51215bc4672df7225a060f879.png_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_11621_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_02/1.thumb.png.7d3d10c51215bc4672df7225a060f879.png_qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tQ3_dd_these is meshes Attr from Dude.babylon_t_s _co_ and i don_t_t know why there isn_t_t positions Attr/\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ data-fileid_eq__qt_11620_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_02/2.png.e761af3923be2cce813c469298bcf8f1.png_qt_ rel_eq__qt__qt__gt__lt_img alt_eq__qt_2.thumb.png.7619afad536513a5a19736ab027d2cff.png_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_11620_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_02/2.thumb.png.7619afad536513a5a19736ab027d2cff.png_qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tQ4_dd_And there pic _co_i don_t_t know why the first bones_t_s parentBoneIndex is _qt_-1_qt_....\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThx for u time.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2017-02-16T15:35:30Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi BT!  Sorry for slow replies.  I am not expert_co_ but I try to help.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tPlease DL/view _lt_a href_eq__qt_https_dd_//github.com/Wingnutt/misc/blob/master/stripped_dude.zip_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/Wingnutt/misc/blob/master/stripped_dude.zip_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIt is _qt_stripped_qt_ (and white-spaced) dude.babylon.  In _qt_meshes_qt_ section_co_ I have removed almost all values in big arrays... such as _qt_positions_qt__co_ _qt_indices_qt__co_ _qt_matricesIndices_qt__co_ and _qt_matricesWeights_qt_.  Now they are only for looking-at.  This .babylon file will not load properly.  I broke it.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tPlease take notice of matricesIndices and matricesWeights.  Those affect animation.  See all 58 matrix animations in stripped_dude.babylon?  All are dataType 3.  Go to some playground and enter line _lt_em_gt_console.log(BABYLON.Animation.ANIMATIONTYPE_MATRIX)_sm_   _lt_/em_gt_Returns_dd_  3. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tAll 58 animations... are matrix animations!  They are being done to _qt_bones_qt_ which are not mesh_co_ but really matrix transformations_co_ that happen to mesh... which have properties _lt_em_gt_matricesIndices_lt_/em_gt_ and _lt_em_gt_matricesWeights._lt_/em_gt_  Starting to see answer to Q1?  When you _lt_strong_gt_do_lt_/strong_gt_ see it_co_ TEACH ME ALSO_co_ PLEASE.  heh.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tQ2_dd_  _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1BZJVJ%2369_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1BZJVJ#69_lt_/a_gt_  Here I was playing.  I do funny rotations in line 25-26.  In line 27_co_ I get positionsKind data for meshes[1].  Then lines 28-30... I try to move (transform) one .position/vertex.  Then line 34_co_ I try to _qt_write_qt_ positionsKind data back to object_co_ with parameter _lt_em_gt_updateExtends_lt_/em_gt_ _eq_ true.  (updateExtends adjusts boundingBox size if needed).  As you can see_co_ bounding box size IS growing_co_ but I cannot make a vertex on dude_t_s head... move/display movement.  Maybe he is set updatable _eq_ false.  hmm.  Just playing with the mesh... having fun learning.  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tQ3_dd_ and Q4_dd_  I have no answers.  Possibly_co_ JSON parsing/de-serialization performance is optimized by using these methods.  Not sure.  Perhaps _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_ or other 3DMax exporter contributors will respond soon.  Fellow forum helpers... please help_co_ and please correct me if I have said wrong things.   I am no expert in bones_co_ skeletons_co_ and their animations.  (actually_co_ I_t_m no expert in ANYTHING_co_ except perhaps aimless talking.)  heh.  Darn.  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_ \n_lt_/p_gt_\n\n_lt_p_gt_\n\tMatrix transformation animations!  Coooool.  Bad to the _qt_bone_qt_.  Sorry I wasn_t_t more helpful.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-02-16T17:32:43Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHello!\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_strong_gt_Q1_lt_/strong_gt__dd_ Bones influence a mesh through mesh_t_s vertices data. There are two sets of vertex data that you want to check_dd_ matrices indices and matrices weight (as wingnut mentioned).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tInside the vertex shader_co_ every vertex will be transformed by a matrix build from bones (which are actually only matrices _dd_)) . The active bones are referenced by matrices indices (every index points to a bone) and the weight of each bone is deduced from matrices weights (value from 0 to 1).\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_strong_gt_Q2_lt_/strong_gt__dd_ Wingnut is right (again)_dd_ just use getVertexData with one of the kind you are interested by_dd_ _lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Mesh/babylon.vertexBuffer.ts#L155_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Mesh/babylon.vertexBuffer.ts#L155_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_strong_gt_Q3_lt_/strong_gt__dd_ Bones are matrices. And matrices contain rotation_co_ scaling and position\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_strong_gt_Q4_lt_/strong_gt__dd_ The first bone has no parent. It is the top most bone  (hence no parent_co_ so parentIndex set to an impossible value (-1))\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"BangTao","Date":"2017-02-22T12:25:05Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/5733-wingnut/?do_eq_hovercard_qt_ data-mentionid_eq__qt_5733_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/5733-wingnut/_qt_ rel_eq__qt__qt__gt_@Wingnut_lt_/a_gt_ _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\toh_co_haha_co_sorry for late reply too_co_thank u for your time_co_so_co_here is what I understand：\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAs for bones animation_co_mesh_t_s vertices data is according to bones(matrices)_co_matrices change_co_then vertices change.so_co_if i wanna get the vertices data _co_i can get the bone_t_s Initial state matrix first(i don_t_t know if the first pic shows right/_co_hope it_t_s right)_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a class_eq__qt_ipsAttachLink ipsAttachLink_image_qt_ data-fileid_eq__qt_11754_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_02/58ad7d9bb5b70_JC_JLGAZ8U76GYNJ6.png.c559dda78e245464041d715140bbcceb.png_qt_ rel_eq__qt__qt__gt__lt_img alt_eq__qt_58ad7d9c91211_JC_JLGAZ8U76GYNJ6.thumb.png.95bb2f237506dbc854411d706c9dfde4.png_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_11754_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_02/58ad7d9c91211_JC_JLGAZ8U76GYNJ6.thumb.png.95bb2f237506dbc854411d706c9dfde4.png_qt_ /_gt__lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tand Calculate the  _lt_span style_eq__qt_color_dd_rgb(39_co_42_co_52)_sm_font-family_dd__t_Helvetica Neue_t__co_ Helvetica_co_ Arial_co_ sans-serif_sm_font-size_dd_14px_sm_font-style_dd_normal_sm_font-variant_dd_normal_sm_font-weight_dd_normal_sm_letter-spacing_dd_normal_sm_line-height_dd_22.4px_sm_text-indent_dd_0px_sm_text-transform_dd_none_sm_white-space_dd_normal_sm_word-spacing_dd_0px_sm_float_dd_none_sm_background-color_dd_rgb(255_co_255_co_255)_sm__qt__gt_matrices indices and matrices weight_lt_/span_gt_ _co_each vertex matrix is computed as follows(not sure if it_t_s right)_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span style_eq__qt_color_dd_rgb(51_co_51_co_51)_sm_font-family_dd_Inconsolata_sm_font-size_dd_16px_sm_font-style_dd_normal_sm_font-variant_dd_normal_sm_font-weight_dd_300_sm_letter-spacing_dd_normal_sm_line-height_dd_normal_sm_text-indent_dd_0px_sm_text-transform_dd_none_sm_white-space_dd_pre_sm_word-spacing_dd_0px_sm_float_dd_none_sm_background-color_dd_rgb(240_co_240_co_240)_sm__qt__gt_finalMatrix _eq_ worldMatrix _lt_/span_gt__lt_span style_eq__qt_color_dd_rgb(51_co_51_co_51)_sm_font-family_dd_Inconsolata_sm_font-size_dd_16px_sm_font-style_dd_normal_sm_font-variant_dd_normal_sm_font-weight_dd_300_sm_letter-spacing_dd_normal_sm_line-height_dd_normal_sm_text-indent_dd_0px_sm_text-transform_dd_none_sm_white-space_dd_pre_sm_word-spacing_dd_0px_sm__qt__gt_* (bonesMatrices[index0] *_lt_/span_gt__lt_span style_eq__qt_color_dd_rgb(51_co_51_co_51)_sm_font-family_dd_Inconsolata_sm_font-size_dd_16px_sm_font-style_dd_normal_sm_font-variant_dd_normal_sm_font-weight_dd_300_sm_letter-spacing_dd_normal_sm_line-height_dd_normal_sm_text-indent_dd_0px_sm_text-transform_dd_none_sm_white-space_dd_pre_sm_word-spacing_dd_0px_sm_float_dd_none_sm_background-color_dd_rgb(240_co_240_co_240)_sm__qt__gt_ weight0 + bonesMatrices[index1] _lt_/span_gt__lt_span style_eq__qt_color_dd_rgb(51_co_51_co_51)_sm_font-family_dd_Inconsolata_sm_font-size_dd_16px_sm_font-style_dd_normal_sm_font-variant_dd_normal_sm_font-weight_dd_300_sm_letter-spacing_dd_normal_sm_line-height_dd_normal_sm_text-indent_dd_0px_sm_text-transform_dd_none_sm_white-space_dd_pre_sm_word-spacing_dd_0px_sm__qt__gt_* weight1 + bonesMatrices[index2] *_lt_/span_gt__lt_span style_eq__qt_color_dd_rgb(51_co_51_co_51)_sm_font-family_dd_Inconsolata_sm_font-size_dd_16px_sm_font-style_dd_normal_sm_font-variant_dd_normal_sm_font-weight_dd_300_sm_letter-spacing_dd_normal_sm_line-height_dd_normal_sm_text-indent_dd_0px_sm_text-transform_dd_none_sm_white-space_dd_pre_sm_word-spacing_dd_0px_sm_float_dd_none_sm_background-color_dd_rgb(240_co_240_co_240)_sm__qt__gt_ weight2 + bonesMatrices[index3] * weight3)_lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tbut why the matricesWeights.length is larger than matricesWeights.length_co_Shouldn_t_t they be the same length?\n_lt_/p_gt_\n\n_lt_p_gt_\n\t _lt_img alt_eq__qt_58ad81b3eb483_WMD2Z@1AF05BYFE)V(QN2.png.c877c84eb0cf22c39c8c26d9f6affb5d.png_qt_ class_eq__qt_ipsImage ipsImage_thumbnailed_qt_ data-fileid_eq__qt_11755_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/monthly_2017_02/58ad81b3eb483_WMD2Z@1AF05BYFE)V(QN2.png.c877c84eb0cf22c39c8c26d9f6affb5d.png_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tand what_t_s the worldMatrix here? i didn_t_t find this Attr.\n_lt_/p_gt_\n\n_lt_p_gt_\n\toh.one last thing.Use _qt_getVerticesData(BABYLON.VertexBuffer.PositionKind)_qt_ only get the mesh_t_s initial position_co_i_t_m trying to get the position data every time the bones changed_co_that_t_s what i_t_m i doing now _sm_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1BZJVJ%2370_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1BZJVJ#70_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2017-02-22T18:02:54Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tSo_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t- your formula is correct\n_lt_/p_gt_\n\n_lt_p_gt_\n\t- MatricesIndices are int values. Every int is actually made of 4 bytes (one per matrix)\n_lt_/p_gt_\n\n_lt_p_gt_\n\t- WorldMatrix comes from the mesh and is comptued by babylonjs based on mesh position_co_ etc.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t-You cannot get the updated position as they are not stored by computed live by shaders\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tBut if you really want to get these values_co_ you can turn off shader computation for bones with mesh.computeBonesUsingShaders _eq_ false. In this case this code uses the CPU to compute bones_dd__lt_a href_eq__qt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Mesh/babylon.mesh.ts#L2617_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//github.com/BabylonJS/Babylon.js/blob/master/src/Mesh/babylon.mesh.ts#L2617_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]