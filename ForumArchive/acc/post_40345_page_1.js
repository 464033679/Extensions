[{"Owner":"Zephos","Date":"2018-09-30T05:47:35Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi all_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI have noticed that with animations_co_ etc_co_ it is often necessary to call a function that changes a mesh_t_s position_co_ get the new position_co_ then undo the change by assigning the old value_co_ and then animating between them. Now_co_ perhaps there are already ways to get the new value without actually changing the position before animating_co_ but I have had a hard time figuring out what methods those are. For example_co_ recently I wanted to animate the rotation of a TransformNode that was my camera_t_s parent. I used the lookAt() function and it worked fine_co_ but it rotates my mesh before the animation. Is there a similar function that just returns the new rotation value? Looking through the source code_co_ I couldn_t_t find one that was obvious_co_ but that may be because I am still getting the hang of the linear algebra stuff and don_t_t know what things are doing.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIf there isn_t_t something like this_co_ I am actually all set up with a clone of the repo (or my fork of it) and would love to add a getLookAtValue() function and do a PR. It would do the same thing as lookAt but without changing the mesh_t_s actual rotation and would just return the values instead. Thoughts?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tZephos\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2018-09-30T08:37:16Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi Z.  Likely_co_ the easiest way is to steal code from this PG_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#JEHHJ2_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#JEHHJ2_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI think it is doing what you wish... in a rather fancy way.  Lerps and slerps_co_ interpolations_co_ the _qt_meat and potatoes_qt_ behind BJS animations.  Line 60... a Quaternion Slerp... holy crap!  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_ I wonder who coded that PG.  A Quat-wrangler_co_ for sure.   Simply-stated (by a potential idiot - me)_co_ interpolations (lerps) are a calculation of steps-across-time... used heavily in animation systems.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tUnder certain circumstances_co_ BJS adds a property to mesh... called _lt_em_gt_.rotationQuaternion_lt_/em_gt_.  After it is added_co_ the old _lt_em_gt_.rotation_lt_/em_gt_ property is not used (much).  Babylon Animation system can animate Quaternions same as Euler vector3.  Some people/software LIKE working-with mesh orientation using Quaternions_co_ while others prefer working-with classic Eulers. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tYou are allowed/encouraged to add a mesh_lt_strong_gt_.rotationQuaternion_lt_/strong_gt_ _eq_ BABYLON.Quaternion.Identity()_sm_ ...at ANY time you wish (if a mesh.rotationQuaternion property does not already exist).  Line 28 in the above playground... does exactly that.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t---------- extra crap (Euler) -----------\n_lt_/p_gt_\n\n_lt_p_gt_\n\tMore-basic-speaking_co_ I think _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/25365-brianzinn/?do_eq_hovercard_qt_ data-mentionid_eq__qt_25365_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/25365-brianzinn/_qt_ rel_eq__qt__qt__gt_@brianzinn_lt_/a_gt_ once helped me with a similar issue_co_ but I can_t_t find the thread/playground right now.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tLet_t_s verify wishes_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tAt various times during live scene_co_ you want to rotationally-animate somemesh1... to _lt_strong_gt_look-at_lt_/strong_gt_ somemesh2.  You need to _qt_derive_qt_ an ENDING somemesh1.rotation value_co_ so you can build the animation on-the-fly.  Sound correct?  I hope so.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tHere_t_s what I THINK I remember. \n_lt_/p_gt_\n\n_lt_p_gt_\n\t1.  var dirToMesh2FromMesh1 _eq_ somemesh1.position.subtract(somemesh2.position)_sm__lt_br /_gt_\n\t     or maybe it_t_s...   var dirToMesh2FromMesh1 _eq_ _lt_strong_gt_somemesh2_lt_/strong_gt_.position.subtract(_lt_strong_gt_somemesh1_lt_/strong_gt_.position)_sm_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t1b.  Possibly do a _lt_u_gt_dirToMesh2FromMesh1.normalize()_lt_/u_gt_ here.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t2.  var endingRotForMesh1 _eq_ somemesh1.rotation.clone().multiply(dirToMesh2FromMesh1)_sm_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI THINK that might be the procedure_co_ but I could be completely wrong.  I_t_ve always had troubles with this stuff. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tProbably_co_ I should not have posted this extra crap.   I_t_m too unsure.   _lt_span_gt__lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_  _lt_/span_gt_ Let_t_s see if there are more/wiser comments.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"brianzinn","Date":"2018-09-30T16:22:18Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tIt_t_s not my PG_co_ but I think you want to slerp to the lookAt - like this?_lt_br /_gt_\n\t_lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#UMQ4UR%232_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#UMQ4UR#2_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tedit_dd_ actually_co_ sorry I didn_t_t read your question fully - just wingnuts response more.. oops!  How do you know if you are returning a quaternion or vector3 or do you translate to one?  this is more a question for _lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/?do_eq_hovercard_qt_ data-mentionid_eq__qt_4442_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/4442-deltakosh/_qt_ rel_eq__qt__qt__gt_@Deltakosh_lt_/a_gt_ if that would be good to have in the framework _lt_span_gt__lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/span_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Wingnut","Date":"2018-09-30T23:26:38Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThx BZ and hi!  Yeah_co_ I knew it wasn_t_t your playground. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tI think_co_ what IS yours_co_ BZ_co_ is that you once solved an issue of mine... by multiplying a vec3 _lt_u_gt_rotation_lt_/u_gt_... by a vec3 _lt_u_gt_direction_lt_/u_gt_.  But maybe it was someone else.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tTo me_co_ multiplying those two things... seems ridiculous.  But I think it worked for my issue.   I know very little about geometry and projections.  _lt_span_gt__lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span_gt_In my last post_co_ I showed how to derive a _qt_lookAt direction_qt_... by subtracting one mesh _lt_u_gt_position_lt_/u_gt_... from the other mesh _lt_u_gt_position_lt_/u_gt_.  (I learned that when practicing aiming spotlights at constantly orbiting/moving mesh.)_lt_u_gt_ _lt_/u_gt__lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span_gt_Anyway_co_ once Zephos has an ending .rotation needed to cause mesh1 to lookAt mesh2_co_ he can build/trigger his own animation (which is essentially a slerp_co_ right?)._lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span_gt_All in all_co_ I was trying to figure a way to allow Zephos to work COMPLETELY in Euler/Vector3... and avoid Quaternions for now.  *shrug*_lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span_gt_The more I talk_co_ the more I confuse people_co_ eh?  The fog of clarity.  heh.  Party on!_lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span_gt_Update_dd_  _lt_/span_gt__lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#HH1U5%2386_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#HH1U5#86_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tEarly tests on my direction * rotation _eq_ neededEndingRotationValue ...thoughts... terrible results.  _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt_ Fun_co_ though.  I get to use my handy spinTo() func_co_ again.  _lt_span_gt__lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/span_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_span_gt_Sometimes_co_ I think youngsters like me... should not drive top-fuel dragsters like BJS.  _lt_span_gt__lt_img alt_eq__qt__dd_o_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_ohmy.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/ohmy@2x.png 2x_qt_ title_eq__qt__dd_o_qt_ width_eq__qt_20_qt_ /_gt_  But BJS tastes good with hot dogs_co_ and goes well with Hogan_t_s Heroes reruns_co_ so it_t_s perfect Sunday night fun._lt_/span_gt__lt_/span_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2018-10-01T16:57:54Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tWell in this case_co_ you can just call Matrix.LookAt to get the new matrix and then decompose it_dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tPseudo-code (not tested)_dd_\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_var mat _eq_ Matrix.LookAtLH(position_co_ target_co_ BABYLON.Vector3.Up())_sm_\n\nvar translation_sm_\nvar rotationQuaternion_sm_\nvar scaling_sm_\n\nmat.decompose(scaling_co_ rotationQuaternion_co_ translation)_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JohnK","Date":"2018-10-02T17:09:25Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tYet another alternative using a dummy mesh to calculate the angle (give it a couple of seconds for the box to jump to a new position)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tcone lookAt _lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#E0KDHN_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#E0KDHN_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tcamera using a parent lookAt _lt_a href_eq__qt_https_dd_//www.babylonjs-playground.com/#E0KDHN%231_qt_ rel_eq__qt_external nofollow_qt__gt_https_dd_//www.babylonjs-playground.com/#E0KDHN#1_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]