[{"Owner":"AlbertTJames","Date":"2016-08-08T00:53:43Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHey everyone _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tI am building a game on top of the babylon engine and I keep all babylon objects inside the meta _qt_game object_qt_. I am having trouble with the scope of the variables when performing event related animations_co_ sometimes it works sometimes it does not... And I have not idea why. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tI was playing around with the sky material tutorial _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#E6OZX%236_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#E6OZX#6_lt_/a_gt__co_  that has some key binding to control the daylight.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_var setSkyConfig _eq_ function(property_co_ from_co_ to) {\n      var keys _eq_ [{\n        frame_dd_ 0_co_\n        value_dd_ from\n      }_co_ {\n        frame_dd_ 100_co_\n        value_dd_ to\n      }]_sm_\n\n      var animation _eq_ new BABYLON.Animation(_qt_animation_qt__co_ property_co_ 100_co_ BABYLON.Animation.ANIMATIONTYPE_FLOAT_co_ BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT)_sm_\n      animation.setKeys(keys)_sm_\n\n      scene.stopAnimation(skybox)_sm_\n      scene.beginDirectAnimation(skybox_co_ [animation]_co_ 0_co_ 100_co_ false_co_ 1)_sm_\n    }_sm_\n    \n    \n    window.addEventListener(_qt_keydown_qt__co_ function(evt) {\n      switch (evt.keyCode) {\n        case 49_dd_\n          setSkyConfig(_qt_material.inclination_qt__co_ skyboxMaterial.inclination_co_ 0)_sm_\n          break_sm_ // 1\n        case 50_dd_\n          setSkyConfig(_qt_material.inclination_qt__co_ skyboxMaterial.inclination_co_ -0.5)_sm_\n          break_sm_\n..._lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tSo that is working fine.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tBut now if I want to animate a sphere called lightSphere0 without creating a nested function (with direct reference inside it) like above_co_ animation only work if I put the code directly inside the switch_co_ like so.\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_case 50_dd_\n          setSkyConfig(_qt_material.inclination_qt__co_ skyboxMaterial.inclination_co_ -0.5)_sm_\n          var keys _eq_ [{\n            frame_dd_ 0_co_\n            value_dd_ lightSphere0.position.x\n          }_co_ {\n            frame_dd_ 100_co_\n            value_dd_ 30\n          }]_sm_\n\n          var animation _eq_ new BABYLON.Animation(_qt_animation_qt__co_ _qt_position.x_qt__co_ 100_co_ BABYLON.Animation.ANIMATIONTYPE_FLOAT_co_ BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT)_sm_\n          animation.setKeys(keys)_sm_\n\n          scene.stopAnimation(lightSphere0)_sm_\n          scene.beginDirectAnimation(lightSphere0_co_ [animation]_co_ 0_co_ 100_co_ false_co_ 1)_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tIf i try to call any function outside of this switch with the object as an argument_co_ or with its name_co_ or with the scene object etc.. the animation runs without changing the property of the object. For example those following functions are methods of the meta object (that i call with thisObject.animateFloat(sphere_co_ _qt_position.x_qt__co_ ... _co_ ....). So I get the OK_co_ in the console (I get in fact 4 of them_co_ not sure why)_co_ and everytime I have a correct reference to the object in the debugger. But the animation does not work...\n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_animateFloat(object_co_ property_co_ from_co_ to) {\n    var keys _eq_ [{\n      frame_dd_ 0_co_\n      value_dd_ from\n    }_co_ {\n      frame_dd_ 100_co_\n      value_dd_ to\n    }]_sm_\n\n    var animation _eq_ new BABYLON.Animation(_qt_animation_qt__co_ property_co_ 100_co_ BABYLON.Animation.ANIMATIONTYPE_FLOAT_co_ BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT)_sm_\n    animation.setKeys(keys)_sm_\n\n    this.currentSceneObject.stopAnimation(object)_sm_\n    // edit_co_ what was missing _dd_ object.animations.push(animation)_sm_\n    object._scene.beginAnimation(object_co_ 0_co_ 100_co_ false_co_ 1_co_ function() {\n      console.log(_qt_ok_qt_)\n    })_sm_\n    //this.currentSceneObject.beginDirectAnimation(object_co_ [animation]_co_ 0_co_ 100_co_ false_co_ 1)_sm_\n  }_sm_\n\n  animateVector3(objectName_co_ property_co_ from_co_ to) {\n    var keys _eq_ [{\n      frame_dd_ 0_co_\n      value_dd_ from\n    }_co_ {\n      frame_dd_ 100_co_\n      value_dd_ to\n    }]_sm_\n\n    var sphere _eq_ this.currentSceneObject.getMeshByName(objectName)_sm_\n    var animation _eq_ new BABYLON.Animation(_qt_animation_qt__co_ property_co_ 100_co_ BABYLON.Animation.ANIMATIONTYPE_VECTOR3_co_ BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT)_sm_\n    animation.setKeys(keys)_sm_\n\n    this.currentSceneObject.stopAnimation(sphere)_sm_\n    // edit_co_ what was missing _dd_ object.animations.push(animation)_sm_\n    this.currentSceneObject.beginAnimation(object_co_ 0_co_ 100_co_ false_co_ 1_co_ function() {\n      console.log(_qt_ok_qt_)\n    })_sm_\n    //this.currentSceneObject.beginDirectAnimation(object_co_ [animation]_co_ 0_co_ 100_co_ false_co_ 1)_sm_\n  }_sm__lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tOn the other hand if I create a function without animation_co_ and change the position manually_co_ it does work. For example if I change the code of the above function to _dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_pre_gt_\n_lt_code_gt_animateVector3(object_co_ property_co_ from_co_ to) {\n    object.position.x _eq_ 50_sm_\n}_lt_/code_gt__lt_/pre_gt_\n\n_lt_p_gt_\n\tthe object is moving...\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tSorry for the long post ! Do you have any clue as to what is going on ? Im lost...\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks !\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"AlbertTJames","Date":"2016-08-08T01:08:08Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tOk nevermind... I just forgot to push the animation in the animations array. sorry\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Deltakosh","Date":"2016-08-08T16:55:40Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tNo problem. This could be useful for others _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]