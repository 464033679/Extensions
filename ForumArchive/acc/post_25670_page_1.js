[{"Owner":"kevinImperial","Date":"2016-10-10T11:24:49Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHi everyone_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tA bit of a babylon philosophical question here. I want to deal with a massive amount of spheres_co_ and want to keep it as smooth as possible. I thought I would hide spheres which are no longer in the view frustum. Now that I got that code_co_ I wonder what is the most efficient_co_ either to hide the meshes by selecting and applying .visibility _eq_ 0_co_ or if it is better to dispose of the meshes ?\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIf you_t_re curious_co_ in my case I only rotate the camera and don_t_t move it_co_ and I know what I have to show thanks to the angles within a database. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tCurrently_co_ Babylon still feels a bit too slow to my taste with many elements hidden. Should I change my code to dispose of the meshes and recreate them instead of hiding/showing ?\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tBest_co_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tKevin\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-10-10T12:05:17Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tBJS manages the frustum for you and doesn_t_t render what isn_t_t visible. So you don_t_t really need to set the visibility manually.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tDisposing and recreating the meshes is not a good idea because this will massively trigger the garbage collector.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThe best approach would be imho _dd_\n_lt_/p_gt_\n\n_lt_p_gt_\n\t- to lower the number of sphere to the necessary amount for visibility_co_ it is to say to recycle your spheres _dd_ when no longer visible_co_ recycle it to another visible sphere. With dozens or hundreds of sphere only_co_ you can then simulate the presence of dozen of thousands\n_lt_/p_gt_\n\n_lt_p_gt_\n\t- to use instances or a solid particle system_co_ to reduce the number of draw calls\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIf you have a PG demo_co_ we could help you to tweak it to achieve your goal\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"fenomas","Date":"2016-10-10T12:55:55Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tDo the spheres rotate? If not_co_ and you never move the camera_co_ could you get away with just using sprites instead of spherical meshes?\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-10-10T13:02:24Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tfake master !\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"kevinImperial","Date":"2016-10-10T13:03:33Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tThanks guys_co_ this is good feedback and can be very useful. \n_lt_/p_gt_\n\n_lt_p_gt_\n\tMy code is a bit massive to turn into a demo unfortunately (connection to database_co_ etc).\n_lt_/p_gt_\n\n_lt_p_gt_\n\tCurrently I use clones of one sphere because I want to give different materials to different spheres_co_ and I understood that using instances would not allow me to give different materials.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tI like the idea of moving the spheres position_co_ but it still mean that at some point I need to set up a limited number of instances to draw...\n_lt_/p_gt_\n\n_lt_p_gt_\n\tFenomas_co_ currently the spheres do not rotate_co_ but they will in the future. (I intend to have the ones close to the camera rotate_co_ and the ones far either low quality spheres or sprites_co_ the issue might come from colour though).\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-10-10T13:12:44Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\tQuote\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tCurrently I use clones of one sphere because I want to give different materials to different spheres_co_ and I understood that using instances would not allow me to give different materials.\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tIf_co_ by different materials_co_ you mean different textures/images_co_ you could use the SPS. The SPS uses only one material but you can assign different sub-parts from a single image (texture) to different particles like you would do with a texture atlas.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//doc.babylonjs.com/overviews/Solid_Particle_System#uvs_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/overviews/Solid_Particle_System#uvs_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tClones are an easy way to duplicate meshes but they lead to as many draw calls as the number of clones. Instances or SPS only makes one draw call.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"kevinImperial","Date":"2016-10-10T13:16:44Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tAlright_co_ will have a read into this_co_ thanks a lot _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n_lt_p_gt_\n\tWill keep the idea of a limited number of spheres moving. While I_t_m not a big fan of a limited number of elements to display_co_ it might have to be used as a safety net. Out of the blue_co_ how many spheres do you believe Babylon can render at once ? And how many sprites ?\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-10-10T13:24:05Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tWell_co_ it mostly depends on your device\n_lt_/p_gt_\n\n_lt_p_gt_\n\tbut BJS can easily handle dozens of thousands sprites (maybe even hundred of thousands) like you can find it in many PG from this forum.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIf you use the SPS_co_ the number of vertices per sphere will be an important factor (_lt_em_gt_segments_lt_/em_gt_ parameter _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/tutorials/Mesh_CreateXXX_Methods_With_Options_Parameter#sphere_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/tutorials/Mesh_CreateXXX_Methods_With_Options_Parameter#sphere_lt_/a_gt_ )_co_ but you can easily animate (translation + rotation) from 8 to 10 000 boxes for instance on a decent computer.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"Pryme8","Date":"2016-10-10T13:34:50Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tJust create the sphere once_co_ and then set the main instance of it to disabled with \n_lt_/p_gt_\n\n_lt_p_gt_\n\tmesh.isEnabled(0)_sm_ and it will drop it out of all draw stacks.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t \n_lt_/p_gt_\n\n_lt_p_gt_\n\tnow when ever you need to make that sphere just do a originalMesh.clone() or copy depending on how unique you need it to be_co_ and that will make it so it_t_s all one draw call.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JohnK","Date":"2016-10-10T13:37:19Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tHere is an example l with about 195000 triangles each rotating. Of course with spheres you have a lot more vertices to deal with but it will give you some idea of the power of SPS.\n_lt_/p_gt_\n\n_lt_p_gt_\n\t_lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1LIVJD%233_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1LIVJD#3_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThank you Jerome for reminding me about link\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t\t\t\n\n_lt_span class_eq__t_ipsType_reset ipsType_medium ipsType_light_t_ data-excludequote_gt_\n\t_lt_strong_gt_Edited _lt_time datetime_eq__t_2016-10-10T14_dd_10_dd_47Z_t_ title_eq__t_10/10/2016 02_dd_10  PM_t_ data-short_eq__t_2 yr_t__gt_October 10_co_ 2016_lt_/time_gt_ by JohnK_lt_/strong_gt_\n\t\n\t\t_lt_br_gt_added link\n\t\n\t\n_lt_/span_gt_\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-10-10T14:05:06Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/14282-johnk/?do_eq_hovercard_qt_ data-mentionid_eq__qt_14282_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/14282-johnk/_qt_ rel_eq__qt__qt__gt_@JohnK_lt_/a_gt_ I think you forgot a link in your former post _sm_-)\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"kevinImperial","Date":"2016-10-10T18:14:48Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_blockquote class_eq__qt_ipsQuote_qt_ data-ipsquote_eq__qt__qt_ data-ipsquote-contentapp_eq__qt_forums_qt_ data-ipsquote-contentclass_eq__qt_forums_Topic_qt_ data-ipsquote-contentcommentid_eq__qt_146769_qt_ data-ipsquote-contentid_eq__qt_25670_qt_ data-ipsquote-contenttype_eq__qt_forums_qt_ data-ipsquote-timestamp_eq__qt_1476105164_qt_ data-ipsquote-userid_eq__qt_5453_qt_ data-ipsquote-username_eq__qt_jerome_qt__gt_\n\t_lt_div class_eq__qt_ipsQuote_citation_qt__gt_\n\t\t4 hours ago_co_ jerome said_dd_\n\t_lt_/div_gt_\n\n\t_lt_div class_eq__qt_ipsQuote_contents_qt__gt_\n\t\t_lt_p_gt_\n\t\t\tIf_co_ by different materials_co_ you mean different textures/images_co_ you could use the SPS. The SPS uses only one material but you can assign different sub-parts from a single image (texture) to different particles like you would do with a texture atlas.\n\t\t_lt_/p_gt_\n\n\t\t_lt_p_gt_\n\t\t\t_lt_a href_eq__qt_http_dd_//doc.babylonjs.com/overviews/Solid_Particle_System#uvs_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/overviews/Solid_Particle_System#uvs_lt_/a_gt_\n\t\t_lt_/p_gt_\n\n\t\t_lt_p_gt_\n\t\t\tClones are an easy way to duplicate meshes but they lead to as many draw calls as the number of clones. Instances or SPS only makes one draw call.\n\t\t_lt_/p_gt_\n\t_lt_/div_gt_\n_lt_/blockquote_gt_\n\n_lt_p_gt_\n\tI_t_m not sure if I understood properly_co_ but is there a way for me to use instances and give different colours to the different instances ? e.g_dd_ planets and according to their temperature change their colours.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tThanks everyone for the feedback _co_ it_t_s really helpful to be pushed in some directions I would have not thought of quickly on my own _lt_img alt_eq__qt__dd_)_qt_ data-emoticon_eq__qt__qt_ height_eq__qt_20_qt_ src_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/default_smile.png_qt_ srcset_eq__qt_http_dd_//www.html5gamedevs.com/uploads/emoticons/smile@2x.png 2x_qt_ title_eq__qt__dd_)_qt_ width_eq__qt_20_qt_ /_gt__lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-10-10T18:17:54Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tthe SPS allows to have different colors per solid particles (planets...)\n_lt_/p_gt_\n\n_lt_p_gt_\n\tyou_t_ll have to read the doc and look at the PG examples inside_dd_ _lt_a href_eq__qt_http_dd_//doc.babylonjs.com/overviews/Solid_Particle_System_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//doc.babylonjs.com/overviews/Solid_Particle_System_lt_/a_gt_\n_lt_/p_gt_\n\n_lt_p_gt_\n\texample with different colors and textures per particle _dd_ _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#WCDZS%238_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#WCDZS#8_lt_/a_gt_\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"kevinImperial","Date":"2016-10-10T18:21:01Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tAlright_co_ so it is not possible with instances ? I guess SPS works fine too_co_ I am just a bit afraid of functionalities that I would expect from a regular mesh that I would lose for some reason with the SPS. Such as clicking on a distinct mesh_co_ etc.\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"jerome","Date":"2016-10-10T18:23:04Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t\n_lt_p_gt_\n\tI_t_m not expert with instances_co_ so I can_t_t answer correctly.\n_lt_/p_gt_\n\n_lt_p_gt_\n\tIf you have a look at the SPS features_co_ you_t_ll see that there_t_s some support for particle picking.\n_lt_/p_gt_\n\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"kevinImperial","Date":"2016-10-10T18:25:27Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\tAlright_co_ sounds great ! I tried something like_dd_ scene.onPointerDown_co_ but it didn_t_t give me anything back with the particles. Will have a deeper look into the SPS features. Thanks a lot !\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"},{"Owner":"JohnK","Date":"2016-10-11T11:00:01Z","Content":"_lt_div class_eq__qt_mages_qt__gt_\n\t\t\t_lt_p_gt_\n\t_lt_a contenteditable_eq__qt_false_qt_ data-ipshover_eq__qt__qt_ data-ipshover-target_eq__qt_http_dd_//www.html5gamedevs.com/profile/23470-kevinimperial/?do_eq_hovercard_qt_ data-mentionid_eq__qt_23470_qt_ href_eq__qt_http_dd_//www.html5gamedevs.com/profile/23470-kevinimperial/_qt_ rel_eq__qt__qt__gt_@kevinImperial_lt_/a_gt_  if you click on a particle in this version _lt_a href_eq__qt_http_dd_//www.babylonjs-playground.com/#1LIVJD%234_qt_ rel_eq__qt_external nofollow_qt__gt_http_dd_//www.babylonjs-playground.com/#1LIVJD#4_lt_/a_gt_ and have a look in the console you will get the id and position of the particle.\n_lt_/p_gt_\n\n\t\t\t\n\t\t_lt_/div_gt_\n\n\t\t_lt_div class_eq__qt_ipsI_qt__gt__lt_/div_gt__lt_/div_gt_"}]