parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({1:[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,a){function o(t){try{h(i.next(t))}catch(t){a(t)}}function s(t){try{h(i.throw(t))}catch(t){a(t)}}function h(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(o,s)}h((i=i.apply(t,e||[])).next())})},e=this&&this.__generator||function(t,e){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function n(t,e){this._canvas=t.getRenderingCanvas(),this._delay=e.delay,this._duration=e.duration}return n.prototype.start=function(){var n=this;return new Promise(function(i,r){return t(n,void 0,void 0,function(){var n,r=this;return e(this,function(a){return this.init(),console.log("record canvas"),n=setInterval(function(){return t(r,void 0,void 0,function(){var t,n,i;return e(this,function(e){switch(e.label){case 0:return[4,this.getFrame()];case 1:return t=e.sent(),[4,this.flipAndRotate(new Uint8Array(t))];case 2:return n=e.sent(),i={job:"collectFrames",params:{frame:n}},this._worker.postMessage(i,[i.params.frame]),[2]}})})},this._delay),setTimeout(function(){clearInterval(n);var t={job:"createGIF",params:{width:r._resizeCanvas.width,height:r._resizeCanvas.height}};r._worker.postMessage(t),r._worker.onmessage=function(t){var e=t.data;console.log("complete",e),i(e)}},this._duration),[2]})})})},n.prototype.stop=function(){},n.prototype.cancel=function(){},n.prototype.download=function(n){var i=this;return void 0===n&&(n="canvasGIF.gif"),new Promise(function(r,a){return t(i,void 0,void 0,function(){var t,i,a;return e(this,function(e){switch(e.label){case 0:return[4,this.start()];case 1:return t=e.sent(),i=URL.createObjectURL(new Blob([new Uint8Array(t)],{type:"image/gif"})),a=document.getElementById("download"),document.body.appendChild(a),a.target="_blank",a.style.display="none",a.href=i,a.download=n,a.click(),a.remove(),this._worker.terminate(),r(),[2]}})})})},n.prototype.getFrame=function(){var n=this;return new Promise(function(i,r){return t(n,void 0,void 0,function(){var t,n;return e(this,function(e){return t=this._canvas.getContext("webgl2")||this._canvas.getContext("webgl"),n=new Uint8Array(this._width*this._height*4),t.readPixels(0,0,this._width,this._height,t.RGBA,t.UNSIGNED_BYTE,n),i(n.buffer),[2]})})})},n.prototype.init=function(){this._width=this._canvas.width,this._height=this._canvas.height,this._worker=new Worker("/gif.creator.service.1286141d.js"),this.canvasSetup()},n.prototype.canvasSetup=function(){this._holdingCanvas=document.createElement("canvas"),this._holdingCanvas2D=this._holdingCanvas.getContext("2d"),this._holdingCanvas.width=this._width,this._holdingCanvas.height=this._height,this._resizeCanvas=document.createElement("canvas"),this._resizeCanvas2D=this._resizeCanvas.getContext("2d")},n.prototype.flipAndRotate=function(t){var e=this;return new Promise(function(n,i){var r=e._holdingCanvas2D.createImageData(e._width,e._height);r.data.set(t),e._holdingCanvas2D.putImageData(r,0,0),e.resize(e._resizeCanvas),e.flip(e._resizeCanvas2D,e._holdingCanvas,e._resizeCanvas),n(e._resizeCanvas2D.getImageData(0,0,e._resizeCanvas.width,e._resizeCanvas.height).data.buffer)})},n.prototype.resize=function(t){var e=this;return new Promise(function(n,i){var r=e._width/e._height;r<1?(t.width=256*r,t.height=256):r>1?(t.width=256,t.height=256/r):(t.width=256,t.height=256),t.width=Math.max(t.width,1),t.height=Math.max(t.height,1),n()})},n.prototype.flip=function(t,e,n){var i=this;return new Promise(function(r,a){t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-n.height),t.drawImage(e,0,0,i._width,i._height,0,0,n.width,n.height),t.setTransform(1,0,0,1,0,0),t.globalCompositeOperation="source-over"})},n}();exports.GIFCreator=n;
},{"./gif.creator.service.ts":[["gif.creator.service.1286141d.js",5],"gif.creator.service.1286141d.map",5]}]},{},[1], null)
//# sourceMappingURL=/gif.exporter.single.worker.map